{"version":3,"file":"testing-node.mjs","sources":["../src/testing/types.ts","../src/delegation/jsonSerializers.ts","../src/diagnostics.ts","../src/UplcConsoleLogger.ts","../src/StellarTxnContext.ts","../src/colors.ts","../src/utils.ts","../src/testing/StellarNetworkEmulator.ts","../src/testing/StellarTestHelper.ts","../src/testing/CapoTestHelper.ts","../src/testing/DefaultCapoTestHelper.ts","../src/testing/index.ts"],"sourcesContent":["import type { NetworkParams } from \"@helios-lang/ledger\";\nimport type {\n    Capo,\n    StellarContract,\n    ConfigFor,\n    configBase,\n    SeedTxnScriptParams,\n    CapoFeatureFlags,\n    rootCapoConfig,\n    CapoConfig,\n} from \"@donecollectively/stellar-contracts\";\nimport type { StellarTestHelper } from \"./StellarTestHelper.js\";\nimport type { DefaultCapoTestHelper } from \"./DefaultCapoTestHelper.js\";\nimport {\n    SimpleWallet_stellar as emulatedWallet,\n    type NetworkSnapshot,\n} from \"./StellarNetworkEmulator.js\";\nimport type { StellarTestContext } from \"./StellarTestContext.js\";\n// import type {\n//     StellarTestContext,\n//     StellarTestHelper,\n//     DefaultCapoTestHelper,\n//     NetworkSnapshot,\n//     SimpleWallet_stellar as emulatedWallet,\n// } from \"@donecollectively/stellar-contracts/testing\";\n\n/**\n * @public\n */\nexport type enhancedNetworkParams = NetworkParams & {\n    slotToTimestamp(n: bigint): Date;\n};\n/**\n * @public\n */\nexport type stellarTestHelperSubclass<SC extends StellarContract<any>> = new (\n    stConfig: ConfigFor<SC> & canHaveRandomSeed,\n    helperState?: TestHelperState<SC>\n) => StellarTestHelper<SC>;\n\n// export type allCapoConfigDetails<SC extends Capo<any>> =\n// ConfigFor<SC> & rootCapoConfig & CapoFeatureFlags &\n//         SeedTxnScriptParams & {\n//             mph: MintingPolicyHash;\n//         };\n\n/**\n * @public\n */\nexport type DefaultCapoTestHelperClass<\n    SC extends Capo<any>,\n    SpecialState extends Record<string, any> = {}\n> = new (\n    config?: canHaveRandomSeed & SC extends Capo<any, infer FF>\n        ? ConfigFor<SC> & CapoConfig<FF>\n        : ConfigFor<SC>,\n    helperState?: TestHelperState<SC, SpecialState>\n) => // StellarTestHelper<SC> &\nDefaultCapoTestHelper<SC, SpecialState>;\n\n/**\n * @public\n */\nexport type canHaveRandomSeed = {\n    randomSeed?: number;\n};\n/**\n * @public\n */\nexport type canSkipSetup = {\n    skipSetup?: true;\n};\n\n/**\n * Establishes a state object for a test helper.  \n * @remarks\n * The second optional type parameter allows adding arbitrary fields to the state object,\n * suitable for state particular to your app testing needs.\n * @public\n */\nexport type TestHelperState<\n    SC extends StellarContract<any>, \n    Special extends Record<string, any> = {[key: string]: never}\n> = {\n    bootstrapped: Boolean;\n    bootstrappedStrella?: SC;\n    snapshots: Record<string, NetworkSnapshot>;\n    previousHelper: StellarTestHelper<any>;\n} & Special;\n\n/**\n * Adds a test helper class to a `vitest` testing context.\n * @remarks\n *\n * @param context -  a vitest context, typically created with StellarTestContext\n * @param TestHelperClass - typically created with DefaultCapoTestHelper\n * @param stConfig - preset configuration for the contract under test\n * @public\n **/\nexport async function addTestContext<\n    SC extends StellarContract<any>,\n    ST_CONFIG extends configBase & ConfigFor<SC> = ConfigFor<SC>,\n    SpecialState extends Record<string, any> = {[key: string]: never}\n>(\n    context: StellarTestContext<any, SC>,\n    TestHelperClass: SC extends Capo<any>\n        ? DefaultCapoTestHelperClass<SC, SpecialState>\n        : stellarTestHelperSubclass<SC>,\n    stConfig?: Partial<\n        SC extends Capo<any, infer FF> ? {featureFlags: FF} & ST_CONFIG : ST_CONFIG\n    >,\n    helperState?: TestHelperState<SC, SpecialState>\n) {\n    console.log(\" ======== ======== ======== +test context\");\n    Object.defineProperty(context, \"strella\", {\n        get: function () {\n            return this.h.strella;\n        },\n    });\n\n    //@ts-expect-error on matchiness of the SC type\n    context.initHelper = async (stConfig, helperState) => {\n        //@ts-expect-error on matchiness of helperState\n        const helper = new TestHelperClass(stConfig, helperState);\n        // await helper.setupPending;\n        if (context.h) {\n            //xx@ts-expect-error temporarily\n            if (!stConfig.skipSetup)\n                throw new Error(\n                    `re-initializing shouldn't be necessary without skipSetup`\n                );\n            console.log(\n                \"   ............. reinitializing test helper without setup\"\n            );\n        }\n        context.h = helper;\n        // console.log(\"context IS \", context)\n        return helper;\n    };\n    try {\n        //@ts-expect-error\n        await context.initHelper(stConfig, helperState);\n    } catch (e) {\n        if (!stConfig) {\n            // console.error(e.stack || e.message || JSON.stringify(e));\n            console.error(\n                `${TestHelperClass.name}: error during initialization; does this test helper require initialization with explicit params?`\n            );\n            throw e;\n        } else {\n            console.error(\"urgh\");\n            throw e;\n        }\n    }\n}\n\n/**\n * @public\n */\nexport type actorMap = Record<string, emulatedWallet>;\n\n/**\n * 1 million as bigint.  Multiply by this a `Bigint` ADA value to get lovelace\n * @public\n * @example\n *    const three = 3n * ADA\n *    const four = Bigint(4) * ADA\n **/\n/**\n * @public\n */\nexport const ADA = 1_000_000n; // lovelace\n\n/**\n * Recursively expand all types in a type\n * @public\n */\nexport type ExpandRecursively<T> = T extends object\n    ? T extends infer O\n        ? { [K in keyof O]: ExpandRecursively<O[K]> }\n        : never\n    : T;\n","import { bytesToHex } from \"@helios-lang/codec-utils\";\nimport { encodeBech32 } from \"@helios-lang/crypto\";\nimport { type Address, type AssetClass } from \"@helios-lang/ledger\";\nimport { type MintingPolicyHash } from \"@helios-lang/ledger\";\nimport { bytesToText } from \"../HeliosPromotedTypes.js\";\nimport {\n    txOutputIdAsString,\n    valueAsString,\n    assetsAsString,\n    policyIdAsString,\n    displayTokenName,\n} from \"../diagnostics.js\";\nimport type { ByteArrayData, IntData } from \"@helios-lang/uplc\";\nimport { checkValidUTF8 } from \"../utils.js\";\n\n/**\n * toJSON adapter for delegate links\n * @remarks\n * used for on-chain serialization of contract config details\n * @internal\n **/\nexport function delegateLinkSerializer(key: string, value: any) {\n    if (typeof value === \"bigint\") {\n        return value.toString();\n    } else if (\"bytes\" == key && Array.isArray(value)) {\n        return bytesToHex(value);\n    } else if (value?.kind == \"Address\") {\n        return value.toString();\n    } else if (\"tn\" == key && Array.isArray(value)) {\n        return bytesToText(value);\n    }\n    if (\"capo\" == key) return undefined;\n    if (\"uh\" == key) return '\"‚Äπutxo helper‚Ä∫\"';\n    if (\"capoBundle\" == key) return '\"‚Äπcapo bundle‚Ä∫\"';\n\n    return value; // return everything else unchanged\n}\n\n/**\n *  this is NOT a jsonifier, but it emits nice-looking info onscreen when used with JSON.stringify (in arg2)\n * @public\n */\nexport function uplcDataSerializer(key: string, value: any, depth = 0) {\n    const indent = \"    \".repeat(depth);\n    const outdent = \"    \".repeat(Math.max(0, depth - 1));\n\n    if (typeof value === \"bigint\") {\n        return `big‚Äπ${value.toString()}n‚Ä∫`;\n    } else if (\"bytes\" == key && Array.isArray(value)) {\n        // return `‚Äπbytes‚Äπ${value.length}‚Ä∫=${bytesToHex(value)}‚Ä∫`;\n        return abbreviatedDetailBytes(`bytes‚Äπ${value.length}‚Ä∫`, value, 40);\n    } else if (\"string\" == typeof value) {\n        return `'${value}'`; // JSON.stringify(value, null, 4);\n    } else if (value === null) {\n        return `‚Äπnull‚Ä∫`;\n    } else if (\"undefined\" == typeof value) {\n        return `‚Äπund‚Ä∫`;\n    } else if (value.kind == \"Address\") {\n        const a = value as Address;\n        const cbor = a.toCbor();\n        // const b = decodeAddress(cbor)\n        return (\n            `‚Äπ${abbrevAddress(value)}‚Ä∫ = ` +\n            abbreviatedDetailBytes(`cbor‚Äπ${cbor.length}‚Ä∫:`, cbor, 99)\n        );\n    } else if (value.kind == \"ValidatorHash\") {\n        return abbreviatedDetailBytes(\n            `script‚Äπ${value.bytes.length}‚Ä∫`,\n            value.bytes\n        );\n    } else if (value.kind == \"MintingPolicyHash\") {\n        const v: MintingPolicyHash = value;\n        return `mph‚Äπ${policyIdAsString(v)}‚Ä∫`;\n        // .toHex())}‚Ä∫`;\n    } else if (value.kind == \"TxOutputId\") {\n        return `‚Äπtxoid:${txOutputIdAsString(value, 8)}‚Ä∫`;\n    }\n    if (value.rawData) {\n        return uplcDataSerializer(key, value.rawData, Math.max(depth, 3));\n    }\n    if (value.kind == \"int\") {\n        const v: IntData = value;\n        return `IntData‚Äπ${v.value}‚Ä∫`;\n    }\n    if (value.kind == \"bytes\") {\n        const v = value as ByteArrayData;\n        return abbreviatedDetailBytes(\n            `ByteArray‚Äπ${v.bytes.length}‚Ä∫`,\n            v.bytes,\n            40\n        );\n    }\n    if (value.kind == \"Value\") {\n        return valueAsString(value);\n    }\n    if (value.kind == \"Assets\") {\n        return `assets:‚Äπ${assetsAsString(value)}‚Ä∫`;\n    }\n    if (value.kind == \"AssetClass\") {\n        const ac = value as AssetClass;\n        return `assetClass:‚Äπ${policyIdAsString(ac.mph)} ${displayTokenName(\n            ac.tokenName\n        )}}‚Ä∫`;\n    }\n    if (value.kind)\n        console.log(\"info: no special handling for KIND = \", value.kind);\n\n    if (\"tn\" == key && Array.isArray(value)) {\n        return bytesToText(value);\n    } else if (\"number\" == typeof value) {\n        return value.toString();\n    } else if (value instanceof Map) {\n        return `map‚Äπ${value.size}‚Ä∫: { ${uplcDataSerializer(\n            \"\",\n            Object.fromEntries(value.entries()),\n            Math.max(depth, 3)\n        )}    }`;\n    } else if (Array.isArray(value) && value.length == 0) {\n        return \"[]\";\n    } else if (\n        Array.isArray(value) &&\n        value.every((v) => typeof v === \"number\")\n    ) {\n        return `${abbreviatedDetailBytes(`bytes‚Äπ${value.length}‚Ä∫`, value, 40)}`;\n        // } else if (value.toString) {\n        //     return value.toString();\n    } else if (Array.isArray(value)) {\n        const inner = value.map((v) =>\n            uplcDataSerializer(\"\", v, Math.max(depth + 1, 3))\n        );\n        let extraNewLine = \"\";\n        let usesOutdent = \"\";\n        const multiLine = inner\n            .map((s) => {\n                const hasNewline = s.trim().includes(\"\\n\");\n                if (s.length > 40) {\n                    extraNewLine = \"\\n\";\n                    usesOutdent = outdent;\n                    return `${indent}${s}`;\n                } else {\n                    // console.log(\"length, hasNewline = \", s.length, hasNewline)\n                }\n                return s;\n            })\n            .join(`, ${extraNewLine}`);\n        // console.log(\"array uses newline/outdent\", {extraNewLine, usesOutdent});\n\n        return `[ ${extraNewLine}${multiLine}${extraNewLine}${usesOutdent} ]`;\n    }\n\n    if (!value) {\n        return JSON.stringify(value);\n    }\n    const keys = Object.keys(value);\n    if (keys.length == 0) {\n        return key ? \"\" : \"{}\";\n    }\n    if (keys.length == 1) {\n        const singleKey = keys[0];\n        const thisValue = value[singleKey];\n        let inner = uplcDataSerializer(\"\", thisValue, Math.max(depth, 3)) || \"\";\n        if (Array.isArray(thisValue)) {\n            if (!inner.length) {\n                inner = \"[ ‚Äπempty list‚Ä∫ ]\";\n            }\n        } else {\n            if (inner.length) inner = `{ ${inner} }`;\n        }\n        let s = `${singleKey}: ${inner}`;\n        // if (key) return `**1k** ${key}: ${s}`\n        return s;\n    }\n    let extraNewLine = \"\";\n    let usesOutdent = \"\";\n    let s = keys.map(\n        (k) =>\n            `${indent}${k}: ${\n                uplcDataSerializer(k, value[k], Math.max(depth + 1, 2))\n                //    JSON.stringify(value[k], datumSerializer, 4)\n                // }`).join(`,\\nz${indent}`);\n            }`\n    );\n    const multiLineItems = s.map((s) => {\n        if (s.length < 40 && !s.includes(\"\\n\")) {\n            return `${s}`;\n        } else {\n            extraNewLine = \"\\n\";\n            usesOutdent = outdent;\n            return `${s}`;\n        }\n        return s;\n    });\n    const multiLine = multiLineItems.join(`, ${extraNewLine}`);\n    s = `${multiLine}${extraNewLine}${usesOutdent}`;\n\n    if (key) return `{${extraNewLine}${s}}`;\n    return `\\n${s}`;\n}\n/**\n * short version of address for compact display\n * @public\n */\nexport function abbrevAddress(address: Address) {\n    return abbreviatedDetail(address.toString(), 12, false);\n}\n\n/**\n * short representation of bytes for compact display\n * @public\n */\nexport function abbreviatedDetailBytes(\n    prefix: string,\n    value: number[],\n    initLength = 8\n) {\n    const hext = bytesToHex(value);\n    const Len = value.length;\n    const text = checkValidUTF8(value)\n        ? ` ‚Äπ\"${abbreviatedDetail(bytesToText(value), initLength)}\"‚Ä∫`\n        : ``;\n\n    if (value.length <= initLength) return `${prefix}${hext}${text}`;\n    const checksumString = encodeBech32(\"_\", value).slice(-4);\n    return `${prefix}${hext.slice(0, initLength)}‚Ä¶ ‚Äπ${checksumString}‚Ä∫${text}`;\n}\n\n/**\n * short version of hex string for compact display\n * @internal\n */\nexport function abbreviatedDetail(\n    hext: string,\n    initLength = 8,\n    countOmitted: boolean = false\n) {\n    const p = typeof process == \"undefined\" ? {\n        env: {} as Record<string, string>\n    } : process;\n    if (p?.env?.EXPAND_DETAIL) {\n        return hext;\n    } else {\n        if (hext.length <= initLength) return hext;\n        const omittedCount = countOmitted ? hext.length - initLength - 4 : 0;\n        let omittedString = countOmitted ? `‚Äπ‚Ä¶${omittedCount}‚Ä¶‚Ä∫` : \"‚Ä¶\";\n        if (countOmitted && omittedCount < omittedString.length) {\n            omittedString = hext.slice(initLength, -4);\n        }\n        return `${hext.slice(0, initLength)}${omittedString}${hext.slice(-4)}`;\n    }\n}\n","import type { ErrorMap } from \"./delegation/RolesAndDelegates.js\";\nimport { StellarTxnContext } from \"./StellarTxnContext.js\";\nimport {\n    makeByteArrayData,\n    type ByteArrayData,\n    type UplcProgramV2,\n} from \"@helios-lang/uplc\";\nimport {\n    uplcDataSerializer,\n    abbreviatedDetail,\n    abbreviatedDetailBytes,\n} from \"./delegation/jsonSerializers.js\";\nimport {\n    type Value,\n    type Address,\n    type Tx,\n    type TxId,\n    type TxInput,\n    type TxOutput,\n    type TxOutputId,\n    type NetworkParams,\n    type Assets,\n    type MintingPolicyHash,\n    type TxRedeemer,\n    type TxOutputDatum,\n    makeAddress,\n    makeNetworkParamsHelper,\n} from \"@helios-lang/ledger\";\nimport { bytesToHex } from \"@helios-lang/codec-utils\";\nimport {\n    bytesToText,\n    textToBytes,\n    type InlineDatum,\n} from \"./HeliosPromotedTypes.js\";\nimport type { UtxoDisplayCache } from \"./StellarContract.js\";\nimport { isLibraryMatchedTcx } from \"./utils.js\";\n\n/**\n * converts a hex string to a printable alternative, with no assumptions about the underlying data\n * @remarks\n *\n * Unlike Helios' bytesToText, hexToPrintable() simply changes printable characters to characters,\n * and represents non-printable characters in '‚ÄπXX‚Ä∫' format.\n * @param hexStr - hex input\n * @public\n **/\nexport function hexToPrintableString(hexStr: string) {\n    let result = \"\";\n    for (let i = 0; i < hexStr.length; i += 2) {\n        let hexChar = hexStr.substring(i, i + 2);\n        let charCode = parseInt(hexChar, 16);\n\n        // ASCII printable characters are in the range 32 (space) to 126 (~)\n        if (charCode >= 32 && charCode <= 126) {\n            result += String.fromCharCode(charCode);\n        } else {\n            result += `‚Äπ${hexChar}‚Ä∫`;\n        }\n\n        // todo decode utf8 parts using bytesToText(...substring...)\n        // int         required_len;\n        // if (key[0] >> 7 == 0)\n        //     required_len = 1;\n        // else if (key[0] >> 5 == 0x6)\n        //     required_len = 2;\n        // else if (key[0] >> 4 == 0xE)\n        //     required_len = 3;\n        // else if (key[0] >> 5 == 0x1E)\n        //     required_len = 4;\n        // else\n        //     return (0);\n        // return (strlen(key) == required_len && chars_are_folow_uni(key + 1));\n    }\n    return result;\n}\n\n/**\n * Displays a token name in a human-readable form\n * @remarks\n * Recognizes CIP-68 token names and displays them in a special format.\n * @param nameBytesOrString - the token name, as a string or byte array\n * @public\n */\nexport function displayTokenName(nameBytesOrString: string | number[]) {\n    // check if it is a cip-68 token name by inspecting the first 4 bytes.  If they don't match the cip-68 pattern, display using stringToPrintableString.\n    // if it has a cip-68 tag in the first 4 bytes, show the cip-68 tag as `‚Äπcip68/{tag}‚Ä∫` and append the rest of the token name as a string.\n    // inspect the first 4 bytes by:\n    //  - converting them to hex\n    //  - checking if the first and last nibbles are 0's (if not, then it is not a cip-68 token name)\n    //  - removing the first and last nibbles, shifting the hex string to the left by 1 nibble to get a 2-byte tag and 1 byte of checksum\n    //  - separating the cip-68 tag from the checksum\n    //  - parsing the cip-68 tag as a number (parseInt(numHex, 16))\n\n    let nameString = \"\";\n    let cip68Tag = \"\";\n    let cip68TagHex = \"\";\n    let checksum = \"\";\n    let tagBytes = \"\";\n    let nameBytesHex = \"\";\n    let nameBytesString = \"\";\n    let isCip68 = false;\n    if (typeof nameBytesOrString === \"string\") {\n        // convert the bytes of the string to hex\n        // function(byte) {\n        //     return ('0' + (byte & 0xFF).toString(16)).slice(-2);\n        //   }).join('');\n        nameBytesHex = textToBytes(nameBytesOrString)\n            .map((byte) => ('0' + (byte & 0xFF).toString(16)).slice(-2))\n            .join('');\n        nameString = nameBytesOrString;\n    } else {\n        nameBytesHex = nameBytesOrString\n            .map((byte) => ('0' + (byte & 0xFF).toString(16)).slice(-2))\n            .join('');\n        nameString = stringToPrintableString(nameBytesOrString);\n    }\n    // check if the first 4 bytes are a cip-68 token name\n    if (nameBytesHex.length >= 8) {\n        // check if the first and last nibbles are 0's\n        if (\n            nameBytesHex.substring(0, 1) === \"0\" &&\n            nameBytesHex.substring(7, 8) === \"0\"\n        ) {\n            // remove the first and last nibbles\n            cip68TagHex = nameBytesHex.substring(1, 5);\n            checksum = nameBytesHex.substring(5, 7);\n\n            // separate the cip-68 tag from the checksum\n            cip68Tag = parseInt(cip68TagHex, 16).toString();\n            nameString = stringToPrintableString(nameBytesOrString.slice(4));\n\n            // TODO: check the crc-8 checksum of the tag\n            isCip68 = true;\n        }\n    }\n    if (isCip68) {\n        nameString = `‚Äπcip68/${cip68Tag}‚Ä∫${nameString}`;\n    } else {\n        nameString = stringToPrintableString(nameBytesOrString);\n    }\n    return nameString;\n}\n\n/**\n * Presents a string in printable form, even if it contains non-printable characters\n *\n * @remarks\n * Non-printable characters are shown in '‚ÄπXX‚Ä∫' format.\n * @public\n */\nexport function stringToPrintableString(str: string | number[]) {\n    if (\"string\" != typeof str) {\n        // use a TextEncoder to identify if it is a utf8 string\n        try {\n            return new TextDecoder(\"utf-8\", { fatal: true }).decode(\n                new Uint8Array(str as number[])\n            );\n        } catch (e) {\n            // if it is not a utf8 string, fall back to printing what's printable and showing hex for other bytes\n            str = Buffer.from(str as number[]).toString(\"hex\");\n        }\n    }\n    let result = \"\";\n    for (let i = 0; i < str.length; i++) {\n        let charCode = str.charCodeAt(i);\n\n        // ASCII printable characters are in the range 32 (space) to 126 (~)\n        if (charCode >= 32 && charCode <= 126) {\n            result += str[i];\n        } else {\n            result += `‚Äπ${charCode.toString(16)}‚Ä∫`;\n        }\n    }\n    return result;\n}\n\n/**\n * Converts an array of [ policyId, ‚Äπtokens‚Ä∫ ] tuples for on-screen presentation\n * @remarks\n *\n * Presents policy-ids with shortened identifiers, and shows a readable & printable\n * representation of token names even if they're not UTF-8 encoded.\n * @public\n **/\nexport function assetsAsString(\n    a: Assets,\n    joiner = \"\\n    \",\n    showNegativeAsBurn?: \"withBURN\",\n    mintRedeemers?: Record<number, string>\n) {\n    const assets = a.assets;\n    return (\n        assets?.map(([policyId, tokenEntries], index) => {\n            let redeemerInfo = mintRedeemers?.[index] || \"\";\n            if (redeemerInfo) {\n                redeemerInfo = `\\n        r = ${redeemerInfo} `;\n            }\n            const tokenString = tokenEntries\n                .map(([nameBytes, count]: [number[], bigint]) => {\n                    // const nameString =  hexToPrintableString(nameBytes.hex);\n                    const nameString = displayTokenName(nameBytes);\n\n                    const negWarning =\n                        count < 1n\n                            ? showNegativeAsBurn\n                                ? \"üî• \"\n                                : \" ‚ö†Ô∏è NEGATIVE‚ö†Ô∏è\"\n                            : \"\";\n                    const burned =\n                        count < 1\n                            ? showNegativeAsBurn\n                                ? \"- BURN üî• \"\n                                : \"\"\n                            : \"\";\n                    return `${negWarning} ${count}√óüí¥ ${nameString} ${burned}`;\n                })\n                .join(\"+\");\n            return `‚¶ë${policyIdAsString(\n                policyId\n            )} ${tokenString} ${redeemerInfo}‚¶í`;\n        }) || []\n    ).join(joiner);\n}\n\n/**\n * Converts a MintingPolicyHash to a printable form\n * @public\n **/\nexport function policyIdAsString(p: MintingPolicyHash) {\n    const pIdHex = p.toHex();\n    const abbrev = abbreviatedDetail(pIdHex);\n    return `üè¶ ${abbrev}`;\n}\n\n/**\n * Converts lovelace to approximate ADA, in consumable 3-decimal form\n * @public\n **/\nexport function lovelaceToAdaOld(l: bigint | number) {\n    const asNum = parseInt(l.toString());\n    const ada =\n        (asNum && `${(Math.round(asNum / 1000) / 1000).toFixed(3)} ADA`) || \"\";\n    return ada;\n}\n\n/**\n * Converts lovelace to approximate ADA, in consumable 3-decimal form\n * @public\n */\nexport function lovelaceToAda(lovelace: bigint | number): string {\n    const asNum = parseInt(lovelace.toString());\n    // input: 6004000 should output 6_004.000\n    // input: 700396001000 should output 700_396.001\n    // input: 400202 should output 0.400_202\n    const whole = Math.floor(asNum / 1_000_000).toFixed(0);\n    let fraction = (asNum % 1_000_000).toFixed(0); // \"\"\n    fraction = fraction.padStart(6, \"0\");\n    const wholeWithSeparators = whole.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \"_\");\n    let fractionWithSeparators = fraction\n        .replace(/(\\d{3})(?=\\d)/g, \"$1_\")\n        .replace(/^-/, \"\"); // remove leading - if any\n    return `${wholeWithSeparators}.${fractionWithSeparators} ADA`;\n}\n\n/**\n * Converts a bigint or number to a string with commas as thousands separators\n * @public\n */\nexport function intWithGrouping(i : bigint | number) {\n    const whole = Math.floor(Number(i)).toFixed(0);\n    const fraction = Math.abs(Number(i) - Math.floor(Number(i))).toFixed(0);\n    const wholeWithSeparators = whole.replace(/\\B(?=(\\d{3})+(?!\\d))/g, \"_\");\n    const fractionWithSeparators = fraction\n        .replace(/(\\d{3})(?=\\d)/g, \"$1_\")\n    return `${wholeWithSeparators}.${fractionWithSeparators}`;\n}\n/**\n * Converts a Value to printable form\n * @public\n **/\nexport function valueAsString(v: Value) {\n    const ada = lovelaceToAda(v.lovelace);\n    const assets = assetsAsString(v.assets);\n    return [ada, assets].filter((x) => !!x).join(\" + \");\n}\n\n/**\n * Converts a Tx to printable form\n * @public\n **/\nexport function txAsString(tx: Tx, networkParams?: NetworkParams): string {\n    const outputOrder = [\n        [\"body\", \"inputs\"],\n        [\"body\", \"minted\"],\n        [\"body\", \"outputs\"],\n        [\"body\", \"refInputs\"],\n        [\"witnesses\", \"redeemers\"],\n        [\"body\", \"signers\"],\n        [\"witnesses\", \"v2refScripts\"],\n        [\"witnesses\", \"v2scripts\"],\n        [\"witnesses\", \"nativeScripts\"],\n        [\"body\", \"collateral\"],\n        [\"body\", \"collateralReturn\"],\n        [\"body\", \"scriptDataHash\"],\n        [\"body\", \"metadataHash\"],\n        [\"witnesses\", \"signatures\"],\n        [\"witnesses\", \"datums\"],\n        [\"body\", \"lastValidSlot\"],\n        [\"body\", \"firstValidSlot\"],\n        [\"body\", \"fee\"],\n    ];\n\n    let details = \"\";\n    if (!networkParams) {\n        console.warn(\n            new Error(`dumpAny: no networkParams; can't show txn size info!?!`)\n        );\n    }\n\n    const networkParamsHelper = networkParams\n        ? makeNetworkParamsHelper(networkParams)\n        : undefined;\n\n    // const d = tx.dump();\n    const seenRedeemers = new Set();\n\n    const allRedeemers = tx.witnesses.redeemers as any;\n    let hasIndeterminate = false;\n    const inputRedeemers: Record<\n        string | number,\n        { r?: TxRedeemer; display: string }\n    > = Object.fromEntries(\n        allRedeemers\n            .map((x: TxRedeemer, index: number) => {\n                // debugger;\n                if (x.kind != \"TxSpendingRedeemer\") return undefined;\n                // if (!(\"inputIndex\" in x)) return undefined;\n                const { inputIndex } = x;\n                const isIndeterminate = inputIndex == -1;\n                if (isIndeterminate) hasIndeterminate = true;\n                const inpIndex = isIndeterminate ? `‚Äπunk${index}‚Ä∫` : inputIndex;\n                if (!x.data) debugger;\n                const showData = x.data.rawData\n                    ? uplcDataSerializer(\"\", x.data.rawData)\n                    : x.data?.toString() || \"‚Äπno data‚Ä∫\";\n                return [inpIndex, { r: x, display: showData }];\n            })\n            .filter((x) => !!x)\n    );\n    if (hasIndeterminate)\n        inputRedeemers[\"hasIndeterminate\"] = {\n            r: undefined,\n            display: \"‚Äπunk‚Ä∫\",\n        };\n\n    const mintRedeemers = Object.fromEntries(\n        allRedeemers\n            .map((x) => {\n                if (\"TxMintingRedeemer\" != x.kind) return undefined;\n                if (\"number\" != typeof x.policyIndex) {\n                    debugger;\n                    throw new Error(`non-mint redeemer here not yet supported`);\n                }\n                if (!x.data) debugger;\n\n                const showData =\n                    (x.data.rawData\n                        ? uplcDataSerializer(\"\", x.data.rawData)\n                        : x.data?.toString() || \"‚Äπno data‚Ä∫\") +\n                    \"\\n\" +\n                    bytesToHex(x.data.toCbor());\n\n                return [x.policyIndex, showData];\n            })\n            .filter((x) => !!x)\n    );\n\n    //!!! todo: improve interface of tx so useful things have a non-private api\n    //!!! todo: get back to type-safety in this diagnostic suite\n    for (const [where, x] of outputOrder) {\n        let item = tx[where][x];\n        let skipLabel = false;\n        if (Array.isArray(item) && !item.length) continue;\n\n        if (!item) continue;\n        if (\"inputs\" == x) {\n            item = `\\n  ${item\n                .map((x: TxInput, i) => {\n                    const { r, display } =\n                        inputRedeemers[i] ||\n                        inputRedeemers[\"hasIndeterminate\"] ||\n                        {};\n                    if (!display && x.datum?.data) debugger;\n                    tx;\n                    if (r) seenRedeemers.add(r);\n                    return txInputAsString(\n                        x,\n                        /* unicode blue arrow right -> */ \"‚û°Ô∏è  \" + `@${1 + i} `,\n                        i,\n                        display // || \"‚Äπfailed to find redeemer info‚Ä∫\"\n                    );\n                })\n                .join(\"\\n  \")}`;\n        }\n        if (\"refInputs\" == x) {\n            item = `\\n  ${item\n                .map((x) => txInputAsString(x, \"‚ÑπÔ∏è  \"))\n                .join(\"\\n  \")}`;\n        }\n        if (\"collateral\" == x) {\n            //!!! todo: group collateral with inputs and reflect it being spent either way,\n            //     IFF it is also a tx `input`\n            //!!! todo: move collateral to bottom with collateralReturn,\n            //     IFF it is not part of the tx `inputs`\n            item = item.map((x) => txInputAsString(x, \"üî™\")).join(\"\\n    \");\n        }\n        if (\"minted\" == x) {\n            if (!item.assets.length) {\n                continue;\n            }\n            item = `\\n   ‚ùáÔ∏è  ${assetsAsString(\n                item,\n                \"\\n   ‚ùáÔ∏è  \",\n                \"withBURN\",\n                mintRedeemers\n            )}`;\n        }\n        if (\"outputs\" == x) {\n            item = `\\n  ${item\n                .map((x, i) =>\n                    txOutputAsString(\n                        x,\n                        \"üîπ\" /* <-- unicode blue bullet */ + `${i} <-`\n                    )\n                )\n                .join(\"\\n  \")}`;\n        }\n        if (\"firstValidSlot\" == x || \"lastValidSlot\" == x) {\n            if (networkParamsHelper) {\n                const slotTime = new Date(networkParamsHelper.slotToTime(item));\n                const timeDiff = (slotTime.getTime() - Date.now()) / 1000;\n                // format timeDiff with explicit plus or minus sign:\n                const sign = timeDiff > 0 ? \"+\" : \"-\";\n                const timeDiffString =\n                    sign + Math.abs(timeDiff).toFixed(1) + \"s\";\n\n                item = `${item} ${slotTime.toLocaleDateString()} ${slotTime.toLocaleTimeString()} (now ${timeDiffString})`;\n            }\n        }\n\n        if (\"signers\" == x) {\n            item = item.map((x) => {\n                const hex = x.toHex();\n                return `üîë#${hex.slice(0, 6)}‚Ä¶${hex.slice(-4)}`;\n            });\n        }\n\n        if (\"fee\" == x) {\n            item = lovelaceToAda(item);\n\n            // tx.profileReport.split(\"\\n\")[0];\n            // todo: find profile info and restore it here\n        }\n\n        if (\"collateralReturn\" == x) {\n            skipLabel = true;\n            item = `  ${txOutputAsString(\n                item,\n                `0  <- ‚ùì`\n            )} conditional: collateral change (returned in case of txn failure)`;\n        }\n        if (\"scriptDataHash\" == x) {\n            item = bytesToHex(item);\n        }\n\n        if (\"datums\" == x && !Object.entries(item || {}).length) continue;\n        if (\"signatures\" == x) {\n            if (!item) continue;\n            item = item.map((s) => {\n                const addr = makeAddress(true, s.pubKeyHash);\n                const hashHex = s.pubKeyHash.toHex();\n                return `üñäÔ∏è ${addrAsString(addr)} = üîë‚Ä¶${hashHex.slice(-4)}`;\n            });\n            if (item.length > 1) item.unshift(\"\");\n            item = item.join(\"\\n    \");\n        }\n        if (\"redeemers\" == x) {\n            if (!item) continue;\n\n            //!!! todo: augment with mph when that's available from the Activity.\n            item = item.map((x) => {\n                // console.log(\"redeemer keys\", ...[ ...Object.keys(x2) ], x2.dump());\n                // const isIndeterminate = x.inputIndex == -1;\n                // if (isIndeterminate) indeterminateRedeemerDetails = true;\n                // debugger\n                // const indexInfo = isIndeterminate\n                //     ? `spend txin #‚Äπtbd‚Ä∫`\n                // if (x.kind == \"TxSpendingRedeemer\") {\n                //     debugger\n                // }\n                const indexInfo =\n                    x.kind == \"TxMintingRedeemer\"\n                        ? `minting policy ${x.policyIndex}`\n                        : `spend txin ‚û°Ô∏è  @${1 + x.inputIndex}`;\n\n                const showData = seenRedeemers.has(x)\n                    ? \"(see above)\"\n                    : x.data.fromData\n                    ? uplcDataSerializer(\"\", x.data.fromData)\n                    : x.data.toString();\n                return `üèß  ${indexInfo} ${showData}`;\n            });\n            if (item.length > 1) item.unshift(\"\");\n            item = item.join(\"\\n    \");\n        }\n        if (\"v2Scripts\" == x) {\n            if (!item) continue;\n            item = item.map((s) => {\n                try {\n                    const mph = s.mintingPolicyHash.toHex();\n                    // debugger\n                    return `üè¶ ${mph.slice(0, 8)}‚Ä¶${mph.slice(-4)} (minting): ${\n                        s.serializeBytes().length\n                    } bytes`;\n                } catch (e) {\n                    const vh = s.validatorHash;\n\n                    const vhh = vh.toHex();\n                    const addr = makeAddress(true, vh);\n                    // debugger\n                    return `üìú ${vhh.slice(0, 8)}‚Ä¶${vhh.slice(\n                        -4\n                    )} (validator at ${addrAsString(addr)}): ${\n                        s.serializeBytes().length\n                    } bytes`;\n                }\n            });\n            if (item.length > 1) item.unshift(\"\");\n            item = item.join(\"\\n    \");\n        }\n        if (\"v2RefScripts\" == x) {\n            item = `${item.length} - see refInputs`;\n            // todo: @helios give us refScripts outside of dump(), which only shows us hex.\n        }\n\n        if (!item) continue;\n        details += `${skipLabel ? \"\" : \"  \" + x + \": \"}${item}\\n`;\n    }\n    try {\n        details += `  txId: ${tx.id().toHex()}`;\n        if (networkParams) details += `  \\n\\nsize: ${tx.toCbor().length} bytes`;\n    } catch (e) {\n        details = details + `(Tx not yet finalized!)`;\n        if (networkParams) details += `\\n  - NOTE: can't determine txn size\\n`;\n    }\n    return details;\n}\n\n/**\n * Converts a TxInput to printable form\n * @remarks\n *\n * Shortens address and output-id for visual simplicity; doesn't include datum info\n * @public\n **/\nexport function txInputAsString(\n    x: TxInput,\n    prefix = \"-> \",\n    index?: number,\n    redeemer?: string\n): string {\n    const { output: oo } = x;\n    const redeemerInfo = redeemer ? `\\n    r = ${redeemer}` : \" ‚Äπno redeemer‚Ä∫\";\n    const datumInfo =\n        oo.datum?.kind == \"InlineTxOutputDatum\" ? datumSummary(oo.datum) : \"\";\n\n    return `${prefix}${addrAsString(x.address)}${showRefScript(\n        oo.refScript as any\n    )} ${valueAsString(x.value)} ${datumInfo} = üìñ ${txOutputIdAsString(\n        x.id\n    )}${redeemerInfo}`;\n}\n\n/**\n * Converts a list of UTxOs to printable form\n * @remarks\n *\n * ... using {@link utxoAsString}\n * @public\n **/\nexport function utxosAsString(\n    utxos: TxInput[],\n    joiner = \"\\n\",\n    utxoDCache?: UtxoDisplayCache\n): string {\n    return utxos.map((u) => utxoAsString(u, \" üíµ\", utxoDCache)).join(joiner);\n}\n/**\n * Converts a TxOutputId to printable form\n * @public\n */\nexport function txOutputIdAsString(x: TxOutputId, length = 8): string {\n    return (\n        txidAsString(x.txId, length) +\n        \"üîπ\" /* <-- unicode blue bullet */ +\n        `#${x.index}`\n    );\n}\n\n/**\n * Converts a TxId to printable form\n * @remarks\n *\n * ... showing only the first 6 and last 4 characters of the hex\n * @public\n **/\nexport function txidAsString(x: TxId, length = 8): string {\n    const tid = x.toHex();\n    return `${tid.slice(0, length)}‚Ä¶${tid.slice(-4)}`;\n}\n\n/**\n * converts a utxo to printable form\n * @remarks\n *\n * shows shortened output-id and the value being output, plus its datum\n * @internal\n **/\nexport function utxoAsString(\n    x: TxInput,\n    prefix = \"üíµ\",\n    utxoDCache?: UtxoDisplayCache\n): string {\n    return ` üìñ ${txOutputIdAsString(x.id)}: ${txOutputAsString(\n        x.output,\n        prefix,\n        utxoDCache,\n        x.id\n    )}`;\n}\n\n/**\n * converts a Datum to a printable summary\n * @remarks\n *\n * using shortening techniques for the datumHash\n * @public\n **/\nexport function datumSummary(d: TxOutputDatum | null | undefined): string {\n    if (!d) return \"\"; //\"‚Äπno datum‚Ä∫\";\n\n    // debugger\n    const dh = d.hash.toHex();\n    const dhss = `${dh.slice(0, 8)}‚Ä¶${dh.slice(-4)}`;\n    if (d.kind == \"InlineTxOutputDatum\") {\n        const attachedData = d.data.rawData;\n        if (attachedData) {\n            return `\\n    d‚Äπinline:${dhss} - ${\n                uplcDataSerializer(\"\", attachedData) //.slice(1,-1)\n            }=${d.toCbor().length} bytes‚Ä∫`;\n        } else {\n            return `d‚Äπinline:${dhss} - ${d.toCbor().length} bytes‚Ä∫`;\n        }\n    }\n    return `d‚Äπhash:${dhss}‚Ä¶‚Ä∫`;\n}\n// /**\n//  * @internal\n//  */\n// export function datumExpanded(d: Datum | null | undefined): string {\n//     if (!d) return \"\";\n//     if (!d.isInline()) return \"\";\n//     const data = bytesToHex(d.data?.toCbor());\n//     return `\\n    d = ${data}`;\n// }\n\n/**\n * Displays a short summary of any provided reference script\n * @remarks\n *\n * detailed remarks\n * @param ‚ÄπpName‚Ä∫ - descr\n * @typeParam ‚ÄπpName‚Ä∫ - descr (for generic types)\n * @public\n **/\nexport function showRefScript(rs?: UplcProgramV2 | null) {\n    if (!rs) return \"\";\n    const hash = rs.hash();\n    const hh = bytesToHex(hash);\n    const size = rs.toCbor().length;\n    const rshInfo = `${hh.slice(0, 8)}‚Ä¶${hh.slice(-4)}`;\n    return ` ‚ÄπüìÄ refScriptüìú ${rshInfo}: ${size} bytes‚Ä∫ +`;\n}\n\n/**\n * Converts a txOutput to printable form\n * @remarks\n *\n * including all its values, and shortened Address.\n * @public\n **/\nexport function txOutputAsString(\n    x: TxOutput,\n    prefix = \"<-\",\n    utxoDCache?: UtxoDisplayCache,\n    txoid?: TxOutputId\n): string {\n    if (utxoDCache && !txoid) {\n        throw new Error(\n            `txOutputAsString: must provide txoid when using cache`\n        );\n    }\n    let cache = utxoDCache?.get(txoid!);\n    if (cache) {\n        return `‚ôªÔ∏è ${cache} (same as above)`;\n    }\n    cache = `${prefix} ${addrAsString(x.address)}${showRefScript(\n        x.refScript as any\n    )} ${valueAsString(x.value)}`;\n    utxoDCache?.set(txoid!, cache);\n\n    return `${cache} ${datumSummary(x.datum)}`;\n}\n\n/**\n * Renders an address in shortened bech32 form, with prefix and part of the bech32 suffix\n * @remarks\n * @param address - address\n * @public\n **/\nexport function addrAsString(address: Address): string {\n    const bech32 = address.toString();\n    // const uplc = address.toUplcData?.();\n    // const hex = bytesToHex(uplc.toCbor());\n    return `${bech32.slice(0, 14)}‚Ä¶${bech32.slice(-4)}`;\n    // + ` = `+abbreviatedDetailBytes(\"‚Äπcbor:\", uplc.toCbor(), 99)+\"‚Ä∫\"\n}\n\n/**\n * Converts an Errors object to a string for onscreen presentation\n * @public\n **/\nexport function errorMapAsString(em: ErrorMap, prefix = \"  \") {\n    return Object.keys(em)\n        .map((k) => `in field ${prefix}${k}: ${JSON.stringify(em[k])}`)\n        .join(\"\\n\");\n}\n\n/**\n * Converts a list of ByteArrays to printable form\n * @remarks\n *\n * ... using {@link hexToPrintableString}\n * @public\n **/\nexport function byteArrayListAsString(\n    items: ByteArrayData[],\n    joiner = \"\\n  \"\n): string {\n    return (\n        \"[\\n  \" +\n        items.map((ba) => byteArrayAsString(ba)).join(joiner) +\n        \"\\n]\\n\"\n    );\n}\n\n/**\n * Renders a byteArray in printable form, assuming it contains (mostly) text\n * @remarks\n *\n * Because it uses {@link hexToPrintableString | hexToPrintableString()}, it will render any non-printable\n * characters using ‚Äπhex‚Ä∫ notation.\n * @param ba - the byte array\n * @public\n **/\nexport function byteArrayAsString(ba: ByteArrayData): string {\n    return hexToPrintableString(ba.toHex());\n}\n\n/**\n * Converts any (supported) input arg to string\n * @remarks\n *\n * more types to be supported TODO\n * @public\n **/\nexport function dumpAny(\n    x:\n        | undefined\n        | Tx\n        | StellarTxnContext\n        | Address\n        | MintingPolicyHash\n        | Value\n        | Assets\n        | TxOutputId\n        | TxOutput\n        | TxOutput[]\n        | TxInput\n        | TxInput[]\n        | TxId\n        | number[]\n        | ByteArrayData\n        | ByteArrayData[],\n    networkParams?: NetworkParams,\n    forJson = false\n) {\n    if (\"undefined\" == typeof x) return \"‚Äπundefined‚Ä∫\";\n    //@ts-expect-error probing type \n    if (x?.kind == \"Assets\") {\n        return `assets: ${assetsAsString(x as Assets)}`;\n    }\n    if (Array.isArray(x)) {\n        if (!x.length) return \"‚Äπempty array‚Ä∫\";\n\n        const firstItem = x[0];\n        if (\"number\" == typeof firstItem) {\n            return (\n                `num array: ‚Äπ\"${ \n                    byteArrayAsString(makeByteArrayData(x as number[]))\n                }\"‚Ä∫`\n            );\n        }\n        if (firstItem.kind == \"TxOutput\") {\n            return (\n                \"tx outputs: \\n\" +\n                (x as TxOutput[]).map((txo: TxOutput) => txOutputAsString(txo)).join(\"\\n\")\n            );\n        }\n\n        if (firstItem.kind == \"TxInput\") {\n            return \"utxos: \\n\" + utxosAsString(x as TxInput[]);\n        }\n\n        //@ts-expect-error on this type probe\n        if (firstItem.kind == \"ByteArrayData\") {\n            return (\n                \"byte array list:\\n\" + byteArrayListAsString(x as ByteArrayData[])\n            );\n        }\n\n        if (\"object\" == typeof firstItem) {\n            // debugger;\n            if (firstItem instanceof Uint8Array) {\n                return `byte array: ‚Äπ\"${byteArrayAsString(firstItem)}\"‚Ä∫`;\n            }\n            return (\n                `[` +\n                x\n                    .map((item) => JSON.stringify(item, betterJsonSerializer))\n                    .join(\", \") +\n                `]`\n            );\n        }\n\n        console.log(\"firstItem\", firstItem);\n        throw new Error(\n            `dumpAny(): unsupported array type: ${typeof firstItem}`\n        );\n    }\n\n    if (\"bigint\" == typeof x) {\n        return (x as bigint).toString();\n    }\n\n    if (isLibraryMatchedTcx(x)) {\n        debugger;\n        throw new Error(`use await build() and dump the result instead.`);\n    }\n\n    const xx = x;\n\n    if (x.kind == \"TxOutput\") {\n        return txOutputAsString(x as TxOutput);\n    }\n\n    if (xx.kind == \"Tx\") {\n        return txAsString(xx, networkParams);\n    }\n\n    if (xx.kind == \"TxOutputId\") {\n        return txOutputIdAsString(xx);\n    }\n\n    if (xx.kind == \"TxId\") {\n        return txidAsString(xx);\n    }\n\n    if (xx.kind == \"TxInput\") {\n        return utxoAsString(xx);\n    }\n    if (xx.kind == \"Value\") {\n        return valueAsString(xx);\n    }\n    if (xx.kind == \"Address\") {\n        return addrAsString(xx);\n    }\n    if (xx.kind == \"MintingPolicyHash\") {\n        return policyIdAsString(xx);\n    }\n    if (forJson) return xx;\n\n    if (\"object\" == typeof x) {\n        return `{${Object.entries(x)\n            .map(([k, v]) => `${k}: ${dumpAny(v as any, networkParams)}`)\n            .join(\",\\n\")}}`;\n    }\n    debugger;\n    return \"dumpAny(): unsupported type or library mismatch\";\n}\n\n/**\n * @public\n */\nexport const betterJsonSerializer = (key, value) => {\n    return dumpAny(value, undefined, true);\n};\n\nif (\"undefined\" == typeof window) {\n    globalThis.peek = dumpAny;\n} else {\n    //@ts-expect-error\n    window.peek = dumpAny;\n}\n","import type { Site } from \"@helios-lang/compiler-utils\";\nimport type { UplcLogger } from \"@helios-lang/uplc\";\n\nconst proc = typeof process == \"undefined\" ? {\n    stdout: {\n        columns: 65\n    },\n    env: {} as Record<string, string>\n} : process;\n\ntype Group = {\n    name: string;\n    lines: (LineOrGroup)[];\n    result?: string;\n    collapsed?: boolean\n}\n\ntype LineOrGroup = string | Group;\n\nexport class UplcConsoleLogger implements UplcLogger {\n    didStart: boolean = false;\n    // lines: LineOrGroup[] = [];\n    lastMessage: string = \"\";\n    lastReason?: \"build\" | \"validate\";\n    history: string[] = [];\n    groupStack: Group[] = [{\n        name: \"\",\n        lines: []\n    }];\n\n    constructor() {\n        this.logPrint = this.logPrint.bind(this);\n        // this.printlnFunction = this.printlnFunction.bind(this);\n        this.reset = this.reset.bind(this);\n    }\n\n    get currentGroupLines() {\n        return this.groupStack.at(-1)!.lines;\n    }\n\n    get topLines() {\n        return this.groupStack.at(0)!.lines;\n    }\n\n    reset(reason: \"build\" | \"validate\") {\n        this.lastMessage = \"\";\n        this.lastReason = reason;\n        this.groupStack = [{\n            name: \"\",\n            lines: []\n        }];\n        // console.log(\"    ---- resetting printer due to \" + reason);\n        // this.didStart = false;\n        if (reason == \"build\") {\n            // throw new Error(`unexpected`)\n            // this.lines = [];\n            this.groupStack[0].lines = [];\n            return;\n        }\n        if (reason == \"validate\") {\n            this.flush();\n            return;\n        }\n    }\n    // log(...msgs: string[]) {\n    //     return this.logPrint(...msgs);\n    // }\n    // error(...msgs: string[]) {\n    //     return this.logError(...msgs, \"\\n\");\n    // }\n\n    // logPrintLn(...msgs: string[]) {\n    //     return this.logPrint(...msgs, \"\\n\");\n    // }\n\n    interesting = 0\n    logPrint(message: string, site?: Site) {\n        // if ( global.validating) debugger\n        // if (msg == \"no\") { debugger }\n        // if (this.lastReason && this.lastReason == \"validate\") {\n        //     debugger\n        // }\n\n        if (message.match(/STokMint/)) {\n            this.interesting = 1\n        }\n        // üê£ = bird in egg (think \"nest\")\n        if (message.startsWith(\"üê£\")) {\n            const groupName = message.replace(\"üê£\", \"\").replace(\"üóúÔ∏è\", \"\");\n            const collapse = !!message.match(/^üê£üóúÔ∏è/) \n\n            const nextGroup = {\n                name: groupName.replace(/^\\s+/, \"\"),\n                lines: [],\n                collapse\n            };\n            // console.log(\"Group start: \" + groupName);\n            this.currentGroupLines.push(nextGroup)\n            this.groupStack.push(nextGroup);\n            \n            return this;\n        } else if (message.startsWith(\"ü•ö \")) {\n            // ü•ö = egg (think \"close up that container\")\n            const rest = message.replace(\"ü•ö \", \"\");\n            if (this.groupStack.length == 1) {\n                const t = this.formatLines(this.topLines)\n                debugger\n                console.warn(\n                    \"Ignoring extra groupEnd() called in contract script\\n\"+t.join(\"\\n\")\n                );\n            } else {\n                // console.log(\"Group end: \" + rest);\n                this.currentGroup.result = rest\n                this.groupStack.pop()\n            }\n            return this\n        }\n        \n        if (\"string\" != typeof message) {\n            console.log(\"wtf\");\n        }\n        // if (message && message.at(-1) != \"\\n\") {\n        //     message += \"\\n\";\n        // }\n        this.lastMessage = message;\n        this.currentGroup.lines.push(...message.split(\"\\n\"));\n        return this;\n    }\n\n    get currentGroup() {\n        const group = this.groupStack.at(-1);\n        if (!group) {\n            debugger\n            throw new Error(\"Too many groupEnd()s called in contract script\");\n        }\n        return group;\n    }\n\n    logError(message: string, stack? : Site) {\n        this.logPrint(\"\\n\");\n        this.logPrint(\n            \"-\".repeat((proc?.stdout?.columns || 65) - 8)\n        );\n        this.logPrint(\"--- ‚ö†Ô∏è  ERROR: \" + message.trimStart() + \"\\n\");\n        this.logPrint(\n            \"-\".repeat((proc?.stdout?.columns || 65) - 8) + \"\\n\"\n        );\n        // return this;\n    }\n    // printlnFunction(msg) {\n    //     console.log(\"                              ---- println\")\n    //     this.lines.push(msg);\n    //     this.lines.push(\"\\n\");\n    //     this.flushLines();\n    // }\n    toggler = 0;\n    toggleDots() {\n        this.toggler = 1 - this.toggler;\n    }\n    get isMine() {\n        return true;\n    }\n    resetDots() {\n        this.toggler = 0;\n    }\n    showDot() {\n        // ‚óå or ‚óè\n        const s = this.toggler ? \"‚îÇ   ‚îä \" : \"‚îÇ ‚óè ‚îä \";\n        this.toggleDots();\n        return s;\n    }\n\n    fullHistory() {\n        return this.history.join(\"\\n\");\n    }\n    formattedHistory: string[] = [];\n    fullFormattedHistory() {\n        return this.formattedHistory.join(\"\\n\")\n    }\n\n    // formatGroupedOutput() {\n    //     const content: string[] = [];\n    //     const terminalWidth = process?.stdout?.columns || 65;\n    //     for (const group of this.groupStack) {\n    //         content.push(... this.formatGroup(group));\n\n    //         let {name, lines} = group;\n    //         if (name) name = `  ${name}  `;\n    //         const groupHeader = `‚ï≠${name}`;\n    //         content.push(groupHeader);\n    //         content.push(lines.map(line => ` ‚îÇ ${line}`).join(\"\\n\"));\n    //         let lastLine = lines.at(-1)\n    //         if (lastLine && lastLine.startsWith(\"‚ï∞\")) {\n    //             lastLine = `‚ï∞ ${lastLine.slice(1)}`;\n    //         }\n    //         content.push(lastLine);\n    //     }\n    // }\n\n    formatGroup(group: Group) : string[] {\n        let {name, lines, result=\"\"} = group;\n        const terminalWidth = proc?.stdout?.columns || 65;\n\n        const content: string[] = [];\n        const groupHeader = `${name}`;\n        const formattedLines = this.formatLines(lines)\n        const indentedLines = formattedLines.map(line => `  ‚îÇ ${line}`);\n        // maybe an env option to prevent collapsing\n        const collapseThisGroup = false && group.collapsed; \n        if (collapseThisGroup) {\n            content.push(groupHeader + \" (+\" + formattedLines.length + \")\");\n        } else {\n            content.push(groupHeader);\n            content.push(... indentedLines);\n        }\n        const lastLine = formattedLines.at(-1);\n\n        const happySimpleResult = result && result == \"‚úÖ\" ?  \"‚úÖ\"  : \"\"\n        const noResult = !result\n        const noResultClosingLine = noResult ?  \"‚îà\".repeat(terminalWidth - 5) : \"\"\n\n        if ((noResult || happySimpleResult) && lastLine && lastLine?.match(/^\\s+‚ï∞/)) {\n            const innerLine = lastLine.replace(/^\\s+/, \"\")\n            // coalesces groups:\n            const marker = happySimpleResult || \"‚îà\"\n            let replacementLastLine =  `  ‚ï∞${marker} ${innerLine}`;\n            // if (replacementLastLine.length < terminalWidth) {\n            //     const extra = \"‚îà\".repeat(terminalWidth - replacementLastLine.length - 1)\n            //     replacementLastLine += \" \" + extra\n            if (replacementLastLine.length > terminalWidth) {\n                const tooMuch = replacementLastLine.length - terminalWidth\n                if (replacementLastLine.endsWith(\"‚îà\".repeat(tooMuch))) {\n                    replacementLastLine = replacementLastLine.slice(0, -tooMuch)\n                }\n            }\n            // replacementLastLine = `  ‚ï∞${marker} ${replacementLastLine}`;\n            if (collapseThisGroup) {\n                content.push(replacementLastLine)\n            } else {\n                content.splice(-1, 1, replacementLastLine)\n            }\n        } else if ((happySimpleResult || noResult) && lastLine?.match(/^\\s*‚úÖ/)) {\n            // combines the success-indicator on the last line\n            // with the \"close group\" indicator\n            const replacementLastLine = `  ‚ï∞ ${lastLine.replace(/^\\s+/, \"\")}`;\n            if (collapseThisGroup) {\n                content.push(replacementLastLine)\n            } else {\n                content.splice(-1, 1, replacementLastLine)\n            }\n        } else if (result) {\n            const extraClosingLine = `  ‚ï∞ ${result}`;\n            content.push(extraClosingLine)\n        } else {\n            const extraClosingLine = `  ‚ï∞${noResultClosingLine}`;\n            content.push(extraClosingLine)\n        }\n\n        // content.push(lastLine);\n        return content;\n    }\n\n    formatLines(lines: LineOrGroup[]) : string[] {\n        const content: string[] = [];\n        for (const line of lines) {\n            if (typeof line == \"string\") {\n                content.push(line);\n            } else {\n                content.push(... this.formatGroup(line));\n            }\n        }\n        content.at(-1)?.replace(/\\n+$/, \"\");\n        while(content.at(-1)?.match(/^\\n?$/)) {\n            content.pop();\n        }\n        return content;\n    }\n\n    flushLines(footerString?: string) {\n        // this.lines.push(this.accumulator.join(\"\"))\n        let content: string[] = [];\n        // get terminal width if available:\n        const terminalWidth = proc?.stdout?.columns || 65;\n        const formattedLines = this.formatLines(this.topLines);\n        this.history.push(formattedLines.join(\"\\n\"));\n        if (!this.didStart) {\n            this.didStart = true;\n            content.push(\"‚ï≠‚îà‚îà‚îà‚î¨\" + \"‚îà\".repeat(terminalWidth - 5) + \"\\n\");\n            this.resetDots();\n        } else if (this.topLines.length) {\n            content.push(\"‚îú‚îà‚îà‚îà‚îº\" + \"‚îà\".repeat(terminalWidth - 5) + \"\\n\");\n            this.resetDots();\n        }\n        for (const line of formattedLines) {\n            //\"‚îÇ\" or \"‚îä\" or \"‚îÜ\" or \"‚îá\" // unicode tiny  circle \"¬∑\"\n            content.push(`${this.showDot()}${line}\\n`);\n        }\n        // adds a little extra space before the footer\n        content.push(this.showDot() + \"\\n\");\n        // feed extra space if needed for the dots to look consistent\n        if (!this.toggler) {\n            content.push(this.showDot() + \"\\n\");\n        }\n        if (footerString) {\n            // if (!this.toggler && abortMarker) {\n            //     content.push(this.showDot());\n            // }\n            content.push(footerString);\n            // if (abortMarker) {\n            //     content.push(abortMarker);\n            // }\n        }\n        const joined = content.join(\"\");\n        this.formattedHistory.push(joined);\n        console.log(joined);\n        this.groupStack = [{\n            name: \"\",\n            lines: []\n        }]\n    }\n    finish() {\n        this.flushLines(\n            \"‚ï∞‚îà‚îà‚îà‚î¥\" + \"‚îà\".repeat((proc?.stdout?.columns || 65) - 5)\n        );\n        return this;\n    }\n\n    get groupLines() {\n        return this.groupStack.at(-1)?.lines || [];\n    }\n\n    flush() {\n        if (this.topLines.length) {\n            // console.log(\"    ---- flushing lines\");\n            if (this.lastMessage.at(-1) != \"\") {\n                this.groupLines.push(\"\");\n            }\n            this.flushLines();\n            //     \"‚ï∞,\"‚îà\"\n            // );\n        }\n        // console.log(\"‚ï∞ // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n        return this;\n    }\n    flushError(message: string = \"\") {\n        // if (this.lastMsg == message) {\n        //     this.lines.pop();\n        // }\n        if (this.lastMessage.at(-1) != \"\\n\") {\n            this.groupLines.push(\"\\n\");\n        }\n        if (message.at(-1) == \"\\n\") {\n            message = message.slice(0, -1);\n        }\n        const terminalWidth = proc?.stdout?.columns || 65;\n        if (message) this.logError(message);\n        if (this.topLines.length) {\n            this.flushLines(\n                \"‚éΩ‚éº‚éª‚é∫‚éª‚é∫‚éº‚éº‚éª‚é∫‚éª‚éΩ‚éº‚é∫‚éª‚éª‚é∫‚éº‚éº‚éª‚é∫\".repeat((terminalWidth - 2) / 21)\n            );\n        }\n        // this.didStart = false;\n        return this;\n    }\n}\n","import {\n    dumpAny,\n    intWithGrouping,\n    lovelaceToAda,\n    txAsString,\n    utxosAsString,\n} from \"./diagnostics.js\";\nimport type { hasUutContext } from \"./CapoTypes.js\";\nimport { UutName } from \"./delegation/UutName.js\";\nimport type { ActorContext, SetupInfo } from \"./StellarContract.js\";\nimport { delegateLinkSerializer } from \"./delegation/jsonSerializers.js\";\nimport type { Cost, UplcData, UplcProgramV2 } from \"@helios-lang/uplc\";\nimport { UplcConsoleLogger } from \"./UplcConsoleLogger.js\";\nimport type { isActivity, SeedAttrs } from \"./ActivityTypes.js\";\nimport {\n    type TxBuilder,\n    type WalletHelper,\n    type Wallet,\n    makeTxBuilder,\n    makeWalletHelper,\n    makeTxChainBuilder,\n} from \"@helios-lang/tx-utils\";\nimport {\n    decodeTx,\n    makeAssets,\n    makeNetworkParamsHelper,\n    makePubKey,\n    makeTx,\n    makeTxBody,\n    makeTxCertifyingRedeemer,\n    makeTxMintingRedeemer,\n    makeTxRewardingRedeemer,\n    makeTxSpendingRedeemer,\n    makeTxWitnesses,\n    makeValue,\n    type Address,\n    type NetworkParams,\n    type PubKeyHash,\n    type Tx,\n    type TxId,\n    type TxInput,\n    type TxOutput,\n    type Value,\n} from \"@helios-lang/ledger\";\nimport { bytesToHex } from \"@helios-lang/codec-utils\";\nimport type { UtxoHelper } from \"./UtxoHelper.js\";\nimport type { IF_ISANY } from \"./helios/typeUtils.js\";\nimport type { Expand } from \"./helios/typeUtils.js\";\nimport { customAlphabet } from \"nanoid\";\nconst nanoid = customAlphabet(\"0123456789abcdefghjkmnpqrstvwxyz\", 12);\nimport { TxNotNeededError } from \"./utils.js\";\n\n/**\n * A txn context having a seedUtxo in its state\n * @public\n **/\nexport type hasSeedUtxo = StellarTxnContext<\n    anyState & {\n        seedUtxo: TxInput;\n    }\n>;\n\nexport type txBuiltOrSubmitted =\n    | \"built\"\n    | \"alreadyPresent\"\n    | \"signed\"\n    | \"submitted\";\nexport type resolvedOrBetter = \"resolved\" | txBuiltOrSubmitted;\n/**\n * @public\n */\nexport type TxDescription<\n    T extends StellarTxnContext,\n    PROGRESS extends\n        | \"buildLater!\"\n        | \"resolved\"\n        | \"alreadyPresent\"\n        | \"built\"\n        | \"signed\"\n        | \"submitted\",\n    TCX extends StellarTxnContext = IF_ISANY<T, StellarTxnContext<anyState>, T>,\n    otherProps extends Record<string, unknown> = {}\n> = {\n    description: string;\n    id: string;\n    parentId?: string;\n    depth: number;\n    moreInfo?: string;\n    optional?: boolean;\n    txName?: string;\n    tcx?: TCX | TxNotNeededError;\n    tx?: Tx;\n    stats?: BuiltTcxStats;\n    txCborHex?: string;\n    signedTxCborHex?: string;\n} & otherProps &\n    (PROGRESS extends \"alreadyPresent}\"\n        ? {\n              mkTcx: (() => TCX) | (() => Promise<TCX>);\n              tcx: TCX & { alreadyPresent: TxNotNeededError };\n          }\n        : PROGRESS extends resolvedOrBetter\n        ? {\n              mkTcx?: (() => TCX) | (() => Promise<TCX>) | undefined;\n              tcx: TCX;\n          }\n        : {\n              mkTcx: (() => TCX) | (() => Promise<TCX>);\n              tcx?: undefined;\n          }) &\n    (PROGRESS extends txBuiltOrSubmitted\n        ? {\n              tx: Tx;\n              txId?: TxId;\n              stats: BuiltTcxStats;\n              options: SubmitOptions;\n              txCborHex: string;\n          }\n        : {}) &\n    (PROGRESS extends \"signed\" | \"submitted\"\n        ? {\n              txId: TxId;\n              txCborHex: string;\n              signedTxCborHex: string;\n              walletTxId: TxId;\n          }\n        : {});\n\n/**\n * @public\n */\nexport type MultiTxnCallback<\n    T extends undefined | StellarTxnContext<any> = StellarTxnContext<any>,\n    TXINFO extends TxDescription<any, resolvedOrBetter, any> = TxDescription<\n        any,\n        \"resolved\"\n    >\n> =\n    | ((txd: TXINFO) => void)\n    | ((txd: TXINFO) => Promise<void>)\n    | ((txd: TXINFO) => T | false)\n    | ((txd: TXINFO) => Promise<T | false>);\n\n/**\n * A transaction context that includes additional transactions in its state for later execution\n * @remarks\n *\n * During the course of creating a transaction, the transaction-building functions for a contract\n * suite may suggest or require further transactions, which may not be executable until after the\n * current transaction is executed.  This type allows the transaction context to include such\n * future transactions in its state, so that they can be executed later.\n *\n * The future transactions can be executed using the {@link StellarTxnContext.queueAddlTxns}\n * helper method.\n * @public\n **/\nexport type hasAddlTxns<\n    TCX extends StellarTxnContext<anyState>,\n    existingStateType extends anyState = TCX[\"state\"]\n> = StellarTxnContext<\n    existingStateType & {\n        addlTxns: Record<string, TxDescription<any, \"buildLater!\">>;\n    }\n>;\n\nexport type otherAddlTxnNames<TCX extends StellarTxnContext<any>> = string &\n    TCX extends { state: { addlTxns: infer aTNs } }\n    ? keyof aTNs\n    : never;\n\n// type combinedAddlTxns<\n//     extraTxnName extends string,\n//     stateType extends anyState,\n//     existingTxns = stateType extends {addlTxns: any} ? stateType[\"addlTxns\"] : never,\n//     existingTxnNames extends string = string & keyof existingTxns\n// > = {\n//     addlTxns: {\n//         //prettier-ignore\n//         [txnName in (\n//             | extraTxnName\n//             | existingTxnNames\n//         )]: AddlTxInfo<any>\n//     }\n// } & stateType;\n\n//!!! if we could access the inputs and outputs in a building Tx,\n//  this might  not be necessary (unless it becomes a\n//   bigger-picture contextual container that serves various Stellar\n//   contract scripts with non-txn context for building a Tx)\n\n/**\n * A base state for a transaction context\n * @public\n **/\nexport interface anyState {\n    uuts: uutMap;\n}\n\n/**\n * A base state for a transaction context\n * @public\n **/\n// export type anyState = emptyState;\nexport type uutMap = Record<string, unknown>;\nexport const emptyUuts: uutMap = Object.freeze({});\n\n// type addInputArgs = Parameters<TxBuilder[\"spend\"]>;\ntype addRefInputArgs = Parameters<TxBuilder[\"refer\"]>;\n\ntype RedeemerArg = {\n    redeemer?: UplcData;\n};\n\nexport type TxDescriptionWithError = TxDescription<\n    any,\n    \"built\",\n    any,\n    {\n        error: string;\n    }\n>;\n\n/**\n * @public\n */\nexport type SubmitOptions = TxPipelineOptions & {\n    /**\n     * indicates additional signers expected for the transaction\n     */\n    signers?: Address[];\n    addlTxInfo?: Partial<\n        Omit<TxDescription<any, \"submitted\">, \"description\">\n    > & { description: string };\n    paramsOverride?: Partial<NetworkParams>;\n    /**\n     * useful most for test environment, so that a txn failure can be me marked\n     * as \"failing as expected\".  Not normally needed for production code.\n     */\n    expectError?: true;\n    /**\n     * Called when there is a detected error, before logging.  Probably only needed in test.\n     */\n    beforeError?: MultiTxnCallback<any, TxDescriptionWithError>;\n    /**\n     * Passed into the Helios TxBuilder's build()/buildUnsafe()\n     */\n    beforeValidate?: (tx: Tx) => MultiTxnCallback<any>;\n};\n\ntype MintUnsafeParams = Parameters<TxBuilder[\"mintPolicyTokensUnsafe\"]>;\ntype MintTokensParams = [\n    MintUnsafeParams[0],\n    MintUnsafeParams[1],\n    { redeemer: MintUnsafeParams[2] }\n];\n/**\n * Provides notifications for various stages of transaction submission\n * @public\n */\ntype TxPipelineOptions = Expand<\n    TxSubmitCallbacks & {\n        fixupBeforeSubmit?: MultiTxnCallback;\n        whenBuilt?: MultiTxnCallback<any, TxDescription<any, \"built\">>;\n    }\n>;\n\nexport type TxSubmitCallbacks = {\n    onSubmitError?: MultiTxnCallback<\n        any,\n        TxDescription<any, \"built\", any, { error: string }>\n    >;\n    onSubmitted?: MultiTxnCallback<any, TxDescription<any, \"submitted\">>;\n};\n\ntype BuiltTcx = {\n    tx: Tx;\n} & BuiltTcxStats;\n\ntype BuiltTcxStats = {\n    willSign: PubKeyHash[];\n    walletMustSign: boolean;\n    wallet: Wallet;\n    wHelper: WalletHelper<any>;\n    costs: {\n        total: Cost;\n        [key: string]: Cost;\n    };\n};\n\nexport type FacadeTxnContext<S extends anyState = anyState> = hasAddlTxns<\n    StellarTxnContext<S>\n> & {\n    isFacade: true;\n};\n\n/**\n * Transaction-building context for Stellar Contract transactions\n * @remarks\n *\n * Uses same essential facade as Helios Tx.\n *\n * Adds a transaction-state container with strong typing of its contents,\n * enabling transaction-building code to use type-sensitive auto-complete\n * and allowing Stellar Contracts library code to require transaction contexts\n * having known states.\n *\n * Retains reflection capabilities to allow utxo-finding utilities to exclude\n * utxo's already included in the contract.\n *\n * @typeParam S - type of the context's `state` prop\n * @public\n **/\nexport class StellarTxnContext<S extends anyState = anyState> {\n    kind: \"StellarTxnContext\" = \"StellarTxnContext\";\n    id: string = nanoid(5);\n    inputs: TxInput[] = [];\n    collateral?: TxInput;\n    outputs: TxOutput[] = [];\n    feeLimit?: bigint;\n    state: S;\n    allNeededWitnesses: (Address | PubKeyHash)[] = [];\n    otherPartySigners: PubKeyHash[] = [];\n    parentTcx?: StellarTxnContext<any>;\n    childReservedUtxos: TxInput[] = [];\n    parentId: string = \"\";\n    alreadyPresent: TxNotNeededError | undefined = undefined;\n    depth = 0;\n    declare setup: SetupInfo;\n    // submitOptions?: SubmitOptions\n    txb: TxBuilder;\n    txnName: string = \"\";\n    withName(name: string) {\n        this.txnName = name;\n        return this;\n    }\n\n    get wallet() {\n        return this.setup.actorContext.wallet!;\n    }\n\n    get uh(): UtxoHelper {\n        return this.setup.uh!;\n    }\n\n    get networkParams(): NetworkParams {\n        return this.setup.networkParams;\n    }\n\n    get actorContext(): ActorContext<any> {\n        return this.setup.actorContext;\n    }\n    /**\n     * Provides a lightweight, NOT complete, serialization for presenting the transaction context\n     * @remarks\n     * Serves rendering of the transaction context in vitest\n     * @internal\n     */\n    toJSON() {\n        return {\n            kind: \"StellarTxnContext\",\n            state: !!this.state\n                ? `{${Object.keys(this.state).join(\", \")}}`\n                : undefined,\n            inputs: `[${this.inputs.length} inputs]`,\n            outputs: `[${this.outputs.length} outputs]`,\n            isBuilt: !!this._builtTx,\n            hasParent: !!this.parentTcx,\n            //@ts-expect-error\n            addlTxns: this.state.addlTxns\n                ? [\n                      //@ts-expect-error\n                      ...Object.keys(this.state.addlTxns || {}),\n                  ]\n                : undefined,\n        };\n    }\n\n    logger = new UplcConsoleLogger();\n    constructor(\n        setup: SetupInfo,\n        state: Partial<S> = {},\n        parentTcx?: StellarTxnContext<any>\n    ) {\n        if (parentTcx) {\n            console.warn(\n                \"Deprecated use of 'parentTcx' - use includeAddlTxn() instead\" +\n                    \"\\n  ... setup.txBatcher.current holds an in-progress utxo set for all 'parent' transactions\"\n            );\n            throw new Error(`parentTcx used where? `);\n        }\n        Object.defineProperty(this, \"setup\", {\n            enumerable: false,\n            value: setup,\n        });\n        Object.defineProperty(this, \"_builtTx\", {\n            enumerable: false,\n            writable: true,\n        });\n\n        const isMainnet = setup.isMainnet;\n        this.isFacade = undefined;\n\n        if (\"undefined\" == typeof isMainnet) {\n            throw new Error(\n                \"StellarTxnContext: setup.isMainnet must be defined\"\n            );\n        }\n        this.txb = makeTxBuilder({\n            isMainnet,\n        });\n        // const { uuts = { ...emptyUuts }, ...moreState } = state;\n        //@ts-expect-error\n        this.state = {\n            ...state,\n            uuts: state.uuts || { ...emptyUuts },\n        };\n\n        const currentBatch = this.currentBatch;\n        const hasOpenBatch = currentBatch?.isOpen;\n        if (!currentBatch || currentBatch.isConfirmationComplete) {\n            this.setup.txBatcher.rotate(this.setup.chainBuilder);\n        }\n\n        if (!this.setup.isTest && !this.setup.chainBuilder) {\n            if (currentBatch.chainBuilder) {\n                // backfills the chainbuilder from the one auto-populated\n                // during `get TxBatcher.current()`\n                this.setup.chainBuilder = currentBatch.chainBuilder;\n            } else {\n                this.setup.chainBuilder = makeTxChainBuilder(\n                    this.setup.network\n                );\n            }\n        }\n\n        if (parentTcx) {\n            debugger;\n            throw new Error(`parentTcx used where? `);\n        }\n        this.parentTcx = parentTcx;\n    }\n\n    isFacade: true | false | undefined;\n    facade(this: StellarTxnContext): hasAddlTxns<this> & { isFacade: true } {\n        if (this.isFacade === false)\n            throw new Error(`this tcx already has txn material`);\n        if (this.parentTcx)\n            throw new Error(`no parentTcx allowed for tcx facade`);\n\n        const t: hasAddlTxns<this> = this as any;\n        t.state.addlTxns = t.state.addlTxns || {};\n        t.isFacade = true;\n        return this as any;\n    }\n    noFacade(situation: string) {\n        if (this.isFacade)\n            throw new Error(\n                `${situation}: ${\n                    this.txnName || \"this tcx\"\n                } is a facade for nested multi-tx`\n            );\n        this.isFacade = false;\n    }\n\n    withParent(tcx: StellarTxnContext<any>) {\n        this.noFacade(\"withParent\");\n        this.parentTcx = tcx;\n        return this;\n    }\n\n    get actorWallet() {\n        return this.actorContext.wallet;\n    }\n\n    dump(tx?: Tx): string;\n    dump(): Promise<string>;\n    dump(tx?: Tx): string | Promise<string> {\n        const t = tx || this.builtTx;\n        if (t instanceof Promise) {\n            return t.then((tx) => {\n                return txAsString(tx, this.setup.networkParams);\n            });\n        }\n        return txAsString(t, this.setup.networkParams);\n    }\n\n    includeAddlTxn<\n        TCX extends StellarTxnContext<anyState>,\n        RETURNS extends hasAddlTxns<TCX> = TCX extends hasAddlTxns<any>\n            ? TCX\n            : hasAddlTxns<TCX>\n    >(\n        this: TCX,\n        txnName: string,\n        txInfoIn: Omit<\n            TxDescription<any, \"buildLater!\">,\n            \"id\" | \"depth\" | \"parentId\"\n        > & {\n            id?: string;\n        }\n    ): RETURNS {\n        const txInfo: TxDescription<any, \"buildLater!\"> = {\n            ...(txInfoIn as any),\n        };\n        if (!txInfo.id)\n            txInfo.id =\n                //@ts-expect-error - the tcx is never there,\n                // but including the fallback assignment here for\n                // consistency about the policy of syncing to it.\n                txInfo.tcx?.id || nanoid(5);\n\n        txInfo.parentId = this.id;\n\n        txInfo.depth = (this.depth || 0) + 1;\n        const thisWithMoreType: RETURNS = this as any;\n        if (\"undefined\" == typeof this.isFacade) {\n            throw new Error(\n                `to include additional txns on a tcx with no txn details, call facade() first.\\n` +\n                    `   ... otherwise, add txn details first or set isFacade to false`\n            );\n        }\n        // if (thisWithMoreType.state.addlTxns?.[txnName]) {\n        //     debugger\n        //     throw new Error(\n        //         `addlTxns['${txnName}'] already included in this transaction:\\n` +\n        //             Object.keys(thisWithMoreType.state.addlTxns).map(\n        //                 (k) => ` ‚Ä¢ ${k}`\n        //             ).join(\"\\n\")\n        //     );\n        // }\n        thisWithMoreType.state.addlTxns = {\n            ...(thisWithMoreType.state.addlTxns || {}),\n            [txInfo.id]: txInfo,\n        };\n        return thisWithMoreType;\n    }\n\n    /**\n     * @public\n     */\n    get addlTxns(): Record<string, TxDescription<any, \"buildLater!\">> {\n        //@ts-expect-error\n        return this.state.addlTxns || {};\n    }\n\n    mintTokens(...args: MintTokensParams): StellarTxnContext<S> {\n        this.noFacade(\"mintTokens\");\n        const [policy, tokens, r = { redeemer: undefined }] = args;\n        const { redeemer } = r;\n        if (this.txb.mintPolicyTokensUnsafe) {\n            this.txb.mintPolicyTokensUnsafe(policy, tokens, redeemer);\n        } else {\n            //@ts-expect-error\n            this.txb.mintTokens(policy, tokens, redeemer);\n        }\n\n        return this;\n    }\n\n    getSeedAttrs<TCX extends hasSeedUtxo>(this: TCX): SeedAttrs {\n        this.noFacade(\"getSeedAttrs\");\n        // const { seedUtxo } = this.state;  // bad api-extractor!\n        const seedUtxo = this.state.seedUtxo;\n        // const { txId, utxoIdx: seedIndex } = seedUtxo.id; // ugh, api-extractor!\n        return { txId: seedUtxo.id.txId, idx: BigInt(seedUtxo.id.index) };\n    }\n\n    reservedUtxos(): TxInput[] {\n        this.noFacade(\"reservedUtxos\");\n        return this.parentTcx\n            ? this.parentTcx.reservedUtxos()\n            : ([\n                  ...this.inputs,\n                  this.collateral,\n                  ...this.childReservedUtxos,\n              ].filter((x) => !!x) as TxInput[]);\n    }\n\n    utxoNotReserved(u: TxInput): TxInput | undefined {\n        if (this.collateral?.isEqual(u)) return undefined;\n        if (this.inputs.find((i) => i.isEqual(u))) return undefined;\n        return u;\n    }\n\n    addUut<T extends string, TCX extends StellarTxnContext>(\n        this: TCX,\n        //!!! todo: type this more strongly by adding strong typing to the UutName itself?\n        uutName: UutName,\n        ...names: T[]\n    ): hasUutContext<T> & TCX {\n        this.noFacade(\"addUut\");\n        this.state.uuts = this.state.uuts || {};\n\n        for (const name of names) {\n            this.state.uuts[name] = uutName;\n        }\n\n        return this as hasUutContext<T> & TCX;\n    }\n\n    addState<TCX extends StellarTxnContext, K extends string, V>(\n        this: TCX,\n        key: K,\n        value: V\n    ): StellarTxnContext<{ [keyName in K]: V } & anyState> & TCX {\n        this.noFacade(\"addState\");\n        //@ts-expect-error\n        this.state[key] = value;\n        return this as StellarTxnContext<{ [keyName in K]: V } & anyState> &\n            TCX;\n    }\n\n    addCollateral(collateral: TxInput) {\n        this.noFacade(\"addCollateral\");\n        console.warn(\"explicit addCollateral() should be unnecessary unless a babel payer is covering it\")\n        \n        if (!collateral.value.assets.isZero()) {\n            throw new Error(\n                `invalid attempt to add non-pure-ADA utxo as collateral`\n            );\n        }\n        this.collateral = collateral;\n\n        this.txb.addCollateral(collateral);\n        return this;\n    }\n    getSeedUtxoDetails(this: hasSeedUtxo): SeedAttrs {\n        this.noFacade(\"getSeedUtxoDetails\");\n        const seedUtxo = this.state.seedUtxo;\n        return {\n            txId: seedUtxo.id.txId,\n            idx: BigInt(seedUtxo.id.index),\n        };\n    }\n\n    _txnTime?: Date;\n    /**\n     * Sets a future date for the transaction to be executed, returning the transaction context.  Call this before calling validFor().\n     *\n     * @remarks Returns the txn context.\n     * Throws an error if the transaction already has a txnTime set.\n     *\n     * This method does not itself set the txn's validity interval.  You MUST combine it with\n     * a call to validFor(), to set the txn's validity period.  The resulting transaction will\n     * be valid from the moment set here until the end of the validity period set by validFor().\n     *\n     * This can be used anytime to construct a transaction valid in the future.  This is particularly useful\n     * during test scenarios to verify time-sensitive behaviors.\n     *\n     * In the test environment, the network wil normally be advanced to this date\n     * before executing the transaction, unless a different execution time is indicated.\n     * Use the test helper's `submitTxnWithBlock(txn, {futureDate})` or `advanceNetworkTimeForTx()` methods, or args to\n     * use-case-specific functions that those methods.\n     */\n    futureDate<TCX extends StellarTxnContext<S>>(this: TCX, date: Date) {\n        this.noFacade(\"futureDate\");\n        if (this._txnTime) {\n            throw new Error(\n                \"txnTime already set; cannot set futureDate() after txnTime\"\n            );\n        }\n\n        const d = new Date(\n            Number(this.slotToTime(this.timeToSlot(BigInt(date.getTime()))))\n        );\n        // time emoji: ‚è∞\n        console.log(\"  ‚è∞‚è∞ setting txnTime to \", d.toString());\n        this._txnTime = d;\n        return this;\n    }\n\n    assertNumber(obj, msg = \"expected a number\") {\n        if (obj === undefined || obj === null) {\n            throw new Error(msg);\n        } else if (typeof obj == \"number\") {\n            return obj;\n        } else {\n            throw new Error(msg);\n        }\n    }\n\n    /**\n     * Calculates the time (in milliseconds in 01/01/1970) associated with a given slot number.\n     * @param slot - Slot number\n     */\n    slotToTime(slot: bigint): bigint {\n        let secondsPerSlot = this.assertNumber(\n            this.networkParams.secondsPerSlot\n        );\n\n        let lastSlot = BigInt(this.assertNumber(this.networkParams.refTipSlot));\n        let lastTime = BigInt(this.assertNumber(this.networkParams.refTipTime));\n\n        let slotDiff = slot - lastSlot;\n\n        return lastTime + slotDiff * BigInt(secondsPerSlot * 1000);\n    }\n\n    /**\n     * Calculates the slot number associated with a given time.\n     * @param time - Milliseconds since 1970\n     */\n    timeToSlot(time: bigint): bigint {\n        let secondsPerSlot = this.assertNumber(\n            this.networkParams.secondsPerSlot\n        );\n\n        let lastSlot = BigInt(this.assertNumber(this.networkParams.refTipSlot));\n        let lastTime = BigInt(this.assertNumber(this.networkParams.refTipTime));\n\n        let timeDiff = time - lastTime;\n\n        return (\n            lastSlot +\n            BigInt(Math.round(Number(timeDiff) / (1000 * secondsPerSlot)))\n        );\n    }\n\n    /**\n     * Identifies the time at which the current transaction is expected to be executed.\n     * Use this attribute in any transaction-building code that sets date/time values\n     * for the transaction.\n     * Honors any futureDate() setting or uses the current time if none has been set.\n     */\n    get txnTime() {\n        if (this._txnTime) return this._txnTime;\n        const now = Date.now();\n        const recent = now - 180_000;\n        const d = new Date(\n            Number(this.slotToTime(this.timeToSlot(BigInt(recent))))\n        );\n        // time emoji: ‚è∞\n        console.log(\"‚è∞‚è∞setting txnTime to \", d.toString());\n        return (this._txnTime = d);\n    }\n\n    _txnEndTime?: Date;\n    get txnEndTime() {\n        if (this._txnEndTime) return this._txnEndTime;\n        throw new Error(\"call [optional: futureDate() and] validFor(durationMs) before fetching the txnEndTime\")\n    }\n        \n   /**\n     * Sets an on-chain validity period for the transaction, in miilliseconds\n     *\n     * @remarks if futureDate() has been set on the transaction, that\n     * date will be used as the starting point for the validity period.\n     *\n     * Returns the transaction context for chaining.\n     *\n     * @param durationMs - the total validity duration for the transaction.  On-chain\n     *  checks using CapoCtx `now(granularity)` can enforce this duration\n     */\n    validFor<TCX extends StellarTxnContext<S>>(\n        this: TCX,\n        durationMs: number\n    ): TCX {\n        this.noFacade(\"validFor\");\n        const startMoment = this.txnTime.getTime();\n\n        // if the desired duration is greater  the current validity period,\n        //   DO NOT constraint the validity period further.\n        // If the current validity period is greater than the desired duration,\n        //   we SHOULD constrain the tx validity to this more restrictive duration.\n        this._validityPeriodSet = true;\n        this.txb\n            .validFromTime(new Date(startMoment))\n            .validToTime(new Date(startMoment + durationMs));\n\n        return this;\n    }\n    _validityPeriodSet = false;\n    txRefInputs: TxInput[] = [];\n    /**\n     * adds a reference input to the transaction context\n     * @remarks\n     *\n     * idempotent version of helios addRefInput()\n     *\n     * @public\n     **/\n    addRefInput<TCX extends StellarTxnContext<S>>(\n        this: TCX,\n        input: TxInput<any>,\n        refScript?: UplcProgramV2\n    ) {\n        this.noFacade(\"addRefInput\");\n        if (!input) throw new Error(`missing required input for addRefInput()`);\n\n        if (this.txRefInputs.find((v) => v.id.isEqual(input.id))) {\n            console.warn(\"suppressing second add of refInput\");\n            return this;\n        }\n        if (this.inputs.find((v) => v.id.isEqual(input.id))) {\n            console.warn(\n                \"suppressing add of refInput that is already an input\"\n            );\n            return this;\n        }\n        this.txRefInputs.push(input);\n\n        //@ts-expect-error private field\n        const v2sBefore = this.txb.v2Scripts;\n        if (refScript) {\n            //@ts-expect-error on private method\n            this.txb.addV2RefScript(refScript);\n        }\n\n        this.txb.refer(input);\n        //@ts-expect-error private field\n        const v2sAfter = this.txb.v2Scripts;\n\n        // const t2 = this.txb.witnesses.scripts.length;\n        // if (t2 > t) {\n        if (v2sAfter.length > v2sBefore.length) {\n            console.log(\"       --- addRefInput added a script to tx.scripts\");\n        }\n\n        return this;\n    }\n\n    /**\n     * @deprecated - use addRefInput() instead.\n     */\n    addRefInputs<TCX extends StellarTxnContext<S>>(\n        this: TCX,\n        ...args: addRefInputArgs\n    ) {\n        throw new Error(`deprecated`);\n    }\n\n    addInput<TCX extends StellarTxnContext<S>>(\n        this: TCX,\n        input: TxInput,\n        r?: isActivity\n    ): TCX {\n        this.noFacade(\"addInput\");\n        if (r && !r.redeemer) {\n            console.log(\"activity without redeemer tag: \", r);\n            throw new Error(\n                `addInput() redeemer must match the isActivity type {redeemer: ‚Äπactivity‚Ä∫}\\n`\n                // JSON.stringify(r, delegateLinkSerializer)\n            );\n        }\n\n        //@ts-expect-error probing for pubKeyHash\n        if (input.address.pubKeyHash)\n            this.allNeededWitnesses.push(input.address);\n        this.inputs.push(input);\n        if (this.parentTcx) {\n            this.parentTcx.childReservedUtxos.push(input);\n        }\n        try {\n            this.txb.spendUnsafe(input, r?.redeemer);\n        } catch (e: any) {\n            // console.log(\"failed adding input to txn: \", dumpAny(this));\n            debugger;\n            throw new Error(\n                `addInput: ${e.message}` +\n                    \"\\n   ...TODO: dump partial txn from txb above.  Failed TxInput:\\n\" +\n                    dumpAny(input)\n            );\n        }\n\n        return this;\n    }\n\n    addOutput<TCX extends StellarTxnContext<S>>(\n        this: TCX,\n        output: TxOutput\n    ): TCX {\n        this.noFacade(\"addOutput\");\n        try {\n            this.txb.addOutput(output);\n            this.outputs.push(output);\n        } catch (e: any) {\n            console.log(\n                \"Error adding output to txn: \\n\" +\n                    \"  | inputs:\\n  | \" +\n                    utxosAsString(this.inputs, \"\\n  | \") +\n                    \"\\n  | \" +\n                    (dumpAny(this.outputs) as string)\n                        .split(\"\\n\")\n                        .join(\"\\n  |   \") +\n                    \"\\n... in context of partial tx above: failed adding output: \\n  |  \",\n                dumpAny(output),\n                \"\\n\" + e.message,\n                \"\\n   (see thrown stack trace below)\"\n            );\n            e.message =\n                `addOutput: ${e.message}` + \"\\n   ...see logged details above\";\n            throw e;\n        }\n\n        return this;\n    }\n\n    attachScript(...args: Parameters<TxBuilder[\"attachUplcProgram\"]>) {\n        throw new Error(\n            `use addScriptProgram(), increasing the txn size, if you don't have a referenceScript.\\n` +\n                `Use <capo>.txnAttachScriptOrRefScript() to use a referenceScript when available.`\n        );\n    }\n\n    /**\n     * Adds a UPLC program to the transaction context, increasing the transaction size.\n     * @remarks\n     * Use the Capo's `txnAttachScriptOrRefScript()` method to use a referenceScript\n     * when available. That method uses a fallback approach adding the script to the\n     * transaction if needed.\n     */\n    addScriptProgram(...args: Parameters<TxBuilder[\"attachUplcProgram\"]>) {\n        this.noFacade(\"addScriptProgram\");\n        this.txb.attachUplcProgram(...args);\n\n        return this;\n    }\n\n    wasModified() {\n        //@ts-expect-error private method\n        this.txb.wasModified();\n    }\n\n    _builtTx?: Tx | Promise<Tx>;\n    get builtTx() {\n        this.noFacade(\"builtTx\");\n        if (!this._builtTx) {\n            throw new Error(`can't go building the tx willy-nilly`);\n            return (this._builtTx = this.build().then(({ tx }) => {\n                return (this._builtTx = tx);\n            }));\n        }\n        return this._builtTx;\n    }\n\n    async addSignature(wallet: Wallet) {\n        this.noFacade(\"addSignature\");\n        const builtTx = await this.builtTx;\n        const sig = await wallet.signTx(builtTx);\n\n        builtTx.addSignature(sig[0]);\n    }\n\n    hasAuthorityToken(authorityValue: Value) {\n        return this.inputs.some(i => i.value.isGreaterOrEqual(authorityValue))\n    }\n\n    async findAnySpareUtxos(): Promise<TxInput[] | never> {\n        this.noFacade(\"findAnySpareUtxos\");\n        const mightNeedFees = 3_500_000n; // lovelace this.ADA(3.5);\n\n        const toSortInfo = this.uh.mkUtxoSortInfo(mightNeedFees);\n        const notReserved =\n            this.utxoNotReserved.bind(this) || ((u: TxInput) => u);\n\n        const uh = this.uh;\n        return uh\n            .findActorUtxo(\n                \"spares for tx balancing\",\n                notReserved,\n                {\n                    wallet: this.wallet,\n                    dumpDetail: \"onFail\",\n                },\n                \"multiple\"\n            )\n            .then(async (utxos) => {\n                if (!utxos) {\n                    throw new Error(\n                        `no utxos found for spares for tx balancing.  We can ask the user to send a series of 10, 11, 12, ... ADA to themselves or do it automatically`\n                    );\n                }\n\n                const allSpares = utxos\n                    .map(toSortInfo)\n                    .filter(uh.utxoIsSufficient)\n                    .sort(uh.utxoSortSmallerAndPureADA);\n\n                if (allSpares.reduce(uh.reduceUtxosCountAdaOnly, 0) > 0) {\n                    return allSpares\n                        .filter(uh.utxoIsPureADA)\n                        .map(uh.sortInfoBackToUtxo);\n                }\n                return allSpares.map(uh.sortInfoBackToUtxo);\n            });\n    }\n\n    async findChangeAddr(): Promise<Address> {\n        this.noFacade(\"findChangeAddr\");\n        // const {\n        //     actorContext: { wallet },\n        // } = this; // ugh, api-extractor!\n        const wallet = this.actorContext.wallet;\n        if (!wallet) {\n            throw new Error(\n                `‚ö†Ô∏è  ${this.constructor.name}: no this.actorContext.wallet; can't get required change address!`\n            );\n        }\n        let unused = (await wallet.unusedAddresses).at(0);\n        if (!unused) unused = (await wallet.usedAddresses).at(-1);\n        if (!unused)\n            throw new Error(\n                `‚ö†Ô∏è  ${this.constructor.name}: can't find a good change address!`\n            );\n        return unused;\n    }\n\n    /**\n     * Adds required signers to the transaction context\n     * @remarks\n     * Before a transaction can be submitted, signatures from each of its signers must be included.\n     * \n     * Any inputs from the wallet are automatically added as signers, so addSigners() is not needed\n     * for those.\n     */\n    async addSigners(...signers: PubKeyHash[]) {\n        this.noFacade(\"addSigners\");\n        \n        this.allNeededWitnesses.push(...signers);\n    }\n\n    async build(\n        this: StellarTxnContext<any>,\n        {\n            signers = [],\n            addlTxInfo = {\n                description: this.txnName ? \": \" + this.txnName : \"\",\n            },\n            beforeValidate,\n            paramsOverride,\n            expectError,\n        }: {\n            signers?: Address[];\n            addlTxInfo?: Pick<TxDescription<any, \"buildLater!\">, \"description\">;\n            beforeValidate?: (tx: Tx) => Promise<any> | any;\n            paramsOverride?: Partial<NetworkParams>;\n            expectError?: boolean;\n        } = {}\n    ): Promise<BuiltTcx> {\n        this.noFacade(\"build\");\n        console.timeStamp?.(`submit() txn ${this.txnName}`);\n        console.log(\"tcx build() @top\");\n\n        if (!this._validityPeriodSet) {\n            this.validFor(12 * 60 * 1000); // 12 minutes\n            // this.validFor(12 * 60 * 1000 * 60 * 24); // 12 days\n        }\n        let { description } = addlTxInfo;\n        if (description && !description.match(/^:/)) {\n            description = \": \" + description;\n        }\n        const {\n            actorContext: { wallet },\n        } = this;\n\n        let walletMustSign = false;\n        let tx: Tx;\n\n        const logger = this.logger;\n        if (wallet || signers.length) {\n            console.timeStamp?.(`submit(): findChangeAddr()`);\n            const changeAddress = await this.findChangeAddr();\n\n            console.timeStamp?.(`submit(): findAnySpareUtxos()`);\n            const spares = await this.findAnySpareUtxos();\n\n            const willSign = [...signers, ...this.allNeededWitnesses]\n                .map((addrOrPkh) => {\n                    if (addrOrPkh.kind == \"PubKeyHash\") {\n                        return addrOrPkh;\n                    } else if (addrOrPkh.kind == \"Address\") {\n                        if (addrOrPkh.era == \"Shelley\") {\n                            return addrOrPkh.spendingCredential.kind == \"PubKeyHash\"\n                                ? addrOrPkh.spendingCredential\n                                : undefined;\n                        } else {\n                            return undefined;\n                        }\n                    } else {\n                        return undefined;\n                    }\n                })\n                .filter((pkh) => !!pkh)\n                .flat(1) as PubKeyHash[];\n            console.timeStamp?.(`submit(): addSIgners()`);\n            this.txb.addSigners(...willSign);\n            const wHelper = wallet && makeWalletHelper(wallet);\n            const othersMustSign: PubKeyHash[] = [];\n            // determine whether we need to request signing from wallet.\n            // may involve adding signers to the txn\n            if (wallet && wHelper) {\n                for (const a of willSign) {\n                    if (await wHelper.isOwnAddress(a)) {\n                        walletMustSign = true;\n                    } else {\n                        othersMustSign.push(a);\n                    }\n                }\n                this.otherPartySigners = othersMustSign;\n                // if any inputs from the wallet were added as part of finalizing,\n                // add the wallet's signature to the txn\n                const inputs = this.txb.inputs;\n                if (!inputs) throw new Error(`no inputs in txn`);\n                for (const input of inputs) {\n                    if (!(await wHelper.isOwnAddress(input.address))) continue;\n                    this.allNeededWitnesses.push(input.address);\n                    walletMustSign = true;\n\n                    //@ts-expect-error on type-probe\n                    const pubKeyHash = input.address.pubKeyHash;\n\n                    if (pubKeyHash) {\n                        this.txb.addSigners(pubKeyHash);\n                    } else {\n                        //!!! todo: deal with \"native-script\" by traversing its\n                        //  struct and seeking the pubKeyHashes (or? other witnesses)\n                        //  that may be needed for signing.  That, or include the\n                        //  native-script information alongside the otherPartySigners,\n                        //  maybe as otherPartyScriptSigners or something.  The\n                        //  batch-submit-controller could take over the responsibility\n                        //  for finding signatures satisfactory for those.\n                    }\n                }\n            } else {\n                console.warn(\n                    \"txn build: no wallet/helper available for txn signining (debugging breakpoint available)\"\n                );\n                debugger; // eslint-disable-line no-debugger - keep for downstream troubleshooting\n            }\n            let capturedCosts: {\n                total: Cost;\n                [key: string]: Cost;\n            } = {\n                total: { cpu: 0n, mem: 0n },\n                slush: { cpu: 0n, mem: 0n },\n            };\n\n            const inputValues = this.inputs\n                .map((i) => i.value.assets)\n                .reduce((a, b) => a.add(b), makeAssets());\n            const outputValues = this.outputs\n                .map((o) => o.value.assets)\n                .reduce((a, b) => a.add(b), makeAssets());\n            const mintValues = this.txb.mintedTokens;\n            const netTxAssets = inputValues\n                .add(mintValues)\n                .subtract(outputValues);\n            if (!netTxAssets.isZero()) {\n                console.log(\n                    \"tx imbalance=\" + dumpAny(netTxAssets, this.networkParams)\n                );\n            }\n            try {\n                // the transaction can fail validation without throwing an error\n                tx = await this.txb.buildUnsafe({\n                    changeAddress,\n                    spareUtxos: spares,\n                    networkParams: {\n                        ...this.networkParams,\n                        ...paramsOverride,\n                    },\n                    logOptions: logger,\n                    beforeValidate,\n                    modifyExBudget: (txi, purpose, index, costs) => {\n                        capturedCosts[`${purpose} @${1 + index}`] = {\n                            ...costs,\n                        };\n\n                        // todo: use Ogmios API to just get the exact costs\n                        //   ... and report here when there is a diff.\n                        // Meanwhile, add a small amount (0.05 ADA) of padding\n                        //   ... to the computed costs, per involved script\n\n                        // temp? - + ~0.06 ada = 1.2x 0.05\n                        // const cpuSlush = 0n // BigInt(350_000_000n); // ~25k lovelace\n                        // const memSlush = 0n // BigInt(430_000n); // ~25k lovelace\n\n                        // without this, we **sometimes** get problems having enough\n                        // exBudget to cover the way the haskell node computes the\n                        // per-script execution costs.  Prevents \"out of budget\" errors\n                        // during script execution:\n                        const cpuSlush = BigInt(250_000_000n); // ~25k lovelace\n                        const memSlush = BigInt(50_000n); // ~25k lovelace\n\n                        //... but doesn't suffice to just add per-script slush:\n                        // this approach leads to escalating \"expected/actual fee\" messaging\n                        // const cpuSlush = BigInt( 350_000_000n * 13n / 10n); // ~25k lovelace/0.025 ADA\n                        // const memSlush = BigInt(430_000n * 13n / 10n); // ~25k lovelace/0.025 ADA\n\n                        capturedCosts.slush.cpu += cpuSlush;\n                        capturedCosts.slush.mem += memSlush;\n                        costs.cpu += cpuSlush;\n                        costs.mem += memSlush;\n\n                        capturedCosts.total.cpu += costs.cpu;\n                        capturedCosts.total.mem += costs.mem;\n                        if (\"minting\" == purpose) purpose = \"minting \";\n                        return costs;\n                    },\n                });\n                this._builtTx = tx;\n\n                this.txb.validToTime;\n\n                //!!! todo: come back to this later.  Blockfrost's endpoint for this\n                // seems to have some issues.  Ogmios itself seems to be fine.\n                //\n                // //@ts-expect-error on type-probe\n                // if (this.setup.network.evalTx) {\n                //     const partialTx = undoFeesFrom(tx)\n                //     console.log(bytesToHex(partialTx.toCbor()))\n                //     //@ts-expect-error on type-probe\n                //     const evalResult = await this.setup.network.evalTx(\n                //         partialTx\n                //     );\n                //     debugger\n                // }\n            } catch (e: any) {\n                // buildUnsafe shouldn't throw errors.\n\n                e.message +=\n                    \"; txn build failed (debugging breakpoint available)\\n\" +\n                    (netTxAssets.isZero()\n                        ? \"\"\n                        : \"tx imbalance=\" +\n                          dumpAny(netTxAssets, this.networkParams)) +\n                    `  inputs: ${dumpAny(this.inputs)}\\n` +\n                    `  outputs: ${dumpAny(this.outputs)}\\n` +\n                    `  mint: ${dumpAny(this.txb.mintedTokens)}\\n` +\n                    `  refInputs: ${dumpAny(this.txRefInputs)}\\n`;\n\n                logger.logError(`txn build failed: ${e.message}`);\n                if (tx!) logger.logPrint(dumpAny(tx!) as string);\n\n                logger.logError(\n                    `  (it shouldn't be possible for buildUnsafe to be throwing errors!)`\n                );\n                logger.flushError();\n\n                throw e;\n            }\n\n            if (tx.hasValidationError) {\n                const e = tx.hasValidationError;\n\n                //@ts-expect-error accessing the stack of something that might be a string instead\n                let heliosStack = e.stack?.split(\"\\n\") || undefined;\n                // locate the first TxImpl line in the stack trace.\n                // include it but remove remaining trace lines.\n                // heliosStack = heliosStack?.slice(\n                //     0, heliosStack.findIndex(l => l.match(/TxImpl/)) + 2\n                // ) || \"\"\n                // locate any lines like \"<helios>@at <anonymous>, [mkTv=<fn>, tvCharter=<fn>, mustFindInputRedeemer=<fn>, fromCip68Wrapper=<fn>, RelativeDelegateLink::tvAuthorityToken=<fn>, RelativeDelegateLink::acAuthorityToken=<fn>, RelativeDelegateLink::validatesUpdatedSettings=<fn>, RelativeDelegateLink::hasDelegateInput=<fn>, RelativeDelegateLink::hasValidOutput=<fn>, DelegateInput::genericDelegateActivity=<fn>], src/CapoHelpers.hl:761:9:0\"\n                // and transform it to a multi-line, indented function trace with the\n                // square-bracketed items indented to indicate the scope of the function they're provided to\n                heliosStack = heliosStack?.map((line: string) => {\n                    if (line.match(/<helios>@at/)) {\n                        line = line\n                            .replace(\n                                /<helios>@at /,\n                                \"   ... in helios function \"\n                            )\n                            .replace(\n                                /, \\[(.*)\\],/,\n                                (_, bracketed) => ``\n                                // ` with scope [\\n        ${\n                                //     bracketed.replace(/, /g, \",\\n        \")\n                                // }\\n      ]`\n                            );\n                    }\n                    return line;\n                });\n                debugger; // eslint-disable-line no-debugger - keep for downstream troubleshooting\n                const scriptContext =\n                    \"string\" == typeof e ? undefined : e.scriptContext;\n                logger.logError(\n                    `tx validation failure: \\n  ‚ùå ${\n                        //@ts-expect-error\n                        tx.hasValidationError.message || tx.hasValidationError\n                    }\\n` + (heliosStack?.join(\"\\n\") || \"\")\n                );\n                logger.flush();\n                // TODO: notify the currentBatch and let it reveal the script-context\n                // and tx-cbor.  KEEP THE console LOGGING for now ALSO.\n\n                const ctxCbor = scriptContext?.toCbor();\n                const cborHex = ctxCbor ? bytesToHex(ctxCbor) : \"\";\n                if (!expectError) {\n                    console.log(\n                        cborHex\n                            ? \"------------------- failed ScriptContext as cbor-hex -------------------\\n\" +\n                                  cborHex +\n                                  \"\\n\"\n                            : \"\",\n                        \"------------------- failed tx as cbor-hex -------------------\\n\" +\n                            bytesToHex(tx.toCbor()),\n                        \"\\n------------------^ failed tx details ^------------------\\n\" +\n                            \"(debugging breakpoint available)\"\n                    );\n                }\n            }\n\n            // tx.body.fee = tx.body.fee + BigInt(250_000n); // 25k lovelace\n            return {\n                tx,\n                willSign,\n                walletMustSign,\n                wallet,\n                wHelper,\n                costs: capturedCosts,\n            };\n        } else {\n            throw new Error(\"no 'actorContext.wallet'; can't make  a txn\");\n        }\n    }\n    log(...msgs: string[]) {\n        if (msgs.length > 1) {\n            debugger;\n            throw new Error(`no multi-arg log() calls`);\n        }\n        this.logger.logPrint(msgs[0]);\n        return this;\n    }\n    flush() {\n        this.logger.flush();\n        return this;\n    }\n    finish() {\n        this.logger.finish();\n        return this;\n    }\n\n    /**\n     * Submits the current transaction and any additional transactions in the context.\n     * @remarks\n     * To submit only the current transaction, use the `submit()` method.\n     *\n     * Uses the TxBatcher to create a new batch of transactions.  This new batch\n     * overlays a TxChainBuilder on the current network-client, using that facade\n     * to provide utxos for chained transactions in the batch.\n     *\n     * The signers array can be used to add additional signers to the transaction, and\n     * is passed through to the submit() for the current txn only; it is not used for\n     * any additional transactions.\n     *\n     * The beforeSubmit, onSubmitted callbacks are used for each additional transaction.\n     *\n     * beforeSubmit can be used to notify the user of the transaction about to be submitted,\n     * and can also be used to add additional signers to the transaction or otherwise modify\n     * it (by returning the modified transaction).\n     *\n     * onSubmitted can be used to notify the user that the transaction has been submitted,\n     * or for logging or any other post-submission processing.\n     */\n    async submitAll(this: StellarTxnContext<any>, options: SubmitOptions = {}) {\n        const currentBatch = this.currentBatch;\n        const hasOpenBatch = currentBatch?.isOpen;\n        // if (hasOpenBatch) {\n        //     console.warn(\n        //         `‚ö†Ô∏è  submitAll(): detected overlapping txn batches... \\n` +\n        //             `  ... that MIGHT be a developer error on our part.\\n` +\n        //             `  ... or, you might need to add your transaction to an existing batch \\n` +\n        //             `      (use otherTcx.includeAddlTxn(...))\\n` +\n        //             `  ... or, you might need to ensure you're waiting for an existing batch \\n` +\n        //             `      to finish (monitor setup.txBatcher.current for batch:confirmed)\\n` +\n        //             `\\nFinally, you might have an advanced use-case for building multiple \\n` +\n        //             `independent batches of transactions that don't need tx chaining between them. \\n\\n` +\n        //             `Please be welcome to log an issue with the project's support desk, \\n` +\n        //             `... and we'll see what we can do to help.`\n        //         );\n        //     throw new Error(`can't submitAll() with an existing open tx batch (wait for the existing batch to finish first`);\n        // }\n\n        //!!! remove because it's already done in the constructor?\n        // debugger\n        // if (!currentBatch || currentBatch.isConfirmationComplete) {\n        //     this.setup.txBatcher.rotate(this.setup.chainBuilder);\n        // }\n\n        // if (!this.setup.isTest && !this.setup.chainBuilder) {\n        //     if (currentBatch.chainBuilder) {\n        //         // backfills the chainbuilder from the one auto-populated\n        //         // during `get TxBatcher.current()`\n        //         this.setup.chainBuilder = currentBatch.chainBuilder;\n        //     } else {\n        //         this.setup.chainBuilder = makeTxChainBuilder(\n        //             this.setup.network\n        //         );\n        //     }\n        // }\n        //!!! ^^^ remove?\n\n        return this.buildAndQueueAll(options).then((batch) => {\n            return batch;\n            //            return currentBatch.$signAndSubmitAll().then(() => true);\n        });\n    }\n\n    /**\n     * augments a transaction context with a type indicator\n     * that it has additional transactions to be submitted.\n     * @public\n     * @remarks\n     * The optional argument can also be used to include additional\n     * transactions to be chained after the current transaction.\n     */\n    withAddlTxns<TCX extends StellarTxnContext<anyState>>(\n        this: TCX,\n        addlTxns: Record<string, TxDescription<any, \"buildLater!\">> = {}\n    ): hasAddlTxns<TCX> {\n        //@ts-expect-error\n        this.state.addlTxns = this.state.addlTxns || {};\n\n        for (const [name, txn] of Object.entries(addlTxns)) {\n            this.includeAddlTxn(name, txn);\n        }\n        return this as any;\n    }\n\n    async buildAndQueueAll(\n        this: StellarTxnContext<any>,\n        options: SubmitOptions = {}\n    ) {\n        const {\n            addlTxInfo = {\n                description: this.txnName\n                    ? this.txnName\n                    : \"‚Äπunnamed tx‚Ä∫\",\n                id: this.id,\n                tcx: this,\n            },\n            ...generalSubmitOptions\n        } = options;\n        if (options.paramsOverride) {\n            console.warn(\n                \"‚ö†Ô∏è  paramsOverride can be useful for extreme cases \\n\" +\n                    \"of troubleshooting tx execution by submitting an oversized tx \\n\" +\n                    \"with unoptimized contract scripts having diagnostic print/trace calls\\n\" +\n                    \"to a custom preprod node having overloaded network params, thus allowing \\n\" +\n                    \"such a transaction to be evaluated end-to-end by the Haskell evaluator using \\n\" +\n                    \"the cardano-node's script-budgeting mini-protocol.\\n\\n\" +\n                    \"This will cause problems for regular transactions (such as requiring very large collateral)\" +\n                    \"Be sure to remove any params override if you're not dealing with \\n\" +\n                    \"one of those very special situations. \\n\"\n            );\n            debugger;\n        }\n\n        if (this.isFacade == false) {\n            return this.buildAndQueue({\n                ...generalSubmitOptions,\n                addlTxInfo,\n            }).then(() => {\n                if (this.state.addlTxns) {\n                    // this gives early registration of nested txns from top-level txns\n                    console.log(\n                        `üéÑ‚õÑüéÅ ${this.id}   -- B&QA - registering addl txns`\n                    );\n                    return this.queueAddlTxns(options).then(() => {\n                        return this.currentBatch;\n                    });\n\n                    // .then((x) => {\n                    //     return this.currentBatch.$signAndSubmitAll()\n                    //     // this.setup.chainBuilder = undefined;\n                    //     // return x;\n                    // });\n                }\n                return this.currentBatch\n            });\n        } else if (this.state.addlTxns) {\n            if (this.isFacade) {\n                this.currentBatch.$txInfo(this.id)?.transition(\"isFacade\");\n            }\n\n            // this gives early registration of nested txns from top-level txns\n            console.log(\n                `üéÑ‚õÑüéÅ ${this.id}   -- B&QA - registering txns in facade`\n            );\n            return this.queueAddlTxns(generalSubmitOptions).then(() => {\n                return this.currentBatch;\n            });\n        }\n        console.warn(`‚ö†Ô∏è  submitAll(): no txns to queue/submit`, this);\n        throw new Error(\n            `unreachable? -- nothing to do for submitting this tcx`\n        );\n    }\n\n    get currentBatch() {\n        return this.setup.txBatcher.current;\n    }\n\n    /**\n     * Submits only the current transaction.\n     * @remarks\n     * To also submit additional transactions, use the `submitAll()` method.\n     */\n    async buildAndQueue(\n        this: StellarTxnContext<any>,\n        submitOptions: SubmitOptions = {}\n    ) {\n        let {\n            signers = [],\n            addlTxInfo,\n            paramsOverride,\n            expectError,\n            beforeError,\n            beforeValidate,\n            whenBuilt,\n            fixupBeforeSubmit,\n            onSubmitError,\n            onSubmitted,\n        } = submitOptions;\n\n        // console.log(\"buildAndQueue with setup\", this.setup);\n        this.noFacade(\"submit\");\n        if (!addlTxInfo) {\n            debugger;\n            throw new Error(`expecting addlTxInfo to be passed`);\n            addlTxInfo = {\n                description: this.txnName\n                    ? \": \" + this.txnName\n                    : \"‚Äπunnamed tx‚Ä∫\",\n                id: nanoid(5),\n                tcx: this,\n            };\n        }\n        const {\n            logger,\n            setup: { network },\n        } = this;\n        const {\n            tx,\n            willSign,\n            walletMustSign,\n            wallet,\n            wHelper,\n            costs = {\n                total: { cpu: 0n, mem: 0n },\n            },\n        } = await this.build({\n            signers,\n            paramsOverride,\n            addlTxInfo,\n            beforeValidate,\n            expectError,\n        });\n        let { description, id } = addlTxInfo;\n        if (!id) {\n            id = addlTxInfo.id = this.id;\n        }\n        const addlTxInfo2: TxDescription<any, \"buildLater!\"> = {\n            ...addlTxInfo,\n        } as any;\n\n        const txStats = {\n            costs: costs,\n            wallet: wallet,\n            walletMustSign,\n            wHelper,\n            willSign,\n        };\n        const errMsg =\n            tx.hasValidationError && tx.hasValidationError.toString();\n        if (errMsg) {\n            // console.log(`submit(): FAILED tx.validate(): ${errMsg}`);\n            // console.profileEnd?.(\"tx.validate()\");\n            // @ts-ignore\n            // if (console.profileEnd) {\n            //     debugger;\n            // }\n\n            logger.logPrint(`‚ö†Ô∏è  txn validation failed: ${description}\\n${errMsg}\\n`);\n            logger.logPrint(this.dump(tx));\n            this.emitCostDetails(tx, costs);\n            logger.flush();\n            logger.logError(`FAILED submitting tx: ${description}`);\n            logger.logPrint(errMsg);\n            if (expectError) {\n                logger.logPrint(\n                    `\\n\\nüí£üéâ üí£üéâ üéâ üéâ transaction failed (as expected)`\n                );\n            }\n\n            const txErrorDescription: TxDescriptionWithError = {\n                ...addlTxInfo2,\n                tcx: this,\n                error: errMsg,\n                tx,\n                stats: txStats,\n                options: submitOptions,\n                txCborHex: bytesToHex(tx.toCbor()),\n            };\n            this.currentBatch.txError(txErrorDescription);\n\n            let errorHandled;\n            if (beforeError) {\n                errorHandled = await beforeError(txErrorDescription);\n            }\n            logger.flushError();\n            if (\n                errMsg.match(\n                    /multi:Minting: only dgData activities ok in mintDgt/\n                )\n            ) {\n                console.log(\n                    `‚ö†Ô∏è  mint delegate for multiple activities should be given delegated-data activities, not the activities of the delegate`\n                );\n            }\n            if (!errorHandled) {\n                debugger;\n                throw new Error(errMsg);\n            }\n        }\n        // const elapsed = t2 - t1;\n        // console.log(\n        //     // stopwatch emoji: ‚è±\n        //     `          :::::::::: ‚è± tx validation time: ${elapsed}ms ‚è±`\n        // );\n        // result: validations for non-trivial txns can take ~800+ ms\n        //  - validations with simplify:true, ~250ms - but ...`\n        //    ... with elided error messages that don't support negative-testing very well\n        for (const pkh of willSign) {\n            if (!pkh) continue;\n            if (tx.body.signers.find((s) => pkh.isEqual(s))) continue;\n            throw new Error(\n                `incontheeivable! all signers should have been added to the builder above`\n            );\n        }\n\n        const txDescr: TxDescription<any, \"built\"> = {\n            ...addlTxInfo2,\n            tcx: this,\n            tx,\n            txId: tx.id(),\n            options: submitOptions,\n            stats: txStats,\n            txCborHex: bytesToHex(tx.toCbor()),\n        };\n        const { currentBatch } = this;\n        const txState = currentBatch.$txStates[id];\n\n        logger.logPrint(`tx transcript: ${description}\\n`);\n        logger.logPrint(this.dump(tx));\n        this.emitCostDetails(tx, costs);\n        logger.logPrint(`end: ${description}`);\n        logger.flush();\n\n        // hands off wallet signing & tx-completion to the batcher.\n        console.timeStamp?.(`tx: add to current-tx-batch`);\n        currentBatch.$addTxns(txDescr);\n        this.setup.chainBuilder?.with(txDescr.tx);\n        await whenBuilt?.(txDescr);\n    }\n    emitCostDetails(tx: Tx, costs: { total: Cost; [key: string]: Cost }) {\n        const { logger } = this;\n        const {\n            maxTxExCpu,\n            maxTxExMem,\n            maxTxSize,\n            //@ts-expect-error on our synthetic attributes\n            origMaxTxSize = maxTxSize,\n            //@ts-expect-error on our synthetic attributes\n            origMaxTxExMem = maxTxExMem,\n            //@ts-expect-error on our synthetic attributes\n            origMaxTxExCpu = maxTxExCpu,\n            exCpuFeePerUnit,\n            exMemFeePerUnit,\n            txFeePerByte,\n            txFeeFixed,\n        } = this.networkParams;\n        const oMaxSize: number = origMaxTxSize;\n        const oMaxMem: number = origMaxTxExMem;\n        const oMaxCpu: number = origMaxTxExCpu;\n\n        const { total, ...otherCosts } = costs;\n        const txSize = tx.calcSize();\n        const txFeeCalc = Number(tx.calcMinFee(this.networkParams));\n        const txFee = tx.body.fee;\n\n        const cpuFee = BigInt((Number(total.cpu) * exCpuFeePerUnit).toFixed(0));\n        const memFee = BigInt((Number(total.mem) * exMemFeePerUnit).toFixed(0));\n        const sizeFee = BigInt(txSize * txFeePerByte);\n        const nCpu = Number(total.cpu);\n        const nMem = Number(total.mem);\n        let refScriptSize = 0;\n        for (const anyInput of [...tx.body.inputs, ...tx.body.refInputs]) {\n            const refScript = anyInput.output.refScript;\n            if (refScript) {\n                const scriptSize = refScript.toCbor().length;\n                refScriptSize += scriptSize;\n            }\n        }\n        let multiplier = 1.0;\n        let refScriptsFee = 0n;\n        let refScriptsFeePerByte = this.networkParams.refScriptsFeePerByte;\n        let refScriptCostDetails: string[] = [];\n        const tierSize = 25600;\n        let alreadyConsumed = 0;\n        for (\n            let tier = 0;\n            tier * tierSize < refScriptSize;\n            tier += 1, multiplier *= 1.2\n        ) {\n            const topOfThisTier = (1 + tier) * tierSize;\n            const consumedThisTier = Math.min(\n                tierSize,\n                refScriptSize - alreadyConsumed\n            );\n            alreadyConsumed += consumedThisTier;\n            const feeThisTier = Math.round(\n                consumedThisTier * multiplier * refScriptsFeePerByte\n            );\n            refScriptsFee += BigInt(feeThisTier);\n            refScriptCostDetails.push(\n                `\\n      -- refScript tier${\n                    1 + tier\n                } (${consumedThisTier} √ó ${multiplier}) √ó${refScriptsFeePerByte} = ${lovelaceToAda(\n                    feeThisTier\n                )}`\n            );\n        }\n\n        // for (let i = 0; i < refScriptSize; i += 25600, multiplier *= 1.2) {\n        //     const chunkSize = Math.min(25600, refScriptSize - i)\n        //     const feeThisChunk = chunkSize * multiplier * refScriptsFeePerByte\n        //     refScriptsFee += BigInt(feeThisChunk)\n        //     refScriptCostDetails.push(\n        //         `\\n      -- refScript tier${i} (${chunkSize} bytes) √ó ${multiplier} = ${lovelaceToAda(feeThisChunk)}`\n        //     )\n        // }\n        const fixedTxFeeBigInt = BigInt(txFeeFixed);\n\n        const remainderUnaccounted =\n            txFee -\n            cpuFee -\n            memFee -\n            sizeFee -\n            fixedTxFeeBigInt -\n            refScriptsFee;\n\n        if (nCpu > oMaxCpu || nMem > oMaxMem || txSize > oMaxSize) {\n            logger.logPrint(\n                \"üî•üî•üî•üî•  THIS TX EXCEEDS default (overridden in test env) limits on network params  üî•üî•üî•üî•\\n\" +\n                    `  -- cpu ${intWithGrouping(nCpu)} = ${(\n                        (100 * nCpu) /\n                        oMaxCpu\n                    ).toFixed(1)}% of ${intWithGrouping(\n                        oMaxCpu\n                    )} (patched to ${intWithGrouping(maxTxExCpu)})\\n` +\n                    `  -- mem ${nMem} = ${((100 * nMem) / oMaxMem).toFixed(\n                        1\n                    )}% of ${intWithGrouping(\n                        oMaxMem\n                    )} (patched to ${intWithGrouping(maxTxExMem)})\\n` +\n                    `  -- tx size ${intWithGrouping(txSize)} = ${(\n                        (100 * txSize) /\n                        oMaxSize\n                    ).toFixed(1)}% of ${intWithGrouping(\n                        oMaxSize\n                    )} (patched to ${intWithGrouping(maxTxSize)})\\n`\n            );\n        }\n        const scriptBreakdown =\n            Object.keys(otherCosts).length > 0\n                ? `\\n    -- per script (with % blame for actual costs):` +\n                  Object.entries(otherCosts)\n                      .map(\n                          ([key, { cpu, mem }]) =>\n                              `\\n      -- ${key}: cpu ${lovelaceToAda(\n                                  Number(cpu) * exCpuFeePerUnit\n                              )} = ${(\n                                  (Number(cpu) / Number(total.cpu)) *\n                                  100\n                              ).toFixed(1)}%, mem ${lovelaceToAda(\n                                  Number(mem) * exMemFeePerUnit\n                              )} = ${(\n                                  (Number(mem) / Number(total.mem)) *\n                                  100\n                              ).toFixed(1)}%`\n                      )\n                      .join(\"\")\n                : \"\";\n\n        logger.logPrint(\n            `costs: ${lovelaceToAda(txFee)}` +\n                `\\n  -- fixed fee = ${lovelaceToAda(txFeeFixed)}` +\n                `\\n  -- tx size fee = ${lovelaceToAda(sizeFee)}` +\n                ` (${intWithGrouping(txSize)} bytes = ${(\n                    Number((1000 * txSize) / oMaxSize) / 10\n                ).toFixed(1)}% of tx size limit)` +\n                `\\n  -- refScripts fee = ${lovelaceToAda(refScriptsFee)}` +\n                refScriptCostDetails.join(\"\") +\n                `\\n  -- scripting costs` +\n                `\\n    -- cpu units ${intWithGrouping(total.cpu)}` +\n                ` = ${lovelaceToAda(cpuFee)}` +\n                ` (${(\n                    Number((1000n * total.cpu) / BigInt(oMaxCpu)) / 10\n                ).toFixed(1)}% of cpu limit/tx)` +\n                `\\n    -- memory units ${intWithGrouping(total.mem)}` +\n                ` = ${lovelaceToAda(memFee)}` +\n                ` (${(\n                    Number((1000n * total.mem) / BigInt(oMaxMem)) / 10\n                ).toFixed(1)}% of mem limit/tx)` +\n                scriptBreakdown +\n                `\\n  -- remainder ${lovelaceToAda(\n                    remainderUnaccounted\n                )} unaccounted-for`\n        );\n    }\n\n    /**\n     * Executes additional transactions indicated by an existing transaction\n     * @remarks\n     *\n     * During the off-chain txn-creation process, additional transactions may be\n     * queued for execution.  This method is used to register those transactions,\n     * along with any chained transactions THEY may trigger.\n     *\n     * The TxBatcher and batch-controller classes handle wallet-signing\n     * and submission of the transactions for execution.\n     * @public\n     **/\n    async queueAddlTxns(\n        this: hasAddlTxns<any>,\n        pipelineOptions?: TxPipelineOptions\n    ) {\n        const { addlTxns } = this.state;\n        if (!addlTxns) return;\n\n        // return this.submitTxns(Object.values(addlTxns), callback);\n        return this.submitTxnChain({\n            ...pipelineOptions,\n            txns: Object.values(addlTxns),\n        });\n    }\n\n    /**\n     * Resolves a list of tx descriptions to full tcx's, without handing any of their\n     * any chained/nested txns.\n     * @remarks\n     * if submitEach is provided, each txn will be submitted as it is resolved.\n     * If submitEach is not provided, then the network must be capable of tx-chaining\n     * use submitTxnChain() to submit a list of txns with chaining\n     */\n    async resolveMultipleTxns(\n        txns: TxDescription<any, \"buildLater!\">[],\n        pipelineOptions?: TxPipelineOptions\n    ) {\n        //         as [\n        //         string,\n        //         TxDescription<any, \"buildLater!\">\n        //     ][]\n\n        for (const [txName, addlTxInfo] of Object.entries(txns)) {\n            const { id } = addlTxInfo;\n            let txTracker = this.currentBatch.$txInfo(id);\n            if (!txTracker) {\n                this.currentBatch.$addTxns(addlTxInfo);\n                txTracker = this.currentBatch.$txInfo(id);\n            }\n        }\n        /* yield to allow rendering */\n        await new Promise((res) => setTimeout(res, 5));\n\n        for (const [txName, addlTxInfo] of Object.entries(txns)) {\n            const { id, depth, parentId } = addlTxInfo;\n            let txTracker = this.currentBatch.$txInfo(id);\n\n            txTracker.$transition(\"building\");\n            /* yield to allow rendering */\n            await new Promise((res) => setTimeout(res, 5));\n\n            // IS resolving.  WILL BE resolved\n            const txInfoResolved: TxDescription<any, \"resolved\"> =\n                addlTxInfo as any;\n            const { txName, description } = txInfoResolved;\n            let alreadyPresent: TxNotNeededError | undefined = undefined;\n            console.log(\"  -- before: \" + description);\n            const tcx = (\n                \"function\" == typeof addlTxInfo.mkTcx\n                    ? await (async () => {\n                          console.log(\n                              \"  creating TCX just in time for: \" + description\n                          );\n\n                          const tcx = await addlTxInfo.mkTcx();\n                          tcx.parentId = parentId || \"\";\n                          tcx.depth = depth;\n                          if (id) {\n                              this.currentBatch.changeTxId(id, tcx.id);\n                              txInfoResolved.id = tcx.id;\n                          } else {\n                              addlTxInfo.id = tcx.id;\n                              console.warn(\n                                  `expected id to be set on addlTxInfo; falling back to JIT-generated id in new tcx`\n                              );\n                          }\n                          return tcx;\n                      })().catch((e) => {\n                          if (e instanceof TxNotNeededError) {\n                              alreadyPresent = e;\n                              const tcx = new StellarTxnContext(\n                                  this.setup\n                              ).withName(\n                                  `addlTxInfo already present: ${description}`\n                              );\n                              tcx.alreadyPresent = alreadyPresent;\n                              return tcx;\n                          }\n                          throw e;\n                      })\n                    : (() => {\n                          console.log(\n                              \"  ---------------- warning!!!! addlTxInfo is already built!\"\n                          );\n                          debugger;\n                          throw new Error(\" unreachable - right?\");\n                          return addlTxInfo.tcx;\n                      })()\n            ) as StellarTxnContext;\n            if (\"undefined\" == typeof tcx) {\n                throw new Error(\n                    `no txn provided for addlTx ${txName || description}`\n                );\n            }\n            txInfoResolved.tcx = tcx;\n            if (tcx.alreadyPresent) {\n                console.log(\n                    \"  -- tx effects are already present; skipping: \" +\n                        txName || description\n                );\n                this.currentBatch.$addTxns(txInfoResolved);\n                continue;\n            }\n\n            const replacementTcx =\n                (pipelineOptions?.fixupBeforeSubmit &&\n                    ((await pipelineOptions.fixupBeforeSubmit(\n                        txInfoResolved\n                    )) as typeof replacementTcx | boolean)) ||\n                tcx;\n            if (false === replacementTcx) {\n                console.log(\"callback cancelled txn: \", txName);\n                continue;\n            }\n            if (replacementTcx !== true && replacementTcx !== tcx) {\n                console.log(\n                    `callback replaced txn ${txName} with a different txn: `,\n                    dumpAny(replacementTcx)\n                );\n            }\n\n            // if the callback returns true or void, we execute the txn as already resolved.\n            // if it returns an alternative txn, we use that instead.\n            const effectiveTcx: StellarTxnContext =\n                true === replacementTcx ? tcx : replacementTcx || tcx;\n            // console.log(\"   -- submitTxns: -> txn: \", txName, description);\n            // console.log(\"   ----> effective tx\", effectiveTcx);\n\n            txInfoResolved.tcx = effectiveTcx;\n\n            //!!! was just buildAndQueue, but that was executing\n            // in \"breadth-first\" order (good for registration)\n            //    (i.e. in consecutive layers of discovered txns)\n            // ... instead of executing depth-first (good for tx-chaining).\n            // We want all txns to be registered as soon as they're\n            //   known to be a tx to be made.  But for each such tx,\n            //   we want its chained txns to be executed BEFORE moving on\n            //   to build any of those other registered txns.\n\n            // //@ts-expect-error\n            // if (this.setup.stopped) return;\n            // if (description == \"+ on-chain refScript: minter\") {\n            //     //@ts-expect-error\n            //     this.setup.stopped = true\n            //     break\n            // }\n            await effectiveTcx.buildAndQueueAll({\n                ...pipelineOptions,\n                addlTxInfo: txInfoResolved,\n            });\n            // console.log(\"   -- submitTxns: <- txn: \", txName, description);\n            // m oved into submit()\n            // if (callbacks?.onSubmitted) {\n            // console.log(\"   -- submitTxns: triggering onSubmit callback\");\n            // await callbacks.onSubmitted(txInfoResolved);\n            // console.log(\"   -- submitTxns: onSubmitted callback completed\");\n            // }\n        }\n    }\n\n    /**\n     * To add a script to the transaction context, use `attachScript`\n     *\n     * @deprecated - invalid method name; use `addScriptProgram()` or capo's `txnAttachScriptOrRefScript()` method\n     **/\n    addScript() {}\n\n    async submitTxnChain(\n        options: {\n            txns?: TxDescription<any, \"buildLater!\">[];\n        } & TxPipelineOptions = {\n            //@ts-expect-error because the type of this context doesn't\n            //   guarantee the presence of addlTxns.  But it might be there!\n            txns: this.state.addlTxns || [],\n        }\n    ) {\n        //@ts-expect-error on probing for a maybe-undefined entry:\n        const addlTxns = this.state.addlTxns;\n\n        const { txns, onSubmitError } = options;\n        const newTxns: TxDescription<any, \"buildLater!\">[] =\n            txns || addlTxns || [];\n        let chainedTxns: TxDescription<any, \"buildLater!\">[] = [];\n\n        const txChainSubmitOptions: TxPipelineOptions = {\n            onSubmitError,\n            // txns,  // see newTxns\n            fixupBeforeSubmit: (txinfo) => {\n                //   ... in regular execution environment, this is a no-op by default\n                options.fixupBeforeSubmit?.(txinfo);\n            },\n            whenBuilt: async (txinfo) => {\n                const { id: parentId, tx } = txinfo;\n                const stackedPromise = options.whenBuilt?.(txinfo);\n                const more: Record<string, TxDescription<any, \"buildLater!\">> =\n                    //@ts-expect-error on optional prop\n                    txinfo.tcx.state.addlTxns || {};\n                console.log(\"  ‚úÖ \" + txinfo.description);\n                const moreTxns = Object.values(more);\n\n                for (const nested of moreTxns) {\n                    nested.parentId = parentId;\n                }\n                console.log(\n                    `üéÑ‚õÑüéÅ ${parentId}   -- registering nested txns ASAP`\n                );\n                this.currentBatch.$addTxns(moreTxns);\n\n                /* yield to allow rendering */\n                await new Promise((res) => setTimeout(res, 5));\n\n                // if (moreTxns.length) {\n                //     // gathers the next layer of txns to be resolved & built\n                //     chainedTxns.push(...moreTxns);\n                //     console.log(\n                //         \" + chained txns: \\n\" +\n                //             moreTxns\n                //                 .map((t) => `   üü© ${t.description}\\n`)\n                //                 .join(\"\")\n                //     );\n                // }\n                return stackedPromise;\n            },\n            onSubmitted: (txinfo) => {\n                //@ts-expect-error triggering the test-network-emulator's tick\n                //   ... in regular execution environment, this is a no-op by default\n                this.setup.network.tick?.(1);\n            },\n        };\n        let chainDepth = 0;\n        const isolatedTcx = new StellarTxnContext(this.setup);\n        console.log(\"üêùüòæüêªü¶Ä\");\n        isolatedTcx.id = this.id;\n        console.log(\n            \"at d=0: submitting addl txns: \\n\" +\n                newTxns.map((t) => `  üü© ${t.description}\\n`).join(\"\")\n        );\n\n        const t = isolatedTcx.resolveMultipleTxns(\n            newTxns,\n            txChainSubmitOptions\n        );\n\n        const allPromises = [] as Promise<any>[];\n        chainDepth = 0;\n        allPromises.push(t);\n\n        await t;\n        return;\n        while (chainedTxns.length) {\n            const nextChain: typeof chainedTxns = [];\n            chainDepth++;\n\n            for (const { tcx } of chainedTxns) {\n                // if (tcx.state) {\n                //     debugger\n                // } else {\n                //     const { addlTxns: nestedAddlTxns } = (tcx.state || {}) as {\n                //         addlTxns?: Record<\n                //             string,\n                //             TxDescription<any, \"buildLater!\">\n                //         >;\n                //     };\n                //     if (!nestedAddlTxns) continue;\n                //     nextChain.push(...Object.values(nestedAddlTxns));\n                // }\n            }\n            console.log(\n                ` üêûüêûüêûüêû submitting ${chainedTxns.length} transactions at depth ${chainDepth}`\n            );\n            console.log(\n                chainedTxns.map((t) => `  üü© ${t.description}\\n`).join(\"\")\n            );\n            const thisBatch = chainedTxns;\n            chainedTxns = [];\n\n            const isolatedTcx = new StellarTxnContext(this.setup);\n            isolatedTcx.id = this.id;\n\n            const t = isolatedTcx.resolveMultipleTxns(\n                thisBatch,\n                txChainSubmitOptions\n            );\n            allPromises.push(t);\n            await t;\n            console.log(\n                \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nSubmitted transactions at depth \" +\n                    chainDepth\n            );\n            chainedTxns = nextChain;\n        }\n        return Promise.all(allPromises);\n    }\n}\n\n// /**\n//  * Given a fully built transaction, returns a new transaction with the fees removed\n//  * @remarks\n//  * The result is suitable for submission to Ogmios' tx-evaluation endpoint\n//  * that uses Haskell's CEK interpreter to give us the costs for the transaction.\n//  *\n//  * TODO: use this to cross-check Helios' CEK budgeting and ensure we\n//  * make a txn that will be accepted by the network\n//  */\n// export function undoFeesFrom(\n//     t: Tx,\n//     { isValid: validity = true }: { isValid?: boolean } = {}\n// ): Tx {\n//     const tb = t.body;\n//     const pTxB = makeTxBody({\n//         dcerts: tb.dcerts,\n//         fee: BigInt(0),\n//         minted: tb.minted,\n//         refInputs: tb.refInputs,\n//         inputs: tb.inputs,\n//         outputs: tb.outputs,\n//         signers: tb.signers,\n//         withdrawals: tb.withdrawals,\n//         collateral: tb.collateral,\n//         collateralReturn: tb.collateralReturn,\n//         firstValidSlot: tb.firstValidSlot,\n//         lastValidSlot: tb.lastValidSlot,\n//         metadataHash: tb.metadataHash,\n//         scriptDataHash: tb.scriptDataHash,\n//         totalCollateral: tb.totalCollateral,\n//     });\n\n//     const txW = makeTxWitnesses({\n//         ...t.witnesses,\n//         redeemers: t.witnesses.redeemers.map((r) => {\n//             switch (r.kind) {\n//                 case \"TxCertifyingRedeemer\":\n//                     return makeTxCertifyingRedeemer(r.dcertIndex, r.data);\n//                 case \"TxMintingRedeemer\":\n//                     return makeTxMintingRedeemer(r.policyIndex, r.data);\n//                 case \"TxSpendingRedeemer\":\n//                     return makeTxSpendingRedeemer(r.inputIndex, r.data);\n//                 case \"TxRewardingRedeemer\":\n//                     return makeTxRewardingRedeemer(r.withdrawalIndex, r.data);\n//             }\n//         }),\n//     });\n//     return makeTx(pTxB, txW, validity, t.metadata);\n// }\n","// local copy of picocolors.js\n// guards against supply chain attacks\n// original ISC license preserved:\n\n// ISC License\n\n// Copyright (c) 2021-2024 Oleksii Raspopov, Kostiantyn Denysov, Anton Verinov\n\n// Permission to use, copy, modify, and/or distribute this software for any\n// purpose with or without fee is hereby granted, provided that the above\n// copyright notice and this permission notice appear in all copies.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n\n\n\nlet p = typeof process == \"undefined\" ? {\n    platform: \"browser\",\n    argv: [] as string[],\n    env: {} as Record<string, string>\n} : process, argv = p.argv, env = p.env\nlet isColorSupported =\n\t!(!!env.NO_COLOR || argv.includes(\"--no-color\")) &&\n\t(!!env.FORCE_COLOR || argv.includes(\"--color\") || \n        p.platform === \"win32\" || \n        (\n            true \n        //  && (p.stdout || {}).isTTY \n        // && env.TERM !== \"dumb\"\n        ) || \n        !!env.CI\n        )\n\nlet formatter = (open, close, replace = open) => {\n    const f = (input) => {\n\t\tlet string = \"\" + input, index = string.indexOf(close, open.length)\n\t\treturn ~index ? open + replaceClose(string, close, replace, index) + close : open + string + close\n\t}\n    f.start = open\n    f.close = close\n    return f\n}\n\nlet replaceClose = (string, close, replace, index) => {\n\tlet result = \"\", cursor = 0\n\tdo {\n\t\tresult += string.substring(cursor, index) + replace\n\t\tcursor = index + close.length\n\t\tindex = string.indexOf(close, cursor)\n\t} while (~index)\n\treturn result + string.substring(cursor)\n}\n\nlet createColors = (enabled = isColorSupported) => {\n\tlet f = enabled ? formatter : () => String\n\treturn {\n\t\tisColorSupported: enabled,\n\t\treset: f(\"\\x1b[0m\", \"\\x1b[0m\"),\n\t\tbold: f(\"\\x1b[1m\", \"\\x1b[22m\", \"\\x1b[22m\\x1b[1m\"),\n\t\tdim: f(\"\\x1b[2m\", \"\\x1b[22m\", \"\\x1b[22m\\x1b[2m\"),\n\t\titalic: f(\"\\x1b[3m\", \"\\x1b[23m\"),\n\t\tunderline: f(\"\\x1b[4m\", \"\\x1b[24m\"),\n\t\tinverse: f(\"\\x1b[7m\", \"\\x1b[27m\"),\n\t\thidden: f(\"\\x1b[8m\", \"\\x1b[28m\"),\n\t\tstrikethrough: f(\"\\x1b[9m\", \"\\x1b[29m\"),\n\n\t\tblack: f(\"\\x1b[30m\", \"\\x1b[39m\"),\n\t\tred: f(\"\\x1b[31m\", \"\\x1b[39m\"),\n\t\tgreen: f(\"\\x1b[32m\", \"\\x1b[39m\"),\n\t\tyellow: f(\"\\x1b[33m\", \"\\x1b[39m\"),\n\t\tblue: f(\"\\x1b[34m\", \"\\x1b[39m\"),\n\t\tmagenta: f(\"\\x1b[35m\", \"\\x1b[39m\"),\n\t\tcyan: f(\"\\x1b[36m\", \"\\x1b[39m\"),\n\t\twhite: f(\"\\x1b[37m\", \"\\x1b[39m\"),\n\t\tgray: f(\"\\x1b[90m\", \"\\x1b[39m\"),\n\n\t\tbgBlack: f(\"\\x1b[40m\", \"\\x1b[49m\"),\n\t\tbgRed: f(\"\\x1b[41m\", \"\\x1b[49m\"),\n\t\tbgGreen: f(\"\\x1b[42m\", \"\\x1b[49m\"),\n\t\tbgYellow: f(\"\\x1b[43m\", \"\\x1b[49m\"),\n\t\tbgBlue: f(\"\\x1b[44m\", \"\\x1b[49m\"),\n\t\tbgMagenta: f(\"\\x1b[45m\", \"\\x1b[49m\"),\n\t\tbgCyan: f(\"\\x1b[46m\", \"\\x1b[49m\"),\n\t\tbgWhite: f(\"\\x1b[47m\", \"\\x1b[49m\"),\n\n\t\tblackBright: f(\"\\x1b[90m\", \"\\x1b[39m\"),\n\t\tredBright: f(\"\\x1b[91m\", \"\\x1b[39m\"),\n\t\tgreenBright: f(\"\\x1b[92m\", \"\\x1b[39m\"),\n\t\tyellowBright: f(\"\\x1b[93m\", \"\\x1b[39m\"),\n\t\tblueBright: f(\"\\x1b[94m\", \"\\x1b[39m\"),\n\t\tmagentaBright: f(\"\\x1b[95m\", \"\\x1b[39m\"),\n\t\tcyanBright: f(\"\\x1b[96m\", \"\\x1b[39m\"),\n\t\twhiteBright: f(\"\\x1b[97m\", \"\\x1b[39m\"),\n\n\t\tbgBlackBright: f(\"\\x1b[100m\", \"\\x1b[49m\"),\n\t\tbgRedBright: f(\"\\x1b[101m\", \"\\x1b[49m\"),\n\t\tbgGreenBright: f(\"\\x1b[102m\", \"\\x1b[49m\"),\n\t\tbgYellowBright: f(\"\\x1b[103m\", \"\\x1b[49m\"),\n\t\tbgBlueBright: f(\"\\x1b[104m\", \"\\x1b[49m\"),\n\t\tbgMagentaBright: f(\"\\x1b[105m\", \"\\x1b[49m\"),\n\t\tbgCyanBright: f(\"\\x1b[106m\", \"\\x1b[49m\"),\n\t\tbgWhiteBright: f(\"\\x1b[107m\", \"\\x1b[49m\"),\n\t} as any\n}\n\n/**\n * @public\n */\nexport const colors : Colors = createColors()\n\n\n/**\n * @public\n */\nexport type Formatter = {\n    start: string;\n    end: string;\n} & ((input: string | number | null | undefined) => string);\n\n/**\n * @public\n */\nexport interface Colors {\n    isColorSupported: boolean;\n\n    reset: Formatter;\n    bold: Formatter;\n    dim: Formatter;\n    italic: Formatter;\n    underline: Formatter;\n    inverse: Formatter;\n    hidden: Formatter;\n    strikethrough: Formatter;\n\n    black: Formatter;\n    red: Formatter;\n    green: Formatter;\n    yellow: Formatter;\n    blue: Formatter;\n    magenta: Formatter;\n    cyan: Formatter;\n    white: Formatter;\n    gray: Formatter;\n\n    bgBlack: Formatter;\n    bgRed: Formatter;\n    bgGreen: Formatter;\n    bgYellow: Formatter;\n    bgBlue: Formatter;\n    bgMagenta: Formatter;\n    bgCyan: Formatter;\n    bgWhite: Formatter;\n\n    blackBright: Formatter;\n    redBright: Formatter;\n    greenBright: Formatter;\n    yellowBright: Formatter;\n    blueBright: Formatter;\n    magentaBright: Formatter;\n    cyanBright: Formatter;\n    whiteBright: Formatter;\n\n    bgBlackBright: Formatter;\n    bgRedBright: Formatter;\n    bgGreenBright: Formatter;\n    bgYellowBright: Formatter;\n    bgBlueBright: Formatter;\n    bgMagentaBright: Formatter;\n    bgCyanBright: Formatter;\n    bgWhiteBright: Formatter;\n}\n\n","import { isValidUtf8 } from \"@helios-lang/codec-utils\";\nimport type { uutPurposeMap } from \"./CapoTypes.js\";\nimport { textToBytes, type valuesEntry } from \"./HeliosPromotedTypes.js\";\nimport { UutName } from \"./delegation/UutName.js\";\nimport {\n    makeAssets,\n    makeValue,\n    type Value,\n    type MintingPolicyHash,\n} from \"@helios-lang/ledger\";\nimport { StellarTxnContext } from \"./StellarTxnContext.js\";\n\n/**\n * Creates Value-creation entires for a list of uuts\n * @remarks\n *\n * returns a list of `entries` usable in Value's `[mph, entries[]]` tuple.\n * @param uuts - a list of {@link UutName}s or a {@link uutPurposeMap}\n * @public\n **/\nexport function mkUutValuesEntries(uuts: UutName[]): valuesEntry[];\n/** @public **/\nexport function mkUutValuesEntries(uuts: uutPurposeMap<any>): valuesEntry[];\n/** @public **/\nexport function mkUutValuesEntries(\n    uuts: UutName[] | uutPurposeMap<any>\n): valuesEntry[];\n/** @public **/\nexport function mkUutValuesEntries(\n    uuts: UutName[] | uutPurposeMap<any>\n): valuesEntry[] {\n    const uutNs = Array.isArray(uuts) ? uuts : Object.values(uuts);\n    const uniqs: UutName[] = [];\n    for (const un of uutNs) {\n        if (!uniqs.includes(un)) uniqs.push(un);\n    }\n    return uniqs.map((uut) => mkValuesEntry(uut.name, BigInt(1)));\n}\n\n/**\n * Creates a tuple usable in a Value, converting token-name to byte-array if needed\n * @public\n **/\nexport function mkValuesEntry(\n    tokenName: string | number[],\n    count: bigint\n): valuesEntry {\n    const tnBytes = Array.isArray(tokenName)\n        ? tokenName\n        : textToBytes(tokenName);\n\n    // addrHint,  //moved to config\n    // reqdAddress,  // removed\n\n    return [tnBytes, count];\n}\n\n/**\n * construct a Value based on a token-name\n * @remarks\n *\n * A simpler version of the Value constructor to serve the\n * common case of a single, string-based token name.\n *\n * If you need the Value to contain its minUtx computed based\n * on network parameters, use the StellarContract's mkMinTv()\n * method instead.\n *\n * @param mph - policy-hash of the token\n * @param tokenName - string name of the token\n * @param count: number of the tokens to include in the value\n * @public\n **/\nexport function mkTv(\n    mph: MintingPolicyHash,\n    tokenName: string | number[],\n    count: bigint = 1n\n): Value {\n    const v = makeValue(\n        0,\n        makeAssets([[mph, [mkValuesEntry(tokenName, count)]]])\n    );\n    return v;\n}\n\n/**\n * Multiplies two numbers using integer math semantics for matching with Helios on-chain Real math\n *\n * @remarks\n * The numbers can be whole or fractional, with 6 decimal places of honored precision.\n * The result is rounded to 6 decimal places.\n * @todo - delegate this to a call into the on-chain version of same\n * @public\n */\nexport function realMul(a: number, b: number) {\n    const a2 = Math.trunc(1000000 * a);\n    const b2 = Math.trunc(1000000 * b);\n    const result1 = a2 * b2;\n    const result2 = result1 / 1_000_000_000_000;\n    if (debugRealMath) {\n        console.log(\"    ---- realMul\", a2, b2);\n        console.log(\"    ---- realMul result1\", result1);\n        console.log(\"    ---- realMul result2\", result2);\n    }\n    return result2;\n}\n\n/**\n * Divides two numbers using integer math semantics for matching with Helios on-chain Real math\n *\n * @remarks\n * The numbers can be whole or fractional, with 6 decimal places of honored precision.\n * The result is rounded to 6 decimal places.\n * @todo - delegate this to a call into the on-chain version of same\n * @public\n */\nexport function realDiv(a: number, b: number) {\n    if (b === 0) {\n        throw new Error(\"Cannot divide by zero\");\n    }\n    const a2 = Math.trunc(1_000_000 * a);\n    const b2 = Math.trunc(1_000_000 * b);\n    const result1 = a2 / b;\n    // const result2 = toFixedReal(result1 / 1_000_000);\n    const result2 = Math.round(result1) / 1_000_000;\n    if (debugRealMath) {\n        console.log(\"    ---- realDiv\", a, \"/\", b);\n        console.log(\"    ---- realDiv\", a2);\n        console.log(\"    ---- realDiv result1\", result1);\n        console.log(\"    ---- realDiv result2\", result2);\n    }\n    return result2;\n}\n\n/**\n * Rounds a number to 6 decimal places, with correction for low-value floating-point\n * errors e.g. `(2.999999999) -> 3.0`\n * @public\n */\nexport function toFixedReal(n: number) {\n    return parseFloat((Math.floor(n * 1_000_000 + 0.1) / 1_000_000).toFixed(6));\n}\n/**\n * Temporarily enable debugRealMath for the duration of the callback\n * @internal\n */\nexport function debugMath<T extends number>(callback: () => T): T {\n    const old = debugRealMath;\n    debugRealMath = true;\n    const result = callback();\n    debugRealMath = old;\n    return result;\n}\n\nlet debugRealMath = false;\n\n\n\n/**\n * @public\n */\nexport class TxNotNeededError extends Error {\n    constructor(message: string) {\n        super(message);\n        this.name = \"TxAlreadyPresentError\";\n    }\n}\n\n/**\n * @public\n */\nexport class AlreadyPendingError extends TxNotNeededError {\n    constructor(message: string) {\n        super(message);\n        this.name = \"AlreadyPendingError\";\n    }\n}\n\n/**\n * @internal\n */\nexport function isLibraryMatchedTcx(arg: any) : arg is StellarTxnContext {\n    if (arg instanceof StellarTxnContext) {\n        return true;\n    }\n    if (arg.kind === \"StellarTxnContext\") {\n        throw new Error(\"Stellar Contracts: library mismatch detected.  Ensure you're using only one version of the library\");\n    }\n    return false\n}\n\n\n/**\n * @public\n */\nexport function checkValidUTF8(data: number[]) {\n  // quickly check, without throwing errors, for invalid UTF-8 sequences:\n  let i = 0;\n  while (i < data.length) {\n    if ((data[i] & 0x80) === 0x00) {\n      i++;\n    } else if ((data[i] & 0xE0) === 0xC0) {\n      if (i + 1 >= data.length || (data[i + 1] & 0xC0) !== 0x80) return false;\n      i += 2;\n    } else if ((data[i] & 0xF0) === 0xE0) {\n      if (i + 2 >= data.length || (data[i + 1] & 0xC0) !== 0x80 || (data[i + 2] & 0xC0) !== 0x80) return false;\n      i += 3\n    } else if ((data[i] & 0xF8) === 0xF0) {\n      if (i + 3 >= data.length || (data[i + 1] & 0xC0) !== 0x80 || (data[i + 2] & 0xC0) !== 0x80 || (data[i + 3] & 0xC0) !== 0x80) return false;\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n  // if it didn't fail above, fine - but still defer to isValidUtf8.  it CAN throw (and catch) an error,\n  // but the above checks are much likelier to return false with NO caught error.\n  return isValidUtf8(data);\n}\n\nexport {colors} from \"./colors.js\"","import {\n    makeTxId,\n    makeTxInput,\n    makeTxOutput,\n    makeValue,\n    type PubKey,\n    type PubKeyHash,\n    type TxOutput,\n    type NetworkParamsHelper,\n    type Tx,\n    type Address,\n    type NetworkParams,\n    type Assets,\n    type TxOutputId,\n    type Signature,\n    makeTxOutputId,\n    type TxInput,\n    type TxId,\n    makeAddress,\n    makeStakingAddress,\n    type StakingAddress,\n    makeNetworkParamsHelper,\n    makeAssets,\n    type ShelleyAddress,\n    type Value,\n} from \"@helios-lang/ledger\";\n\nimport { type BytesLike, type IntLike } from \"@helios-lang/codec-utils\";\nimport {colors} from \"../utils.js\"\nconst { magenta } = colors\n\nimport {\n    BIP39_DICT_EN,\n    SECOND,\n    type EmulatorTx,\n    type Emulator,\n    type Wallet,\n    type EmulatorGenesisTx,\n    type EmulatorRegularTx,\n    type Bip32PrivateKey,\n    restoreRootPrivateKey,\n    type RootPrivateKey,\n    makeEmulatorGenesisTx,\n    makeEmulatorRegularTx,\n    type SimpleWallet,\n    type Cip30CoseSign1,\n    signCip30CoseData,\n} from \"@helios-lang/tx-utils\";\nimport type { NumberGenerator } from \"@helios-lang/crypto\";\nimport { DEFAULT_NETWORK_PARAMS } from \"@helios-lang/ledger\";\nimport { type UplcLogger } from \"@helios-lang/uplc\";\n\nimport {\n    dumpAny,\n    type NetworkContext,\n} from \"@donecollectively/stellar-contracts\";\nimport { expectDefined } from \"@helios-lang/type-utils\";\n\n// class GenesisTx implements EmulatorGenesisTx {\n//     #id: number;\n//     #address: Address;\n//     #lovelace: bigint;\n//     #assets: Assets;\n\n//     constructor(\n//         id: number,\n//         address: Address,\n//         lovelace: bigint,\n//         assets: Assets\n//     ) {\n//         this.#id = id;\n//         this.#address = address;\n//         this.#lovelace = lovelace;\n//         this.#assets = assets;\n//     }\n\n//     /**\n//      * Simple incremental txId for genesis transactions.\n//      * It's very unlikely that regular transactions have the same hash.\n//      */\n//     id() {\n//         let bytes = encodeIntBE(BigInt(this.#id));\n\n//         if (bytes.length < 32) {\n//             bytes = new Array(32 - bytes.length).fill(0).concat(bytes);\n//         }\n\n//         return makeTxId(bytes);\n//     }\n\n//     consumes(utxo) {\n//         return false;\n//     }\n\n//     collectUtxos(address, utxos) {\n//         if (equalsBytes(this.#address.bytes, address.bytes)) {\n//             utxos = utxos.slice();\n\n//             utxos.push(\n//                 makeTxInput(\n//                     makeTxOutputId(this.id(), 0),\n//                     makeTxOutput(\n//                         this.#address,\n//                         makeValue(this.#lovelace, this.#assets)\n//                     )\n//                 )\n//             );\n\n//             return utxos;\n//         } else {\n//             return utxos;\n//         }\n//     }\n\n//     getUtxo(id: TxOutputId) {\n//         if (!(this.id().isEqual(id.txId) && id.index == 0)) {\n//             return null;\n//         }\n\n//         return makeTxInput(\n//             makeTxOutputId(this.id(), 0),\n//             makeTxOutput(this.#address, makeValue(this.#lovelace, this.#assets))\n//         );\n//     }\n\n//     dump() {\n//         console.log(\"GENESIS TX\");\n//         console.log(\n//             `id: ${this.#id.toString()},\\naddress: ${this.#address.toString() // same as .toBech32()\n//                 },\\nlovelace: ${this.#lovelace.toString()},\\nassets: ${JSON.stringify(\n//                 this.#assets.dump(),\n//                 undefined,\n//                 \"    \"\n//             )}`\n//         );\n//     }\n// }\n\n// class RegularTx implements EmulatorRegularTx {\n//     #tx: Tx;\n\n//     kind = \"Regular\" as const\n//     constructor(tx: Tx) {\n//         this.#tx = tx;\n//     }\n\n//     #txId: TxId | null = null;\n//     id() {\n//         if (this.#txId) return this.#txId;\n//         return (this.#txId = this.#tx.id());\n//     }\n\n//     consumes(utxo) {\n//         const txInputs = this.#tx.body.inputs;\n\n//         return txInputs.some((txInput) => txInput.isEqual(utxo));\n//     }\n\n//     collectUtxos(address, utxos) {\n//         utxos = utxos.filter((utxo) => !this.consumes(utxo));\n\n//         const txOutputs = this.#tx.body.outputs;\n//         const txId = this.id();\n//         txOutputs.forEach((txOutput, utxoId) => {\n//             if (equalsBytes(txOutput.address.bytes, address.bytes)) {\n//                 utxos.push(makeTxInput(makeTxOutputId(txId, utxoId), txOutput));\n//             }\n//         });\n\n//         return utxos;\n//     }\n\n//     getUtxo(id: TxOutputId) : TxInput | undefined{\n//         if (!id.txId.isEqual(this.id())) {\n//             return undefined;\n//         }\n\n//         /**\n//          * @type {null | TxInput}\n//          */\n//         let utxo: TxInput | undefined;\n\n//         this.#tx.body.outputs.forEach((output, i) => {\n//             if (i == id.index) {\n//                 utxo = makeTxInput(id, output);\n//             }\n//         });\n\n//         return utxo;\n//     }\n\n//     dump() {\n//         console.log(\"REGULAR TX\");\n//         console.log(JSON.stringify(this.#tx.dump(), undefined, \"  \"));\n//     }\n// }\n\n/**\n * This wallet only has a single private/public key, which isn't rotated.\n * Staking is not yet supported.\n * @public\n */\nexport class SimpleWallet_stellar implements Wallet {\n    networkCtx: NetworkContext;\n    spendingPrivateKey: Bip32PrivateKey;\n    spendingPubKey: PubKey;\n\n    stakingPrivateKey: Bip32PrivateKey | undefined;\n    stakingPubKey: PubKey | undefined;\n\n    get cardanoClient() {\n        return this.networkCtx.network;\n    }\n\n    static fromPhrase(\n        phrase: string[],\n        networkCtx: NetworkContext,\n        dict = BIP39_DICT_EN\n    ): SimpleWallet_stellar {\n        return SimpleWallet_stellar.fromRootPrivateKey(\n            restoreRootPrivateKey(phrase, dict),\n            networkCtx\n        );\n    }\n    static fromRootPrivateKey(\n        key: RootPrivateKey,\n        networkCtx: NetworkContext\n    ): SimpleWallet_stellar {\n        return new SimpleWallet_stellar(\n            networkCtx,\n            key.deriveSpendingKey(),\n            key.deriveStakingKey()\n        );\n    }\n\n    constructor(\n        networkCtx: NetworkContext,\n        spendingPrivateKey: Bip32PrivateKey,\n        stakingPrivateKey: Bip32PrivateKey | undefined = undefined\n    ) {\n        this.networkCtx = networkCtx;\n        this.spendingPrivateKey = spendingPrivateKey;\n        this.spendingPubKey = this.spendingPrivateKey.derivePubKey();\n\n        this.stakingPrivateKey = stakingPrivateKey;\n        this.stakingPubKey = this.stakingPrivateKey?.derivePubKey();\n\n        // TODO: staking credentials\n    }\n\n    get privateKey(): Bip32PrivateKey {\n        return this.spendingPrivateKey;\n    }\n\n    get pubKey(): PubKey {\n        return this.spendingPubKey;\n    }\n\n    get spendingPubKeyHash(): PubKeyHash {\n        return this.spendingPubKey.hash();\n    }\n\n    get stakingPubKeyHash() {\n        return this.stakingPubKey?.hash();\n    }\n\n    get address(): ShelleyAddress<PubKeyHash> {\n        return makeAddress(\n            this.cardanoClient.isMainnet(),\n            this.spendingPubKeyHash,\n            this.stakingPubKey?.hash()\n        );\n    }\n\n    get stakingAddress() {\n        if (this.stakingPubKey) {\n            return makeStakingAddress(\n                this.cardanoClient.isMainnet(),\n                this.stakingPubKey.hash()\n            );\n        } else {\n            return undefined;\n        }\n    }\n\n    get stakingAddresses(): Promise<StakingAddress[]> {\n        return new Promise((resolve, _) => {\n            const stakingAddress = this.stakingAddress;\n\n            resolve(stakingAddress ? [stakingAddress] : []);\n        });\n    }\n\n    async isMainnet(): Promise<boolean> {\n        return this.networkCtx.network.isMainnet();\n    }\n\n    /**\n     * Assumed wallet was initiated with at least 1 UTxO at the pubkeyhash address.\n     */\n    get usedAddresses(): Promise<ShelleyAddress<PubKeyHash>[]> {\n        return new Promise((resolve, _) => {\n            resolve([this.address]);\n        });\n    }\n\n    get unusedAddresses(): Promise<ShelleyAddress<PubKeyHash>[]> {\n        return new Promise((resolve, _) => {\n            resolve([]);\n        });\n    }\n\n    get utxos(): Promise<TxInput<PubKeyHash>[]> {\n        return new Promise((resolve, _) => {\n            resolve(this.cardanoClient.getUtxos(this.address) as any);\n        });\n    }\n\n    get collateral(): Promise<TxInput<PubKeyHash>[]> {\n        return new Promise((resolve, _) => {\n            resolve([]);\n        });\n    }\n    async signData(\n        addr: ShelleyAddress<PubKeyHash>, \n        data: BytesLike\n    ): Promise<{signature: Cip30CoseSign1, key: PubKey}> {\n        const spendingCredential = addr.spendingCredential\n        const stakingCredential = addr.stakingCredential\n\n        if (stakingCredential) {\n            if (!addr.isEqual(this.address)) {\n                throw new Error(\n                    \"givend address doesn't correspond to SimpleWallet's address\"\n                )\n            }\n\n            const pubKey = expectDefined(this.stakingPubKey)\n            const privateKey = expectDefined(this.stakingPrivateKey)\n\n            return {\n                signature: signCip30CoseData(addr, privateKey, data),\n                key: pubKey\n            }\n        } else {\n            if (!spendingCredential.isEqual(this.address.spendingCredential)) {\n                throw new Error(\n                    \"given address.spendingCredential doesn't correspond to SimpleWallet's spending credential\"\n                )\n            }\n\n            return {\n                signature: signCip30CoseData(\n                    addr,\n                    this.spendingPrivateKey,\n                    data\n                ),\n                key: this.spendingPubKey\n            }\n        }\n    }\n\n    /**\n     * Simply assumed the tx needs to by signed by this wallet without checking.\n     */\n    async signTx(tx: Tx): Promise<Signature[]> {\n        return [this.spendingPrivateKey.sign(tx.body.hash())];\n    }\n\n    async submitTx(tx: Tx): Promise<TxId> {\n        return await this.cardanoClient.submitTx(tx);\n    }\n}\n\n/**\n * Captures details from emulated network, to be used for quickly restoring a network state.\n * @public\n */\nexport type NetworkSnapshot = {\n    seed: number;\n    netNumber: number;\n    name: string;\n    slot: number;\n    genesis: EmulatorGenesisTx[];\n    blocks: EmulatorTx[][];\n    allUtxos: Record<string, TxInput>;\n    consumedUtxos: Set<string>;\n    addressUtxos: Record<string, TxInput[]>;\n};\n\nlet i = 1;\n/**\n * A simple emulated Network.\n * This can be used to do integration tests of whole dApps.\n * Staking is not yet supported.\n * @public\n */\nexport class StellarNetworkEmulator implements Emulator {\n    declare currentSlot: number;\n    #seed: number;\n    #random: NumberGenerator;\n    genesis: EmulatorGenesisTx[];\n    mempool: EmulatorTx[];\n    blocks: EmulatorTx[][];\n\n    /**\n     * Cached map of all UTxOs ever created\n     * @internal\n     */\n    _allUtxos: Record<string, TxInput>;\n\n    /**\n     * Cached set of all UTxOs ever consumed\n     * @internal\n     */\n    _consumedUtxos: Set<string>;\n\n    /**\n     * Cached map of UTxOs at addresses\n     * @internal\n     */\n    _addressUtxos: Record<string, TxInput[]>;\n\n    id: number;\n    params: NetworkParams;\n    /**\n     * Instantiates a NetworkEmulator at slot 0.\n     * An optional seed number can be specified, from which all EMULATED RANDOMNESS is derived.\n     */\n    constructor(\n        seed = 0,\n        { params }: { params: NetworkParams } = {\n            params: DEFAULT_NETWORK_PARAMS(),\n        }\n    ) {\n        this.id = i++;\n        this.params = params || DEFAULT_NETWORK_PARAMS();\n        this.#seed = seed;\n        this.currentSlot = 0;\n        this.#random = this.mulberry32.bind(this);\n        this.genesis = [];\n        this.mempool = [];\n        this.blocks = [];\n\n        this._allUtxos = {};\n        this._consumedUtxos = new Set();\n        this._addressUtxos = {};\n\n        this.initHelper();\n    }\n    isMainnet() {\n        return false;\n    }\n    /**\n     * Each slot is assumed to be 1000 milliseconds\n     *\n     * returns milliseconds since start of emulation\n     */\n    get now(): number {\n        return SECOND * this.currentSlot;\n    }\n\n    get parameters(): Promise<NetworkParams> {\n        return new Promise((resolve, _) => resolve(this.parametersSync));\n    }\n\n    get parametersSync() {\n        return {\n            ...this.params,\n            refTipSlot: this.currentSlot,\n            refTipTime: this.now,\n        };\n    }\n\n    /**\n     * retains continuity for the seed and the RNG through one or more snapshots.\n     * @internal\n     */\n    mulberry32 = () => {\n        //!!mutates vvvvvvvvvv this.#seed\n        let t = (this.#seed += 0x6d2b79f5);\n\n        t = Math.imul(t ^ (t >>> 15), t | 1);\n        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\n        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n    };\n\n    netPHelper!: NetworkParamsHelper;\n    initHelper() {\n        this.netPHelper = makeNetworkParamsHelper(this.parametersSync);\n        return this.netPHelper;\n    }\n\n    /**\n     * Ignores the genesis txs\n     */\n    get txIds(): TxId[] {\n        const res: TxId[] = [];\n\n        // TODO: the current approach is very slow, use a snapshot\n        for (let block of this.blocks) {\n            for (let tx of block) {\n                if (tx.kind == \"Regular\") {\n                    res.push(tx.id());\n                }\n            }\n        }\n\n        return res;\n    }\n\n\n    snapshot(snapName: string): NetworkSnapshot {\n        if (this.mempool.length > 0) {\n            throw new Error(`can't snapshot with pending txns`);\n        }\n        console.log(\n`        .---.\n        |[X]|\n _.==._.\"\"\"\"\".___n__\n/ __ ___.-''-. _____b\n|[__]  /.\"\"\"\".\\\\ _   |\n|     // /\"\"\\\\ \\\\\\\\_)  |\n|     \\\\\\\\ \\\\__/ //    |\n|      \\\\\\`.__.'/     |\n\\\\=======\\`-..-'======/\n \\`-----------------'   \\n`+\n            \"            üì∏ üì∏ üì∏   ‚ñà‚ñà‚ñà‚ñà  üì∏ üì∏ üì∏  #\" + this.id,\n            ` - snapshot '${snapName}' at slot `,\n            this.currentSlot.toString(),\n            \"height \",\n            this.blocks.length\n        );\n\n        return {\n            name: snapName,\n            seed: this.#seed,\n            netNumber: this.id,\n            slot: this.currentSlot,\n            genesis: [...this.genesis],\n            blocks: [...this.blocks],\n            allUtxos: { ...this._allUtxos },\n            consumedUtxos: new Set(this._consumedUtxos),\n            addressUtxos: Object.fromEntries(\n                Object.entries(this._addressUtxos).map(([addr, utxoList]) => [\n                    addr,\n                    [...utxoList],\n                ])\n            ),\n        };\n    }\n\n\n    fromSnapshot = \"\";\n    loadSnapshot(snapshot: NetworkSnapshot) {\n        this.#seed = snapshot.seed;\n        this.currentSlot = snapshot.slot;\n        this.genesis = [...snapshot.genesis];\n        this.blocks = [...snapshot.blocks];\n        this.fromSnapshot = snapshot.name;\n\n        this._allUtxos = { ...snapshot.allUtxos };\n        this._consumedUtxos = new Set(snapshot.consumedUtxos);\n        // this._addressUtxos = { ...snapshot.addressUtxos };\n        this._addressUtxos = Object.fromEntries(\n            Object.entries(snapshot.addressUtxos).map(([addr, utxoList]) => [\n                addr,\n                [...utxoList],\n            ])\n        );\n\n        this.initHelper();\n        console.log(\n            `\n      .--.             .--.             .--.             .--.       \n    .'_\\\\/_'.         .'_\\\\/_'.         .'_\\\\/_'.         .'_\\\\/_'.     \n    '. /\\\\ .'         '. /\\\\ .'         '. /\\\\ .'         '. /\\\\ .'     \n      \"||\"             \"||\"             \"||\"             \"||\"       \n       || /\\\\            || /\\\\            || /\\\\            || /\\\\     \n    /\\\\ ||//\\\\)        /\\\\ ||//\\\\)        /\\\\ ||//\\\\)        /\\\\ ||//\\\\)    \n   (/\\\\\\\\||/          (/\\\\\\\\||/          (/\\\\\\\\||/          (/\\\\\\\\||/       \n______\\\\||/_____________\\\\||/_____________\\\\||/_____________\\\\||/_______\n            üå∫üå∫üå∫ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  # ${this.id}\\n`,\n            ` - restored snapshot '${snapshot.name}' from #${snapshot.netNumber} at slot `,\n            this.currentSlot.toString(),\n            \"height \",\n            this.blocks.length\n        );\n    }\n\n    // /**\n    //  * Creates a new `NetworkParams` instance that has access to current slot\n    //  * (so that the `Tx` validity range can be set automatically during `Tx.finalize()`).\n    //  */\n    // initNetworkParams(networkParams): NetworkParams {\n    //     const raw = Object.assign({}, networkParams.raw);\n\n    //     // raw.latestTip = {\n    //     //     epoch: 0,\n    //     //     hash: \"\",\n    //     //     slot: 0,\n    //     //     time: 0,\n    //     // };\n\n    //     return (this.#netParams = new NetworkParams(raw, () => {\n    //         return this.currentSlot;\n    //     }));\n    // }\n\n    /**\n     * Creates a new SimpleWallet and populates it with a given lovelace quantity and assets.\n     * Special genesis transactions are added to the emulated chain in order to create these assets.\n     * @deprecated - use TestHelper.createWallet instead, enabling wallets to be transported to\n     *     different networks (e.g. ones that have loaded snapshots from the original network).\n     */\n    createWallet(lovelace = 0n, assets = makeAssets([])): SimpleWallet_stellar {\n        throw new Error(\"use TestHelper.createWallet instead\");\n    }\n\n    /**\n     * Creates a UTxO using a GenesisTx.  The txn doesn't need to balance or be signed.  It's magic.\n     * @param wallet - the utxo is created at this wallet's address\n     * @param lovelace - the lovelace amount to create\n     * @param assets - other assets to include in the utxo\n     */\n    createUtxo(\n        wallet: SimpleWallet,\n        lovelace: bigint,\n        assets: Assets = makeAssets([])\n    ): TxOutputId {\n        if (lovelace != 0n || !assets.isZero()) {\n            const tx = makeEmulatorGenesisTx(\n                this.genesis.length,\n                wallet.address,\n                lovelace,\n                assets\n            );\n\n            this.genesis.push(tx);\n            this.mempool.push(tx);\n            return makeTxOutputId(tx.id(), 0);\n        } else {\n            throw new Error(\"zero-value utxos not supported\");\n        }\n    }\n\n    // #netParams!: NetworkParams;\n    // async getParameters() {\n    //     if (this.#netParams) return this.#netParams;\n\n    //     return this.initNetworkParams(\n    //         new NetworkParams(rawNetworkEmulatorParams)\n    //     );\n    // }\n\n    warnMempool() {\n        if (this.mempool.length > 0) {\n            console.error(\n                \"Warning: mempool not empty (hint: use 'network.tick()')\"\n            );\n        }\n    }\n\n    /**\n     * Throws an error if the UTxO isn't found\n     */\n    async getUtxo(id: TxOutputId): Promise<TxInput> {\n        this.warnMempool();\n\n        const utxo = this._allUtxos[id.toString()];\n\n        if (!utxo) {\n            throw new Error(`utxo with id ${id.toString()} doesn't exist`);\n        } else {\n            return utxo;\n        }\n    }\n\n    /*\n     * @param {TxOutputId} id\n     * @returns {Promise<TxInput>}\n     */\n    async hasUtxo(id) {\n        try {\n            return !!(await this.getUtxo(id));\n        } catch (e) {\n            return false;\n        }\n    }\n\n    async getUtxos(address: Address): Promise<TxInput[]> {\n        this.warnMempool();\n\n        return this._addressUtxos[address.toString()] ?? [];\n    }\n\n    isSubmissionExpiryError(e: Error) { \n        if (e.message.match(/slot out of range/)) return true\n        return false \n    } \n\n    isUnknownUtxoError(e: Error) { \n        if (e.message.match(/previously consumed/)) return true\n        if (e.message.match(/don't exist/)) return true\n        return false\n    }\n\n    dump() {\n        console.log(`${this.blocks.length} BLOCKS`);\n        this.blocks.forEach((block, i) => {\n            console.log(`${block.length} TXs in BLOCK ${i}`);\n            for (let tx of block) {\n                tx.dump();\n            }\n        });\n    }\n\n    isConsumed(utxo) {\n        return (\n            this._consumedUtxos.has(utxo.id.toString()) ||\n            this.mempool.some((tx) => {\n                return tx.consumes(utxo);\n            })\n        );\n    }\n\n    async submitTx(tx: Tx) {\n        this.warnMempool();\n\n        if (!tx.isValidSlot(BigInt(this.currentSlot))) {\n            debugger\n            throw new Error(\n                `tx invalid (slot out of range, ${\n                    this.currentSlot\n                } not in ${tx.body\n                    .getValidityTimeRange(this.parametersSync)\n                    .toString()})`\n            );\n        }\n\n        // make sure that each input exists\n        if (\n            !tx.body.inputs.every(\n                (input) => input.id.toString() in this._allUtxos\n            )\n        ) {\n            throw new Error(\"some inputs don't exist\");\n        }\n\n        // make sure that each ref input exists\n        if (\n            !tx.body.refInputs.every(\n                (input) => input.id.toString() in this._allUtxos\n            )\n        ) {\n            throw new Error(\"some ref inputs don't exist\");\n        }\n\n        // make sure that none of the inputs have been consumed before\n        for (const input of tx.body.inputs) {\n            if (this.isConsumed(input)) {\n                throw new Error(\n                    `## ${this.id}: input previously consumed:` + dumpAny(input)\n                );\n            }\n        }\n\n        this.mempool.push(makeEmulatorRegularTx(tx));\n        console.log(\n            `[EmuNet #${this.id}] +mempool txn = ${this.mempool.length}`\n        );\n        return tx.id();\n    }\n\n    /**\n     * Mint a block with the current mempool, and advance the slot by a number of slots.\n     */\n    tick(nSlots: IntLike) {\n        const n = BigInt(nSlots);\n        if (n < 1) throw new Error(`nSlots must be > 0, got ${n.toString()}`);\n\n        const count = this.mempool.length;\n\n        this.currentSlot += Number(n);\n        const time = new Date(\n            Number(this.netPHelper.slotToTime(this.currentSlot))\n        );\n\n        if (this.mempool.length > 0) {\n            const txIds = this.mempool.map((tx) => {\n                const t = tx.id().toString();\n                return `${t.substring(0, 2)}...${t.substring(t.length - 4)}`\n            })\n            this.pushBlock(this.mempool);\n            const height = this.blocks.length;\n\n            this.mempool = [];\n\n            console.log(\n                magenta(`‚ñà‚ñà‚ñà${\"‚ñí\".repeat(\n                    count\n                )} ${count} txns (${txIds.join(\",\")}) -> slot ${this.currentSlot.toString()} = ${formatDate(\n                    time\n                )} @ht=${height}`)\n            );\n        } else {\n            console.log(\n                magenta(`tick -> slot ${this.currentSlot.toString()} = ${formatDate(\n                    time\n                )} (no txns)`)\n            );\n        }\n    }\n\n\n    /**\n     * @internal\n     */\n    pushBlock(txs: EmulatorTx[]) {\n        this.blocks.push(txs);\n\n        // add all new utxos\n        txs.forEach((tx) => {\n            tx.newUtxos().forEach((utxo) => {\n                const key = utxo.id.toString();\n                this._allUtxos[key] = utxo;\n\n                const addr = utxo.address.toString();\n\n                if (addr in this._addressUtxos) {\n                    this._addressUtxos[addr].push(utxo);\n                } else {\n                    this._addressUtxos[addr] = [utxo];\n                }\n            });\n\n            tx.consumedUtxos().forEach((utxo) => {\n                this._consumedUtxos.add(utxo.id.toString());\n\n                const addr = utxo.address.toString();\n\n                if (addr in this._addressUtxos) {\n                    this._addressUtxos[addr] = this._addressUtxos[addr].filter(\n                        (inner) => !inner.isEqual(utxo)\n                    );\n                }\n            });\n        });\n    }\n}\n\nfunction formatDate(date) {\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\"); // Months are 0-indexed\n    const day = String(date.getDate()).padStart(2, \"0\");\n    const hours = String(date.getHours()).padStart(2, \"0\");\n    const minutes = String(date.getMinutes()).padStart(2, \"0\");\n    const seconds = String(date.getSeconds()).padStart(2, \"0\");\n\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n}\n","import {\n    DEFAULT_NETWORK_PARAMS,\n    type Address,\n    type NetworkParams,\n    type NetworkParamsHelper,\n    type Tx,\n    type TxId,\n    makeAssets,\n    type ShelleyAddress,\n    type TxBody,\n} from \"@helios-lang/ledger\";\nimport { generateBytes, mulberry32 } from \"@helios-lang/crypto\";\n\nimport { SimpleWallet_stellar as emulatedWallet } from \"./StellarNetworkEmulator.js\";\n\nimport {\n    StellarContract,\n    dumpAny,\n    lovelaceToAda,\n    txAsString,\n    UtxoHelper,\n    TxBatcher,\n    GenericSigner,\n    environment,\n} from \"@donecollectively/stellar-contracts\";\nimport type {\n    stellarSubclass,\n    ConfigFor,\n    StellarSetupDetails,\n    ActorContext,\n    NetworkContext,\n    SetupInfo,\n    StellarTxnContext,\n    SubmitOptions,\n} from \"@donecollectively/stellar-contracts\";\n\nimport { ADA } from \"./types.js\";\nimport type {\n    TestHelperState,\n    actorMap,\n    canHaveRandomSeed,\n    canSkipSetup,\n} from \"./types.js\";\nimport {\n    SimpleWallet_stellar,\n    StellarNetworkEmulator,\n} from \"./StellarNetworkEmulator.js\";\nimport {\n    makeRootPrivateKey,\n    type Wallet,\n} from \"@helios-lang/tx-utils\";\n\n/**\n * @public\n */\nexport const expectTxnError = {\n    expectError: true as const,\n} as Partial<SubmitOptions>;\n\n/**\n * @public\n */\nexport type TestHelperSubmitOptions = SubmitOptions & {\n    futureDate?: Date;\n};\n\n/**\n * Base class for test-helpers on generic Stellar contracts\n * @remarks\n *\n * NOTE: DefaultCapoTestHelper is likely to be a better fit for typical testing needs and typical contract-development scenarios.\n * Use this class for specific unit-testing needs not sufficiently served by integration-testing on a Capo.\n * @public\n **/\nexport abstract class StellarTestHelper<SC extends StellarContract<any>, SpecialState extends Record<string, any> = {}> {\n    state: Record<string, any>;\n    abstract get stellarClass(): stellarSubclass<SC>;\n    config?: ConfigFor<SC> & canHaveRandomSeed;\n    defaultActor?: string;\n    strella!: SC;\n    actors: actorMap;\n    optimize = false;\n    netPHelper: NetworkParamsHelper;\n    networkCtx: NetworkContext<StellarNetworkEmulator>;\n    protected _actorName!: string;\n\n    /**\n     * @public\n     */\n    get actorName() {\n        return this._actorName;\n    }\n\n    /**\n     * @public\n     */\n    get network() {\n        return this.networkCtx.network;\n    }\n\n    /**\n     * Gets the current actor wallet\n     *\n     * @public\n     **/\n    get wallet(): emulatedWallet {\n        const wallet: emulatedWallet | undefined = this.actorContext.wallet;\n        if (!wallet) {\n            throw new Error(`no current actor; use setActor(actorName) first`);\n        }\n        return wallet as emulatedWallet;\n    }\n\n    /**\n     * @public\n     */\n    actorContext: ActorContext<emulatedWallet> = {\n        others: {},\n        wallet: undefined,\n    };\n\n    /**\n     * @public\n     */\n    async setActor(actorName: string) {\n        const thisActor = this.actors[actorName];\n        if (!thisActor)\n            throw new Error(\n                `setCurrentActor: network #${this.network.id}: invalid actor name '${actorName}'\\n   ... try one of: \\n  - ` +\n                    Object.keys(this.actors).join(\",\\n  - \")\n            );\n        if (this._actorName) {\n            if (actorName == this._actorName) {\n                if (this.actorContext.wallet !== thisActor) {\n                    throw new Error(\n                        `actor / wallet mismatch: ${this._actorName} ${dumpAny(\n                            this.actorContext.wallet?.address\n                        )} vs ${actorName} ${dumpAny(thisActor.address)}`\n                    );\n                }\n                // quiet idempotent call.\n                return;\n            }\n            console.log(\n                `\\nüé≠ -> üé≠ changing actor from üé≠ ${\n                    this._actorName\n                } to  üé≠ ${actorName} ${dumpAny(thisActor.address)}`\n            );\n        } else {\n            console.log(\n                `\\nüé≠üé≠ initial actor ${actorName} ${dumpAny(\n                    thisActor.address\n                )}`\n            );\n        }\n        this._actorName = actorName;\n        this.actorContext.wallet = thisActor;\n\n        // if (this.strella) {\n        //     this.strella = await this.initStellarClass(\n        //         this.state.parsedConfig || this.config\n        //     );\n        // }\n    }\n\n    address?: Address;\n\n    setupPending?: Promise<any>;\n    /**\n     * @public\n     */\n    async setupActors() {\n        console.warn(\n            `using 'hiro' as default actor because ${this.constructor.name} doesn't define setupActors()`\n        );\n        this.addActor(\"hiro\", 1863n * ADA);\n    }\n    /**\n     * @public\n     */\n    setDefaultActor() {\n        return this.setActor(\"hiro\");\n    }\n\n    helperState?: TestHelperState<SC, SpecialState>;\n    constructor(\n        config?: ConfigFor<SC> & canHaveRandomSeed & canSkipSetup,\n        helperState?: TestHelperState<SC, SpecialState>\n    ) {\n        this.state = {};\n        if (!helperState) {\n            console.warn(\n                // warning emoji: \"‚ö†Ô∏è\"\n                // info emoji: \"‚ÑπÔ∏è\"\n                `‚ö†Ô∏è ‚ö†Ô∏è ‚ö†Ô∏è Note: this test helper doesn't have a helperState, so it won't be able to use test-chain snapshots\n‚ÑπÔ∏è ‚ÑπÔ∏è ‚ÑπÔ∏è ... to add helper state, follow this pattern:\n\n    // in your test helper:\n\n    @CapoTestHelper.hasNamedSnapshot(\"yourSnapshot\", \"tina\")\n    snapTo‚ÄπYourSnapshot‚Ä∫() {\n        // never called\n    }\n    async ‚ÄπyourSnapshot‚Ä∫() {\n        this.setActor(\"tina\");\n\n        // ... your good sequence of transaction(s) here\n        const tcx = this.capo.mkTxn‚Äπ...‚Ä∫(...)\n        return this.submitTxnWithBlock(tcx);\n    }\n\n    // in your test setup:\n\n    type localTC = StellarTestContext<YourCapo>;\n    let helperState: TestHelperState<YourCapo> = {\n        snapshots: {},\n    } as any;\n\n    beforeEach<localTC>(async (context) => {\n        await addTestContext(context,\n            YourCapoTestHelper,\n            undefined,\n            helperState\n        )\n    }                \n\n    // in your tests:\n    \n    describe(\"your thing\", async () => {\n        it(\"your test\", async (context: localTC) => {\n            // prettier-ignore\n            const {h, h:{network, actors, delay, state} } = context;\n            await h.reusableBootstrap();\n\n            await h.snapTo‚ÄπyourSnapshot‚Ä∫()\n        });\n        it(\"your other test\", async (context: localTC) => { \n            // prettier-ignore\n            const {h, h:{network, actors, delay, state} } = context;\n            // this one will use the snapshot generated earlier\n            await h.snapTo‚ÄπyourSnapshot‚Ä∫()\n        });\n    })\n\n... happy (and snappy) testing!`\n            );\n        }\n        this.helperState = helperState;\n        const cfg = config || {};\n        if (Object.keys(cfg).length) {\n            console.log(\n                \"XXXXXXXXXXXXXXXXXXXXXXXXXX test helper with config\",\n                config\n            );\n\n            this.config = config;\n        }\n\n        const t = this.mkNetwork(this.fixupParams(DEFAULT_NETWORK_PARAMS()));\n        const theNetwork: StellarNetworkEmulator = t[0];\n        const netParamsHelper: NetworkParamsHelper = t[1];\n\n        this.netPHelper = netParamsHelper;\n        this.networkCtx = {\n            network: theNetwork,\n        };\n\n        this.randomSeed = config?.randomSeed || 42;\n        this.actors = {};\n        const now = new Date();\n        this.waitUntil(now);\n\n        console.log(\" + StellarTestHelper\");\n        //xx@ts-expect-error - can serve no-params case or params case\n        // this.setupPending = this.initialize();\n    }\n\n    /**\n     * @public\n     */\n    fixupParams(preProdParams: NetworkParams): NetworkParams {\n        //@ts-expect-error on our synthetic property\n        if (preProdParams.isFixedUp) return preProdParams;\n\n        const origMaxTxSize = preProdParams.maxTxSize;\n        //@ts-expect-error on our synthetic property\n        preProdParams.origMaxTxSize = origMaxTxSize;\n        const maxTxSize = Math.floor(origMaxTxSize * 5);\n        console.log(\n            \"test env: üîßüîßüîß fixup max tx size\",\n            origMaxTxSize,\n            \" -> üîß\",\n            maxTxSize\n        );\n        preProdParams.maxTxSize = maxTxSize;\n\n        const origMaxMem = preProdParams.maxTxExMem;\n        //@ts-expect-error on our synthetic property\n        preProdParams.origMaxTxExMem = origMaxMem;\n\n        const maxMem = Math.floor(origMaxMem * 8);\n        console.log(\n            \"test env: üîßüîßüîß fixup max memory\",\n            origMaxMem,\n            \" -> üîß\",\n            maxMem\n        );\n        preProdParams.maxTxExMem = maxMem;\n\n        const origMaxCpu = preProdParams.maxTxExCpu;\n        //@ts-expect-error on our synthetic property\n        preProdParams.origMaxTxExCpu = origMaxCpu;\n\n        const maxCpu = Math.floor(origMaxCpu * 3.1);\n        console.log(\n            \"test env: üîßüîßüîß fixup max cpu\",\n            origMaxCpu,\n            \" -> üîß\",\n            maxCpu\n        );\n        preProdParams.maxTxExCpu = maxCpu;\n\n        //@ts-expect-error on our synthetic property\n        preProdParams.isFixedUp = true;\n        return preProdParams;\n    }\n\n    /**\n     * Submits a transaction and advances the network block\n     * @public\n     * @param TCX - The type of transaction context state, must extend anyState\n     */\n    async submitTxnWithBlock<TCX extends StellarTxnContext>(\n        tcx: TCX | Promise<TCX>,\n        options: TestHelperSubmitOptions = {}\n    ): Promise<TCX> {\n        const t = await tcx;\n        await this.advanceNetworkTimeForTx(t, options.futureDate);\n\n        return t.buildAndQueueAll(options).then(() => {\n            this.network.tick(1);\n            return tcx;\n        });\n    }\n\n    /**\n     * @public\n     */\n    async advanceNetworkTimeForTx(tcx: StellarTxnContext, futureDate?: Date) {\n        // determines the validity range of the transaction\n\n        let txBody: TxBody | undefined = undefined\n        let validFrom=0, validTo=0;\n        let targetTime: number = futureDate?.getTime() || Date.now();\n        let targetSlot = this.netPHelper.timeToSlot(BigInt(targetTime));\n        const nph = this.netPHelper;\n\n        if (tcx.isFacade && !futureDate) {\n            console.log(\"not advancing network time for facade tx\")\n            return\n        } else if (!tcx.isFacade) {\n            //XX@ts-expect-error on internal prop\n            // if (!tcx.txb.validTo) {\n            //     debugger\n            //     // just to verify what it looks like\n            //     tcx.txb.validFromSlot(targetSlot)\n            //     tcx.txb.validToTime(Date.now())\n            //     debugger\n            // }\n\n            validFrom = ( () => {\n                //@ts-expect-error on internal prop\n                const {slot, timestamp} = tcx.txb.validFrom?.left || {}\n                if (slot) return slot\n                if (!timestamp) return undefined\n                return nph.timeToSlot(BigInt(timestamp))\n            })();\n            validTo = ( () => {\n                //@ts-expect-error on internal prop\n                const {slot, timestamp} = tcx.txb.validFrom?.left || {}\n                if (slot) return slot\n                if (!timestamp) return undefined\n                return nph.timeToSlot(BigInt(timestamp))\n            })();\n        }\n\n        const currentSlot = this.network.currentSlot;\n        const nowSlot = nph.timeToSlot(BigInt(Date.now()));\n        const slotDiff = targetSlot - currentSlot;\n\n        const validInPast = validTo && nowSlot > validTo;\n        const validInFuture = validFrom && nowSlot < validFrom;\n        tcx.logger.logPrint(\n            `\\n    ---- ‚öóÔ∏è üêûüêû advanceNetworkTimeForTx: tx valid ${\n                validFrom || \"anytime\"\n            } -> ${validTo || \"anytime\"}`\n        );\n        function withPositiveSign(x: number | bigint) {\n            return x < 0 ? `${x}` : `+${x}`;\n        }\n        const currentToNowDiff = withPositiveSign(nowSlot - currentSlot);\n        const currentToTargetDiff = withPositiveSign(slotDiff);\n        let effectiveNetworkSlot = targetSlot;\n        function showEffectiveNetworkSlotTIme() {\n            tcx.logger.logPrint(\n                `\\n    ‚öóÔ∏è üêû‚ÑπÔ∏è  with now=network slot ${effectiveNetworkSlot}: ${nph.slotToTime(\n                    effectiveNetworkSlot\n                )}\\n` +\n                    `           tx valid ${\n                        validFrom\n                            ? withPositiveSign(effectiveNetworkSlot - validFrom)\n                            : \"anytime\"\n                    } -> ${\n                        validTo\n                            ? withPositiveSign(effectiveNetworkSlot - validTo)\n                            : \"anytime\"\n                    } from now`\n            );\n        }\n    \n        if (validInPast || validInFuture) {\n            tcx.logger.logPrint(\n                \"\\n  ‚öóÔ∏è üêû‚ÑπÔ∏è  advanceNetworkTimeForTx: \" + (tcx.txnName || \"\")\n            );\n            if (futureDate) {\n                debugger;\n                tcx.logger.logPrint(\n                    `\\n    ---- ‚öóÔ∏è üêûüêû explicit futureDate ${futureDate.toISOString()} -> slot ${targetSlot}`\n                );\n            }\n    \n            tcx.logger.logPrint(\n                `\\n    ---- ‚öóÔ∏è üêûüêû current slot ${currentSlot} ${currentToNowDiff} = now slot ${nowSlot} \\n` +\n                    `                    current ${currentToTargetDiff} = targetSlot ${targetSlot}`\n            );\n            if (futureDate) {\n                // \":info:‚ÑπÔ∏è\"\n                // \":test: ‚öóÔ∏è\"\n                // \":debug: üêû \"\n                // info emoji with i in a blue square: \"‚ÑπÔ∏è\"\n                tcx.logger.logPrint(\n                    `\\n    ---- ‚öóÔ∏è üêû‚ÑπÔ∏è  txnTime ${\n                        validInPast\n                            ? \"already in the past\"\n                            : validInFuture\n                            ? \"not yet valid\"\n                            : \"‚Äπ??incontheevable??‚Ä∫\"\n                    }; advancing to explicit futureDate @now + ${\n                        targetSlot - nowSlot\n                    }s`\n                );\n            } else {\n                // test an old txn by constructing it with a date less than Date.now()\n                tcx.logger.logPrint(\n                    `\\n    -- ‚öóÔ∏è üêû txnTime ${\n                        validInPast\n                            ? \"already in the past\"\n                            : validInFuture\n                            ? \"not yet valid\"\n                            : \"‚Äπ??incontheevable??‚Ä∫\"\n                    }; no futureDate specified; not interfering with network time`\n                );\n                effectiveNetworkSlot = nowSlot;\n                showEffectiveNetworkSlotTIme();\n                tcx.logger.flush();\n\n                return;\n            }\n        }\n\n        if (slotDiff < 0) {\n            effectiveNetworkSlot = nowSlot;\n            showEffectiveNetworkSlotTIme();\n            if (futureDate) {\n                tcx.logger.logPrint(\n                    `\\n    ------ ‚öóÔ∏è üêûüêûüêûüêûüêûüêûüêûüêûcan't go back in time ${slotDiff}s (current slot ${this.network.currentSlot}, target ${targetSlot})`\n                );\n                throw new Error(\n                    `explicit futureDate ${futureDate} is in the past; can't go back ${slotDiff}s`\n                );\n            }\n            tcx.logger.logPrint(\n                `\\n   -- ‚öóÔ∏è üêûüêûüêûüêû‚öóÔ∏è  NOT ADVANCING: the network is already ahead of the current time by ${\n                    0 - slotDiff\n                }s ‚öóÔ∏è üêûüêûüêûüêû‚öóÔ∏è`\n            );\n            tcx.logger.flush();\n            return;\n        }\n        if (this.network.currentSlot < targetSlot) {\n            effectiveNetworkSlot = targetSlot;\n            tcx.logger.logPrint(\n                `\\n    ‚öóÔ∏è üêû‚ÑπÔ∏è  advanceNetworkTimeForTx ${withPositiveSign(\n                    slotDiff\n                )} slots`\n            );\n            showEffectiveNetworkSlotTIme();\n            this.network.tick(slotDiff);\n        } else {\n            effectiveNetworkSlot = currentSlot;\n            showEffectiveNetworkSlotTIme();\n        }\n        tcx.logger.flush();\n    }\n\n    /**\n     * @public\n     */\n    async initialize({\n        randomSeed = 42,\n    }: { randomSeed?: number } = {}): Promise<SC> {\n        console.log(\"STINIT\");\n        debugger;\n\n        if (this.strella && this.randomSeed == randomSeed) {\n            console.log(\n                \"       ----- skipped duplicate initialize() in test helper\"\n            );\n            return this.strella;\n        }\n        if (this.strella) {\n            console.warn(\n                \".... warning: new test helper setup with new seed....\"\n            );\n            this.rand = undefined;\n            this.randomSeed = randomSeed;\n            this.actors = {};\n        } else {\n            console.log(\n                \"???????????????????????? Test helper initializing without this.strella\"\n            );\n        }\n        console.log(\"STINIT2\");\n        await this.delay(1);\n        this._actorName = \"\"; //only to make typescript happy\n        if (!Object.keys(this.actors).length) {\n            const actorSetup = this.setupActors();\n            await actorSetup;\n            this.setDefaultActor();\n        }\n        console.log(\"STINIT3\");\n\n        return this.initStellarClass();\n    }\n\n    /**\n     * @public\n     */\n    async initStellarClass(config = this.config) {\n        const TargetClass = this.stellarClass;\n\n        const strella = await this.initStrella(TargetClass, config);\n\n        this.strella = strella;\n        this.address = strella.address;\n        return strella;\n    }\n\n    //!!! reconnect tests to tcx-based config-capture\n    // onInstanceCreated: async (config: ConfigFor<SC>) => {\n    //     this.config = config\n    //     return {\n    //         evidence: this,\n    //         id: \"empheral\",\n    //         scope: \"unit test\"\n    //     }\n    // }\n\n    setup!: SetupInfo\n    initSetup(setup: SetupInfo = undefined as any) {\n        setup = setup || {\n            actorContext: this.actorContext,\n            networkParams: this.networkParams,\n            uh: undefined as any,\n            isTest: true,\n            isMainnet: false,\n            optimize: process.env.OPTIMIZE ? true : this.optimize,\n        } as any\n\n        const getNetwork = () => { return this.network };\n        const getActor = () => { return this.actorContext.wallet! };\n\n        Object.defineProperty(setup, \"network\", {\n            get: getNetwork,\n            configurable: true\n        });\n        setup.txBatcher = new TxBatcher({              \n            setup,\n            submitters:  {\n               get emulator() { return getNetwork() } \n            },\n            get signingStrategy() { return new GenericSigner( getActor()) }                \n        }),\n\n        setup.txBatcher.setup = setup;\n        setup.uh = new UtxoHelper(setup);\n\n        return this.setup = setup\n    }\n\n\n    /**\n     * @public\n     */\n    async initStrella(\n        TargetClass: stellarSubclass<SC>,\n        config?: ConfigFor<SC>\n    ) {\n        const envOptimize = process.env.OPTIMIZE\n        // console.warn(`using env OPTIMIZE=${envOptimize}`)\n\n        const setup = this.initSetup()\n\n        let cfg: StellarSetupDetails<ConfigFor<SC>> = {\n            setup,\n            config: config!,\n        };\n\n        if (!config)\n            cfg = {\n                setup,\n                partialConfig: {},\n            };\n        if (setup.actorContext.wallet) {\n            console.log(\n                \"+strella init with actor addr\",\n                (setup.actorContext.wallet as any).address.toBech32()\n            );\n        } else {\n            debugger;\n            console.log(\"+strella init without actor\");\n        }\n        return TargetClass.createWith(cfg);\n    }\n\n    //! it has a seed for mkRandomBytes, which must be set by caller\n    randomSeed?: number;\n    //! it makes a rand() function based on the randomSeed after first call to mkRandomBytes\n    rand?: () => number;\n\n    /**\n     * @public\n     */\n    delay(ms) {\n        return new Promise((res) => setTimeout(res, ms));\n    }\n\n    /**\n     * Creates a new SimpleWallet and populates it with a given lovelace quantity and assets.\n     * Special genesis transactions are added to the emulated chain in order to create these assets.\n     * @public\n     */\n    createWallet(lovelace = 0n, assets = makeAssets([])): SimpleWallet_stellar {\n        const wallet = SimpleWallet_stellar.fromRootPrivateKey(\n            makeRootPrivateKey(generateBytes(this.network.mulberry32, 32)),\n            this.networkCtx\n        );\n\n        this.network.createUtxo(wallet, lovelace, assets);\n\n        return wallet;\n    }\n\n    /**\n     * @public\n     */\n    async submitTx(tx: Tx, force?: \"force\"): Promise<TxId> {\n        const sendChangeToCurrentActor = this.wallet?.address;\n        const isAlreadyInitialized = !!this.strella;\n        // try {\n        //     await tx.finalize(this.networkParams, sendChangeToCurrentActor);\n        // } catch (e: any) {\n        //     throw new Error(\n        //         e.message +\n        //             \"\\nin tx: \" +\n        //             txAsString(tx, this.networkParams) +\n        //             // \"\\nprofile: \" +\n        //             // tx.profileReport\n        //     );\n        // }\n        if (isAlreadyInitialized && !force) {\n            throw new Error(\n                `helper is already initialized; use the submitTx from the testing-context's 'strella' object instead`\n            );\n        }\n\n        console.log(\n            `Test helper ${force || \"\"} submitting tx${\n                (force && \"\") || \" prior to instantiateWithParams()\"\n            }:\\n` + txAsString(tx, this.networkParams)\n            // new Error(`at stack`).stack\n        );\n\n        try {\n            const txId = await this.network.submitTx(tx);\n            console.log(\n                \"test helper submitted direct txn:\" +\n                    txAsString(tx, this.networkParams)\n            );\n            this.network.tick(1);\n            // await this.delay(1000)\n            // debugger\n            // this.network.dump();\n            return txId;\n        } catch (e: any) {\n            console.error(\n                `submit failed: ${e.message}\\n  ... in tx ${txAsString(tx)}`\n            );\n            throw e;\n        }\n    }\n\n    /**\n     * @public\n     */\n    mkRandomBytes(length: number): number[] {\n        if (!this.randomSeed)\n            throw new Error(\n                `test must set context.randomSeed for deterministic randomness in tests`\n            );\n        if (!this.rand) this.rand = mulberry32(this.randomSeed);\n\n        const bytes: number[] = [];\n        for (let i = 0; i < length; i++) {\n            bytes.push(Math.floor(this.rand() * 256));\n        }\n        return bytes;\n    }\n\n    /**\n     * creates a new Actor in the transaction context with initial funds, returning a Wallet object\n     * @remarks\n     *\n     * Given an actor name (\"marcie\") or role name (\"marketer\"), and a number\n     * of indicated lovelace, creates and returns a wallet having the indicated starting balance.\n     *\n     * By default, three additional, separate 5-ADA utxos are created, to ensure sufficient Collateral and\n     * small-change are existing, making typical transaction scenarios work easily.  If you want to include\n     * other utxo's instead you can supply their lovelace sizes.\n     *\n     * To suppress creation of additional utxos, use `0n` for arg3.\n     *\n     * You may wish to import {@link ADA} = 1_000_000n from the testing/ module, and\n     * multiply smaller integers by that constant.\n     *\n     * @param roleName - an actor name or role-name for this wallet\n     * @param walletBalance - initial wallet balance\n     * @param moreUtxos - additional utxos to include\n     *\n     * @example\n     *     this.addActor(\"cheapo\", 14n * ADA, 0n);  //  14 ADA and no additional utxos\n     *     this.addActor(\"flexible\", 14n * ADA);  //  14 ADA + default 15 ADA in 3 additional utxos\n     *     this.addActor(\"moneyBags\", 42_000_000n * ADA, 5n, 4n);  //  many ADA and two collaterals\n     *\n     *     //  3O ADA in 6 separate utxos:\n     *     this.addActor(\"smallChange\", 5n * ADA, 5n * ADA, 5n * ADA, 5n * ADA, 5n * ADA, 5n * ADA);\n     *\n     * @public\n     **/\n    addActor(\n        roleName: string,\n        walletBalance: bigint,\n        ...moreUtxos: bigint[]\n    ): Wallet {\n        if (this.actors[roleName])\n            throw new Error(`duplicate role name '${roleName}'`);\n        //! it instantiates a wallet with the indicated balance pre-set\n        // console.log(new Error(`add actor ${roleName}`).stack);\n        const a = this.createWallet(walletBalance);\n        const addr = a.address.toString();\n        console.log(\n            `+üé≠ Actor: ${roleName}: ${addr.slice(0, 12)}‚Ä¶${addr.slice(\n                -4\n            )} ${lovelaceToAda(walletBalance)} (üîë#${(\n                a.address as ShelleyAddress\n            ).spendingCredential\n                ?.toHex()\n                .substring(0, 8)}‚Ä¶)`\n        );\n\n        this.actorContext.others[roleName] = a;\n\n        //! it makes collateral for each actor, above and beyond the initial balance,\n        //  ... so that the full balance is spendable and the actor can immediately\n        //  ... engage in smart-contract interactions.\n        // this.network.tick(2);\n        const five = 5n * ADA;\n        if (0 == moreUtxos.length) moreUtxos = [five, five, five];\n        for (const moreLovelace of moreUtxos) {\n            if (moreLovelace > 0n) {\n                this.network.createUtxo(a, moreLovelace);\n            }\n        }\n        // this.network.tick(1);\n\n        this.actors[roleName] = a;\n        return a;\n    }\n\n    //todo use this for enabling prettier diagnostics with clear labels for\n    //  -- actor addresses -> names\n    //  -- script addresses -> names\n    addrRegistry: Record<string, string> = {};\n\n    /**\n     * @public\n     */\n    get networkParams(): NetworkParams {\n        return this.netPHelper.params;\n    }\n\n    /**\n     * @public\n     */\n    mkNetwork(\n        params: NetworkParams\n    ): [StellarNetworkEmulator, NetworkParamsHelper] {\n        const theNetwork = new StellarNetworkEmulator(undefined, { params });\n        const emuParams = theNetwork.initHelper();\n\n        // const wrappedNetwork = makeTxChainBuilder(theNetwork);\n        // debugger\n        //@xxxts-expect-error\n        // emuParams.timeToSlot = function (t) {\n        //     const seconds = BigInt(t / 1000n);\n        //     return seconds;\n        // };\n        // emuParams.slotToTimestamp = this.slotToTimestamp;\n\n        return [theNetwork, emuParams];\n    }\n\n    /**\n     * @public\n     */\n    slotToTime(s: bigint) {\n        return this.netPHelper.slotToTime(s);\n\n        const num = parseInt(BigInt.asIntN(52, s * 1000n).toString());\n        return new Date(num);\n    }\n\n    /**\n     * @public\n     */\n    currentSlot() {\n        return this.network.currentSlot;\n    }\n\n    /**\n     * @public\n     */\n    waitUntil(time: Date) {\n        const targetTimeMillis = BigInt(time.getTime());\n        // debugger\n        const targetSlot = this.netPHelper.timeToSlot(targetTimeMillis);\n        const c = this.currentSlot();\n\n        const slotsToWait = targetSlot - (c || 0);\n        if (slotsToWait < 1) {\n            throw new Error(`the indicated time is not in the future`);\n        }\n        // console.warn(`waiting ${slotsToWait} slots -> ${time}`);\n        this.network.tick(slotsToWait);\n        return slotsToWait;\n    }\n}\n","import { Capo, StellarTxnContext } from \"@donecollectively/stellar-contracts\";\nimport type {\n    hasBootstrappedCapoConfig,\n    hasUutContext,\n    MinimalCharterDataArgs,\n    anyState,\n    hasAddlTxns,\n    SubmitOptions,\n    ConfigFor,\n    CapoConfig,\n    CapoFeatureFlags,\n} from \"@donecollectively/stellar-contracts\";\n\nimport { StellarTestHelper } from \"./StellarTestHelper.js\";\nimport { canHaveRandomSeed, TestHelperState } from \"./types.js\";\n\nconst ACTORS_ALREADY_MOVED =\n    \"NONE! all actors were moved from a different network via snapshot\";\n\nexport const SNAP_INIT = \"initialized\";\nexport const SNAP_BOOTSTRAP = \"bootstrapped\";\n\n/**\n * Base class for test helpers for Capo contracts\n * @remarks\n *\n * You should probably use DefaultCapoTestHelper instead of this class.\n * @public\n **/\nexport abstract class CapoTestHelper<\n    SC extends Capo<any>,\n    SpecialState extends Record<string, any> = {[key: string]: never}\n> extends StellarTestHelper<SC, SpecialState> {\n    declare config?: canHaveRandomSeed & SC extends Capo<any, infer FF>\n        ? ConfigFor<SC> & CapoConfig<FF>\n        : never;\n    get capo() {\n        return this.strella;\n    }\n    featureFlags: CapoFeatureFlags | undefined = undefined;\n    constructor(\n        config?: SC extends Capo<any, infer FF>\n            ? ConfigFor<SC> & CapoConfig<FF>\n            : ConfigFor<SC>,\n        helperState?: TestHelperState<SC, SpecialState>\n    ) {\n        if (!config) {\n            super(config, helperState);\n        } else {\n            const { featureFlags, ...otherConfig } = config;\n            if (Object.keys(otherConfig).length) {\n                super(config as any, helperState);\n            } else {\n                super(undefined, helperState);\n            }\n            if (featureFlags) {\n                this.featureFlags = featureFlags;\n            }\n        }\n    }\n    async initialize(\n        { randomSeed = 42 }: { randomSeed?: number } = {},\n        args?: Partial<MinimalCharterDataArgs>\n    ): Promise<SC> {\n        // Note: This method diverges from the base class impl, due to type difficulties.\n        // Patches welcome.\n\n        if (this.strella && this.randomSeed == randomSeed) {\n            console.log(\n                \"       ----- skipped duplicate initialize() in test helper\"\n            );\n\n            return this.strella;\n        }\n        // console.log(\"A in capo test helper\")\n\n        if (this.strella) {\n            console.log(\n                `    -- üå±üå±üå± new test helper setup with new seed (was ${this.randomSeed}, now ${randomSeed})...\\n` +\n                    new Error(\"stack\")\n                        .stack!.split(\"\\n\")\n                        .slice(1)\n                        .filter(\n                            (line) =>\n                                !line.match(/node_modules/) &&\n                                !line.match(/node:internal/)\n                        )\n                        .join(\"\\n\")\n            );\n\n            //@ts-expect-error\n            this.strella = undefined;\n            this.actors = {};\n            this._actorName = \"\";\n        }\n        await this.delay(1);\n\n        this.randomSeed = randomSeed;\n\n        if (Object.keys(this.actors).length) {\n            console.log(\"Skipping actor setup - already done\");\n        } else {\n            console.log(\"  -- üé≠üé≠üé≠ actor setup...\");\n            const actorSetup = this.setupActors();\n            await actorSetup;\n            this.network.tick(1);\n            await this.setDefaultActor();\n        }\n\n        this.state.mintedCharterToken = undefined;\n        this.state.parsedConfig = undefined;\n\n        //! when there's not a preset config, it leaves the detailed setup to be done just-in-time\n        //   based on seedUtxo in mkTxnMintCharterToken\n        if (!this.config) {\n            console.log(\"  -- Capo not yet bootstrapped\");\n            const ts1 = Date.now();\n            const {featureFlags} = this;\n            if (featureFlags) {\n                this.strella = await this.initStrella(this.stellarClass, {featureFlags} as any);\n                //@ts-ignore\n                this.strella.featureFlags = this.featureFlags\n            } else {\n                this.strella = await this.initStrella(this.stellarClass);\n            }\n\n            const ts2 = Date.now();\n            console.log(\n                // stopwatch emoji: ‚è±Ô∏è\n                `  -- ‚è±Ô∏è initialized Capo: ${ts2 - ts1}ms`\n            );\n            console.log(\"checking delegate scripts...\");\n            return this.checkDelegateScripts(args).then(() => {\n                const ts3 = Date.now();\n                console.log(`  -- ‚è±Ô∏è checked delegate scripts: ${ts3 - ts2}ms`);\n                return this.strella;\n            });\n        }\n        // throw new Error(`unreachable pre-bootstrapped capo?`);\n\n        console.log(\"  -- Capo already bootstrapped\");\n        const strella = await this.initStrella(this.stellarClass, this.config);\n\n        this.strella = strella;\n        const { address, mintingPolicyHash: mph } = strella;\n\n        const { name } = strella.program;\n        console.log(\n            name,\n            address.toString().substring(0, 18) + \"‚Ä¶\",\n            \"vHash üìú \" + strella.validatorHash.toHex().substring(0, 12) + \"‚Ä¶\",\n            \"mph üè¶ \" + mph?.toHex().substring(0, 12) + \"‚Ä¶\"\n        );\n        console.log(\"<- CAPO initialized()\");\n        return strella;\n    }\n\n    async checkDelegateScripts(\n        args: Partial<MinimalCharterDataArgs> = {}\n    ): Promise<void> {\n        throw new Error(\n            `doesn't fail, because it's implemented by DefaultCapoTestHelper`\n        );\n    }\n\n    get ready() {\n        return !!(\n            (this.strella.configIn && !this.strella.didDryRun.configIn) ||\n            this.state.parsedConfig\n        );\n    }\n\n    /**\n     * Creates a new transaction-context with the helper's current or default actor\n     * @public\n     **/\n    mkTcx<T extends anyState = anyState>(\n        txnName?: string\n    ): StellarTxnContext<T> {\n        const tcx = new StellarTxnContext(this.strella.setup);\n        if (txnName) return tcx.withName(txnName) as any;\n        return tcx as any;\n    }\n\n    loadSnapshot(snapName: string) {\n        const snap = this.helperState!.snapshots[snapName];\n        if (!snap) throw new Error(`no snapshot named ${snapName}`);\n\n        this.network.loadSnapshot(snap);\n    }\n\n    async reusableBootstrap(\n        snap = SNAP_BOOTSTRAP\n        // override = false\n    ) {\n        let capo;\n        const helperState = this.helperState!;\n        if (helperState.bootstrapped) {\n            // debugger\n            console.log(\"  ---  ‚öóÔ∏èüêûüêû already bootstrapped\");\n            if (!helperState.previousHelper) {\n                debugger;\n                throw new Error(\n                    `already bootstrapped, but no previousHelper : ( `\n                );\n            }\n            capo = await this.restoreFrom(snap);\n        } else {\n            capo = await this.bootstrap();\n            helperState.bootstrappedStrella = capo;\n        }\n        const { previousHelper } = helperState;\n        if (!previousHelper) {\n            this.snapshot(SNAP_BOOTSTRAP);\n        } else {\n            console.log(\n                `changing helper from network ${previousHelper.network.id} to ${this.network.id}`\n            );\n        }\n        helperState.bootstrapped = true;\n        helperState.previousHelper = this;\n\n        return capo;\n    }\n\n    // a decorator for test-helper functions that generate named snapshots\n    static hasNamedSnapshot(snapshotName: string, actorName: string) {\n        return function (\n            target: any,\n            propertyKey: string,\n            descriptor: PropertyDescriptor\n        ) {\n            const originalMethod = descriptor.value;\n            descriptor.value = SnapWrap;\n\n            const [_, WithCapMethodName] =\n                propertyKey.match(/^snapTo(.*)/) || [];\n            if (!WithCapMethodName) {\n                throw new Error(\n                    `hasNamedSnapshot(): ${propertyKey}(): expected method name to start with 'snapTo'`\n                );\n            }\n            const methodName =\n                WithCapMethodName[0].toLowerCase() + WithCapMethodName.slice(1);\n            const generateSnapshotFunc = target[methodName];\n            if (!generateSnapshotFunc) {\n                throw new Error(\n                    `hasNamedSnapshot(): ${propertyKey}: expected method ${methodName} to exist`\n                );\n            }\n\n            console.log(\n                \"hasNamedSnapshot(): \",\n                propertyKey,\n                \" -> \",\n                methodName\n            );\n\n            async function SnapWrap(this: CapoTestHelper<any>, ...args: any[]) {\n                await this.reusableBootstrap();\n\n                return this.findOrCreateSnapshot(\n                    snapshotName,\n                    actorName,\n                    () => {\n                        return generateSnapshotFunc\n                            .apply(this, ...args)\n                            .then((result) => {\n                                if (this.actorName !== actorName) {\n                                    throw new Error(\n                                        `snapshot ${snapshotName}: expected actor '${actorName}', but current actor is '${this.actorName}'`\n                                    );\n                                }\n                                this.network.tick(1);\n                                return result;\n                            });\n                    }\n                );\n            }\n            return descriptor;\n        };\n    }\n\n    hasSnapshot(snapshotName: string) {\n        return !!this.helperState?.snapshots[snapshotName];\n    }\n\n    snapshot(snapshotName: string) {\n        if (!this.helperState) {\n            throw new Error(`can't snapshot without a helperState`);\n        }\n        if (this.hasSnapshot(snapshotName)) {\n            throw new Error(`snapshot ${snapshotName} already exists`);\n        }\n        this.helperState.snapshots[snapshotName] =\n            this.network.snapshot(snapshotName);\n    }\n\n    async findOrCreateSnapshot(\n        snapshotName: string,\n        actorName: string,\n        contentBuilder: () => Promise<StellarTxnContext<any>>\n    ): Promise<SC> {\n        if (this.helperState!.snapshots[snapshotName]) {\n            const capo = await this.restoreFrom(snapshotName);\n            await this.setActor(actorName);\n            return capo;\n        }\n        let result;\n        try {\n            result = await contentBuilder();\n            return this.strella;\n            // the correct actor name is expected from the underlying activity\n            // await this.setActor(actorName);\n            return result;\n        } catch (e) {\n            throw e;\n        } finally {\n            if (result) {\n                this.snapshot(snapshotName);\n            }\n        }\n    }\n\n    async restoreFrom(snapshotName: string): Promise<SC> {\n        const {\n            helperState,\n            helperState: {\n                snapshots,\n                previousHelper,\n                bootstrappedStrella,\n            } = {},\n        } = this;\n        if (!helperState)\n            throw new Error(\n                `can't restore from a previous helper without a helperState`\n            );\n        if (!bootstrappedStrella)\n            throw new Error(\n                `can't restore from a previous helper without a bootstrappedStrella`\n            );\n\n        if (!snapshots || !snapshots[snapshotName]) {\n            throw new Error(`no snapshot named ${snapshotName} in helperState`);\n        }\n        if (!previousHelper) {\n            throw new Error(`no previousHelper in helperState`);\n        }\n        const { parsedConfig } = previousHelper.state;\n\n        const {\n            networkCtx: oldNetworkEnvelope,\n            actorContext: oldActorContext,\n            setup: previousSetup,\n        } = previousHelper;\n        const { network: previousNetwork } = oldNetworkEnvelope;\n        const { network: newNet } = this.networkCtx;\n        this.initSetup(previousSetup);\n\n        // hacky load of the indicator of already having restored details from the prievous helper\n        const otherNet: number = previousHelper.actors[\n            ACTORS_ALREADY_MOVED\n        ] as unknown as number;\n        if (otherNet) {\n            if (otherNet !== newNet.id) {\n                throw new Error(\n                    `actors already moved to network #${otherNet}; can't move to #${newNet.id} now.`\n                );\n            }\n            console.log(\"  -- actors are already here\");\n        } else {\n            if (this === previousHelper) {\n                console.log(\n                    \"  -- helper already transferred; loading incremental snapshot\"\n                );\n            } else {\n                Object.assign(this.actors, previousHelper.actors);\n\n                // swaps out the previous helper's envelopes for network & actor\n                previousHelper.networkCtx = { network: previousNetwork };\n                previousHelper.actorContext = {\n                    wallet: \"previous network retired\" as any,\n                    others: previousHelper.actorContext.others,\n                };\n\n                // uses the old envelope (that the Capo/etc classes used on the old network)\n                this.networkCtx = oldNetworkEnvelope;\n                this.actorContext = oldActorContext;\n                // ... but changes the referenced network\n                // ... to reflect the new snapshotted network\n                this.networkCtx.network = newNet;\n\n                this.state.mintedCharterToken =\n                    previousHelper.state.mintedCharterToken;\n                this.state.parsedConfig = parsedConfig;\n\n                //@ts-expect-error\n                previousHelper.actors = { [ACTORS_ALREADY_MOVED]: newNet.id };\n                console.log(\n                    `   -- moving ${\n                        Object.keys(this.actors).length\n                    } actors from network ${previousNetwork.id} to ${newNet.id}`\n                );\n            }\n            newNet.loadSnapshot(snapshots[snapshotName]);\n        }\n        if (!this.actorName) {\n            await this.setDefaultActor();\n        }\n        this.strella = bootstrappedStrella;\n        if (!this.strella) {\n            await this.initStellarClass(parsedConfig);\n        }\n        return this.strella;\n    }\n\n    async bootstrap(\n        args?: Partial<MinimalCharterDataArgs>,\n        submitOptions: SubmitOptions = {}\n    ) {\n        let strella = this.strella || (await this.initialize(undefined, args));\n        if (this.bootstrap != CapoTestHelper.prototype.bootstrap) {\n            throw new Error(\n                `Don't override the test-helper bootstrap().  Instead, provide an implementation of extraBootstrapping()`\n            );\n        }\n        if (this.ready) {\n            console.log(\n                \"       --- ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚úÖ Capo bootstrap already OK\"\n            );\n\n            return strella;\n        }\n\n        const options = {\n            ...submitOptions,\n            onSubmitted: () => {\n                this.network.tick(1);\n            },\n        };\n        await this.mintCharterToken(args, options);\n        console.log(\n            \"       --- ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚öóÔ∏è üêû ‚úÖ Capo bootstrap with charter\"\n        );\n\n        this.network.tick(1);\n        await this.extraBootstrapping(args, options);\n        return strella;\n    }\n\n    async extraBootstrapping(\n        args?: Partial<MinimalCharterDataArgs>,\n        submitOptions: SubmitOptions = {}\n    ) {\n        const tcx = this.mkTcx(\"extra bootstrapping\").facade();\n        const capoUtxos = await this.capo.findCapoUtxos();\n        const charterData = await this.capo.findCharterData(undefined, {\n            optional: false,\n            capoUtxos,\n        });\n        const tcx2 = await this.capo.mkTxnUpgradeIfNeeded(charterData);\n        // const tcx2 = await this.capo.addTxnBootstrappingSettings(tcx, charterData);\n        // const tcx3 = await this.capo.mkAdditionalTxnsForCharter(tcx, {\n        //     charterData,\n        //     capoUtxos\n        // })\n\n        await this.submitTxnWithBlock(tcx2, submitOptions);\n        return this.strella;\n    }\n\n    abstract mkDefaultCharterArgs(): Partial<MinimalCharterDataArgs>;\n    abstract mintCharterToken(\n        args?: Partial<MinimalCharterDataArgs>,\n        submitOptions?: SubmitOptions\n    ): Promise<\n        hasUutContext<\"govAuthority\" | \"capoGov\" | \"mintDelegate\" | \"mintDgt\"> &\n            hasBootstrappedCapoConfig &\n            hasAddlTxns<any>\n    >;\n}\n","import type { expect as expectType } from \"vitest\";\nimport type { Address } from \"@helios-lang/ledger\";\nimport type {\n    ConfigFor,\n    stellarSubclass,\n    CharterDataLike,\n    MinimalCharterDataArgs,\n    DelegateConfigDetails,\n    DelegateSetup,\n    UutName,\n    SubmitOptions,\n    CapoConfig,\n} from \"@donecollectively/stellar-contracts\";\nimport {\n    Capo,\n    StellarTxnContext,\n    parseCapoJSONConfig,\n    CapoWithoutSettings,\n} from \"@donecollectively/stellar-contracts\";\nimport { ADA } from \"./types.js\";\nimport type {\n    DefaultCapoTestHelperClass,\n    TestHelperState,\n    canHaveRandomSeed,\n    stellarTestHelperSubclass,\n} from \"./types.js\";\nimport { CapoTestHelper } from \"./CapoTestHelper.js\";\n\ndeclare namespace NodeJS {\n    interface Global {\n        expect: typeof expectType;\n    }\n}\ndeclare const expect: typeof expectType;\n\n/**\n * Test helper for classes extending Capo\n * @remarks\n *\n * Arranges an test environment with predefined actor-names having various amounts of ADA in their (emulated) wallets,\n * and default helpers for setting up test scenarios.  Provides a simplified framework for testing Stellar contracts extending\n * the Capo class.\n *\n * To use it, you MUST extend DefaultCapoTestHelper<YourStellarCapoClass>.\n *\n * You MUST also implement a getter  for stellarClass, returning the specific class for YourStellarCapoClass\n *\n * You SHOULD also implement a setupActors method to arrange named actors for your test scenarios.\n * It's recommended to identify general roles of different people who will interact with the contract, and create\n * one or more actor names for each role, where the actor names start with the same letter as the role-names.\n * For example, a set of Trustees in a contract might have actor names tina, tracy and tom, while\n * unprivileged Public users might have actor names like pablo and peter.  setupActors() also\n * should pre-assign some ADA funds to each actor: e.g. `this.addActor(‚ÄπactorName‚Ä∫, 142n * ADA)`\n *\n * @typeParam DC - the specific Capo subclass under test\n * @public\n **/\nexport class DefaultCapoTestHelper<\n    //@xxxts-expect-error spurious fail  type; it tries to strongly match the generic abstract type\n    //    from (abstract) Capo, instead of paying attention to the clearly-matching concrete version in DefaultCapo\n    CAPO extends Capo<any> = CapoWithoutSettings,\n    SpecialState extends Record<string, any> = {[key: string]: never}\n    //@xxxts-ignore because of a mismatch between the Capo's abstract mkTxnMintCharterToken's defined constraints\n    //    ... vs the only concrete impl in DefaultCapo, with types that are actually nicely matchy.\n    //    vscode is okay with it, but api-extractor is not :/\n> extends CapoTestHelper<CAPO, SpecialState> {\n    /**\n     * Creates a prepared test helper for a given Capo class, with boilerplate built-in\n     *\n     * @remarks\n     *\n     * You may wish to provide an overridden setupActors() method, to arrange actor\n     * names that fit your project's user-roles / profiles.\n     *\n     * You may also wish to add methods that satisfy some of your application's key\n     * use-cases in simple predefined ways, so that your automated tests can re-use\n     * the logic and syntax instead of repeating them in multiple test-cases.\n     *\n     * @param s - your Capo subclass\n     * @typeParam CAPO - no need to specify it; it's inferred from your parameter\n     * @public\n     **/\n    static forCapoClass<\n        CAPO extends Capo<any>,\n        SpecialState extends Record<string, any> = {}\n    >(\n        s: stellarSubclass<CAPO>,\n        specialState?: SpecialState\n    ): DefaultCapoTestHelperClass<CAPO, SpecialState> {\n        class specificCapoHelper extends DefaultCapoTestHelper<CAPO, SpecialState> {\n            get stellarClass() {\n                return s;\n            }\n        }\n        return specificCapoHelper;\n    }\n\n    //xx@ts-expect-error\n    get stellarClass(): stellarSubclass<CAPO> {\n        //@ts-expect-error\n        return CapoWithoutSettings;\n    }\n    _start: number;\n    constructor(\n        config?: CAPO extends Capo<any, infer FF>\n            ? ConfigFor<CAPO> & CapoConfig<FF>\n            : ConfigFor<CAPO>,\n        helperState?: TestHelperState<CAPO, SpecialState>\n    ) {\n        super(config, helperState);\n        this._start = new Date().getTime();\n    }\n\n    ts(...args: any[]) {\n        console.log(this.relativeTs, ...args);\n    }\n\n    requiresActorRole(roleName: string, firstLetter: string) {\n        if (this.actorName[0] != firstLetter) {\n            throw new Error(\n                `expected current actor name (${this.actorName}) to be one of the ${roleName} profiles starting with '${firstLetter}' in the test helper`\n            );\n        }\n    }\n    \n    get relativeTs() {\n        const ms = new Date().getTime() - this._start;\n        const s = ms / 1000;\n        return `@ ${s}s`;\n    }\n\n    //!!! todo: create type-safe ActorMap helper hasActors(), on same pattern as hasRequirements\n    async setupActors() {\n        // console.log(\"DCTH: setupActors\")\n\n        this.addActor(\"tina\", 11000n * ADA);\n        this.addActor(\"tracy\", 13n * ADA);\n        this.addActor(\"tom\", 1200n * ADA);\n    }\n\n    setDefaultActor() {\n        return this.setActor(\"tina\");\n    }\n\n    async mkCharterSpendTx(): Promise<StellarTxnContext> {\n        await this.mintCharterToken();\n\n        const treasury = await this.strella!;\n        const tcx: StellarTxnContext = this.mkTcx();\n        const tcx2 = await treasury.txnAttachScriptOrRefScript(\n            await treasury.txnAddGovAuthority(tcx),\n            await treasury.asyncCompiledScript()\n        );\n\n        return treasury.txnMustUseCharterUtxo(\n            tcx2,\n            treasury.activityUsingAuthority()\n        );\n\n        // return treasury.txnAddCharterWithAuthority(tcx);\n    }\n\n    // accesses the delegate roles, iterates the namedDelegate entries,\n    // and uses txnCreateConfiguredDelegate() to trigger compilation of the script for each one\n    async checkDelegateScripts(args: Partial<MinimalCharterDataArgs> = {}) {\n        const { strella: capo } = this;\n        const { delegateRoles } = capo;\n        // const { namedDelegate: {\n        //     selected,\n        //     uutPurpose: roleName\n        // } } = delegateRoles;\n        const goodArgs = {\n            ...this.mkDefaultCharterArgs(),\n            ...args,\n        } as MinimalCharterDataArgs;\n\n        let helperTxn = await capo.mkTxnMintCharterToken(\n            goodArgs,\n            undefined,\n            \"DRY_RUN\"\n        );\n        // emoji ladybug: \"üêû\"\n        console.log(\"  üêûüêûüêûüêûüêûüêûüêûüêûüêûüêûüêûüêûüêû \");\n\n        for (const dgtLabel of Object.keys(delegateRoles)) {\n            const dgtSetup = delegateRoles[dgtLabel] as DelegateSetup<\n                any,\n                any,\n                any\n            >;\n\n            const { config, delegateClass, delegateType, uutPurpose } =\n                dgtSetup;\n\n            console.log(\n                `  -- checking delegate script: ${dgtLabel} (${delegateType})`\n            );\n            // }\n\n            // for (const [delegateName, delegate] of Object.entries(delegates) as [ string, DelegateConfigDetails<any>][]) {\n            //     console.log(`  -- checking named-delegate script: ${delegateName}`);\n\n            helperTxn = await capo.txnWillMintUuts(\n                helperTxn,\n                [uutPurpose],\n                { usingSeedUtxo: helperTxn.state.seedUtxo },\n                {\n                    // namedDelegate: uutPurpose,\n                    [dgtLabel]: uutPurpose,\n                }\n            );\n\n            const addr = this.wallet.address;\n            const newLink = await capo.txnCreateOffchainDelegateLink(\n                helperTxn as any,\n                dgtLabel,\n                {\n                    // strategyName: delegateName,\n                    uutName: (helperTxn.state.uuts[uutPurpose] as UutName).name,\n\n                    config: {\n                        // rev: 1n,\n                        addrHint: [addr as any as Address],\n                    },\n                }\n            );\n        }\n        //     // await capo.txnCreateConfiguredDelegate(helperTxn, delegate, );\n        // } else {\n        // }\n    }\n\n    mkDefaultCharterArgs(): MinimalCharterDataArgs {\n        const addr = this.wallet.address;\n        console.log(\"test helper charter -> actor addr\", addr.toString());\n        return {\n            govAuthorityLink: {\n                config: {\n                    //this.capo.stringifyDgtConfig({\n                    addrHint: [addr],\n                },\n            },\n            mintDelegateLink: {\n                config: {},\n            },\n            spendDelegateLink: {\n                config: {},\n            },\n            mintInvariants: [],\n            spendInvariants: [],\n            otherNamedDelegates: new Map(),\n            manifest: new Map(),\n            rev: 1n,\n        };\n    }\n\n    async mintCharterToken(\n        args?: Partial<MinimalCharterDataArgs>,\n        submitOptions: SubmitOptions = {}\n    ) {\n        const { delay } = this;\n        const { tina, tom, tracy } = this.actors;\n\n        if (this.state.mintedCharterToken) {\n            console.warn(\n                \"reusing minted charter from existing testing-context\"\n            );\n            return this.state.mintedCharterToken as typeof tcx;\n        }\n\n        if (!this.strella) await this.initialize();\n        const capo = await this.strella!;\n        const goodArgs = {\n            ...this.mkDefaultCharterArgs(),\n            ...(args || {}),\n        } as MinimalCharterDataArgs;\n\n        const tcx = await capo.mkTxnMintCharterToken(goodArgs);\n        const rawConfig =\n            (this.state.rawConfig =\n            this.state.config =\n                tcx.state.bootstrappedConfig);\n\n        this.state.parsedConfig = parseCapoJSONConfig(rawConfig);\n\n        expect(capo.network).toBe(this.network);\n\n        await tcx.submitAll(submitOptions);\n        console.log(\n            `----- charter token minted at slot ${this.network.currentSlot}`\n        );\n        this.network.tick(1);\n\n        // this.network.tick(1);\n\n        this.state.mintedCharterToken = tcx;\n        // console.log(\"mintCharterToken returning tcx\", tcx);\n        return tcx;\n    }\n\n    async updateCharter(\n        args: CharterDataLike,\n        submitSettings: SubmitOptions = {}\n    ): Promise<StellarTxnContext> {\n        await this.mintCharterToken();\n        const treasury = await this.strella!;\n\n        const { signers } = this.state;\n\n        const tcx = await treasury.mkTxnUpdateCharter(args);\n        return tcx\n            .submitAll({\n                signers,\n                ...submitSettings,\n            })\n            .then(() => {\n                this.network.tick(1);\n                return tcx;\n            });\n    }\n\n    // async updateSettings(\n    //     args: DetectSettingsType<CAPO>,\n    //     submitSettings: SubmitOptions = {}\n    // ) {\n    //     await this.mintCharterToken();\n    //     const capo = this.strella!;\n    //     const tcx = await capo.mkTxnUpdateOnchainSettings(args);\n    //     return tcx.submit(submitSettings).then(() => {\n    //         this.network.tick(1);\n    //         return tcx;\n    //     });\n    // }\n}\n","// declare module \"@donecollectively/stellar-contracts/testing\";\n\nexport type { TestHelperSubmitOptions } from \"./StellarTestHelper.js\";\nexport type { NetworkSnapshot } from \"./StellarNetworkEmulator.js\";\n\nexport { CapoTestHelper } from \"./CapoTestHelper.js\";\nexport * from \"./types.js\";\n\n/**\n * @public\n */\nexport const insufficientInputError =\n    /(need .* lovelace, but only have|transaction doesn't have enough inputs)/;\n\n/**\n * Interfaces with `vitest` to provide a testing context that can be used to test Stellar contracts.\n * @public\n */\nexport type { StellarTestContext } from \"./StellarTestContext.js\";\n\nError.stackTraceLimit = 100;\n\n/**\n * @public\n */\nexport { DefaultCapoTestHelper } from \"./DefaultCapoTestHelper.js\";\n\n/**\n * @public\n */\nexport { StellarTestHelper } from \"./StellarTestHelper.js\";\n\n\nexport {\n    StellarNetworkEmulator,\n    SimpleWallet_stellar\n} from \"./StellarNetworkEmulator.js\";\n\n"],"names":["stConfig","helperState","bytesToText","extraNewLine","usesOutdent","multiLine","s","textToBytes","x","tx","txName","tcx","t","i","dumpAny","txAsString","lovelaceToAda","StellarTxnContext"],"mappings":"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"}